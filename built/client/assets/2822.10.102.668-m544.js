(self.webpackChunkmisskey=self.webpackChunkmisskey||[]).push([[2822],{78144:(t,e,s)=>{var o=s(11063),i=s(26143)(o);i.push([t.id,".mkw-polls--body>.poll[data-v-2807e5df]{color:var(--text);font-size:12px;padding:16px}.mkw-polls--body>.poll>p[data-v-2807e5df]{margin:0 0 8px}.mkw-polls--body>.poll>p>a[data-v-2807e5df]{color:inherit}.mkw-polls--body>.empty[data-v-2807e5df],.mkw-polls--body>.fetching[data-v-2807e5df]{color:var(--text);margin:0;padding:16px;text-align:center}.mkw-polls--body>.fetching>[data-icon][data-v-2807e5df]{margin-right:4px}",""]),t.exports=i},7711:(t,e,s)=>{"use strict";s.d(e,{Z:()=>i});var o=s(31508);function i(t){return o.ZP.extend({props:{widget:{type:Object},column:{type:Object,default:null},platform:{type:String,required:!0},isCustomizeMode:{type:Boolean,default:!1}},computed:{id(){return this.widget.id},props(){return this.widget.data}},data:()=>({bakedOldProps:null}),created(){this.mergeProps(),this.$watch("props",(()=>{this.mergeProps()})),this.bakeProps()},methods:{bakeProps(){this.bakedOldProps=JSON.stringify(this.props)},mergeProps(){if(t.props){const e=t.props();for(const t of Object.keys(e))this.props.hasOwnProperty(t)||o.ZP.set(this.props,t,e[t])}},save(){this.bakedOldProps!=JSON.stringify(this.props)&&(this.bakeProps(),"deck"==this.platform?this.$store.commit("device/updateDeckColumn",this.column):this.$root.api("i/update_widget",{id:this.id,data:this.props}))}}})}},92822:(t,e,s)=>{"use strict";s.r(e),s.d(e,{default:()=>p});var o=s(7711),i=s(46813);const l=(0,o.Z)({name:"polls",props:()=>({compact:!1})}).extend({i18n:(0,i.Z)("desktop/views/widgets/polls.vue"),data:()=>({poll:null,fetching:!0,more:!0,offset:0}),mounted(){this.fetch()},methods:{func(){this.props.compact=!this.props.compact,this.save()},fetch(){this.fetching=!0,this.poll=null,this.$root.api("notes/polls/recommendation",{limit:1,offset:this.offset}).then((t=>{const e=t?t[0]:null;null==e?(this.more=!1,this.offset=0):(this.more=!0,this.offset++),this.poll=e,this.fetching=!1})).catch((()=>{this.poll=null,this.fetching=!1,this.more=!1}))},voted(){this.more&&this.offset--}}});s(77476);const p=(0,s(26385).Z)(l,(function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{staticClass:"mkw-polls"},[e("ui-container",{attrs:{"show-header":!t.props.compact},scopedSlots:t._u([{key:"header",fn:function(){return[e("fa",{attrs:{icon:"chart-pie"}}),t._v(t._s(t.$t("title")))]},proxy:!0},{key:"func",fn:function(){return[e("button",{attrs:{title:t.$t("title")},on:{click:t.fetch}},[!t.fetching&&t.more?e("fa",{attrs:{icon:"arrow-right"}}):t._e(),t.fetching||t.more?t._e():e("fa",{attrs:{icon:"sync"}})],1)]},proxy:!0}])},[e("div",{staticClass:"mkw-polls--body"},[t.fetching||null==t.poll?t._e():e("div",{staticClass:"poll"},[t.poll.text?e("p",[e("router-link",{attrs:{to:t._f("notePage")(t.poll)}},[e("mfm",{attrs:{text:t.poll.text,author:t.poll.user,"custom-emojis":t.poll.emojis}})],1)],1):t._e(),t.poll.text?t._e():e("p",[e("router-link",{attrs:{to:t._f("notePage")(t.poll)}},[e("fa",{attrs:{icon:"link"}})],1)],1),e("mk-poll",{attrs:{note:t.poll},on:{voted:function(e){return t.voted()}}})],1),t.fetching||null!=t.poll?t._e():e("p",{staticClass:"empty"},[t._v(t._s(t.$t("nothing")))]),t.fetching?e("p",{staticClass:"fetching"},[e("fa",{attrs:{icon:"spinner",pulse:"","fixed-width":""}}),t._v(t._s(t.$t("@.loading"))),e("mk-ellipsis")],1):t._e()])])],1)}),[],!1,null,"2807e5df",null).exports},77476:(t,e,s)=>{var o=s(78144);o.__esModule&&(o=o.default),"string"==typeof o&&(o=[[t.id,o,""]]),o.locals&&(t.exports=o.locals);(0,s(80950).Z)("260d6e40",o,!0,{})}}]);