(self.webpackChunkmisskey=self.webpackChunkmisskey||[]).push([[3606],{71957:(t,e,i)=>{var a=i(11063),r=i(26143)(a);r.push([t.id,".kudkigyw[data-v-72ab783d]{display:inline-block;margin:8px 0;max-width:450px;min-width:200px}",""]),t.exports=r},53747:(t,e,i)=>{var a=i(11063),r=i(26143)(a);r.push([t.id,".llumlmnx[data-v-1a57fb1a]{display:inline-block;margin:8px 0;max-width:450px;min-width:300px}",""]),t.exports=r},95560:(t,e,i)=>{var a=i(11063),r=i(26143)(a);r.push([t.id,".lzyxtsnt>img[data-v-607015d5]{max-width:100%}",""]),t.exports=r},58875:(t,e,i)=>{var a=i(11063),r=i(26143)(a);r.push([t.id,".kudkigyw[data-v-37b7e992]{display:inline-block;margin:8px 0;max-width:450px;min-width:300px}",""]),t.exports=r},58803:(t,e,i)=>{var a=i(11063),r=i(26143)(a);r.push([t.id,".ngbfujlo[data-v-47e60aa9]{border:2px solid var(--pageBlockBorder);border-radius:6px;padding:0 32px 32px}@media (max-width:600px){.ngbfujlo[data-v-47e60aa9]{padding:0 16px 16px}.ngbfujlo>.textarea[data-v-47e60aa9]{margin-bottom:16px;margin-top:16px}}.ngbfujlo>footer>button[data-v-47e60aa9]{padding:8px}.ngbfujlo>footer>button.cw[data-v-47e60aa9]{opacity:.5}.ngbfujlo>footer>button.cw.useCW[data-v-47e60aa9]{opacity:1}",""]),t.exports=r},18161:(t,e,i)=>{var a=i(11063),r=i(26143)(a);r.push([t.id,".sdgxphyu[data-v-7e003235]{margin:1.5em 0}.sdgxphyu>h2[data-v-7e003235]{font-size:1.35em;margin:0 0 .5em}.sdgxphyu>h3[data-v-7e003235],.sdgxphyu>h4[data-v-7e003235]{font-size:1em;margin:0 0 .5em}",""]),t.exports=r},41898:(t,e,i)=>{var a=i(11063),r=i(26143)(a);r.push([t.id,".hkcxmtwj[data-v-6cc654da]{display:inline-block;margin:16px auto}.hkcxmtwj+.hkcxmtwj[data-v-6cc654da]{margin-left:16px}",""]),t.exports=r},59588:(t,e,i)=>{var a=i(11063),r=i(26143)(a);r.push([t.id,".kudkigyw[data-v-404fa3ca]{display:inline-block;margin:8px 0;max-width:450px;min-width:300px}",""]),t.exports=r},55589:(t,e,i)=>{var a=i(11063),r=i(26143)(a);r.push([t.id,".mrdgzndn[data-v-d562ca5a]:not(:first-child){margin-top:.5em}.mrdgzndn[data-v-d562ca5a]:not(:last-child){margin-bottom:.5em}.mrdgzndn>.url[data-v-d562ca5a]{margin:.5em 0}",""]),t.exports=r},48954:(t,e,i)=>{var a=i(11063),r=i(26143)(a);r.push([t.id,".iroscrza[data-v-ad151096]{background:var(--face);border-radius:6px;box-shadow:0 3px 8px rgba(0,0,0,.2);overflow:hidden}.iroscrza.serif>div[data-v-ad151096]{font-family:serif}.iroscrza.center[data-v-ad151096]{text-align:center}.iroscrza>header>.title[data-v-ad151096]{box-shadow:0 var(--lineWidth) rgba(0,0,0,.07);color:var(--text);font-size:20px;font-weight:700;margin:0;overflow:hidden;padding:16px 32px;text-overflow:ellipsis;z-index:1}@media (max-width:600px){.iroscrza>header>.title[data-v-ad151096]{font-size:20px;padding:16px 32px}}@media (max-width:400px){.iroscrza>header>.title[data-v-ad151096]{font-size:16px;padding:10px 20px}}.iroscrza>div[data-v-ad151096]{color:var(--text);font-size:16px;padding:24px 32px}@media (max-width:600px){.iroscrza>div[data-v-ad151096]{font-size:16px;padding:24px 32px}}@media (max-width:400px){.iroscrza>div[data-v-ad151096]{font-size:15px;padding:20px}}.iroscrza>footer[data-v-ad151096]{color:var(--text);padding:0 32px 28px}@media (max-width:600px){.iroscrza>footer[data-v-ad151096]{padding:0 32px 28px}}@media (max-width:400px){.iroscrza>footer[data-v-ad151096]{font-size:14px;padding:0 20px 20px}}.iroscrza>footer>small[data-v-ad151096]{display:block;opacity:.5}.iroscrza>footer>a[data-v-ad151096]{font-size:90%}.iroscrza>footer>a+a[data-v-ad151096]{margin-left:8px}.iroscrza>footer>.like[data-v-ad151096]{margin-top:16px}",""]),t.exports=r},11804:(t,e,i)=>{"use strict";function a(t){const e=[],i=t=>{for(const a of t)"textInput"===a.type||"textareaInput"===a.type?e.push({name:a.name,type:"string",value:a.default||""}):"numberInput"===a.type?e.push({name:a.name,type:"number",value:a.default||0}):"switch"===a.type?e.push({name:a.name,type:"boolean",value:a.default||!1}):"counter"===a.type?e.push({name:a.name,type:"number",value:0}):"radioButton"===a.type?e.push({name:a.name,type:"string",value:a.default||""}):a.children&&i(a.children)};return i(t),e}i.d(e,{k:()=>a})},73300:(t,e,i)=>{"use strict";i.d(e,{Mo:()=>u,iN:()=>o,kO:()=>c,uA:()=>n,vH:()=>l});var a=i(32971),r=i(3123);const o={if:{in:["boolean",0,0],out:0,category:"flow",icon:a.EfQ},for:{in:["number","function"],out:null,category:"flow",icon:a.TZC},not:{in:["boolean"],out:"boolean",category:"logical",icon:r.Rr},or:{in:["boolean","boolean"],out:"boolean",category:"logical",icon:r.Rr},and:{in:["boolean","boolean"],out:"boolean",category:"logical",icon:r.Rr},add:{in:["number","number"],out:"number",category:"operation",icon:a.r8p},subtract:{in:["number","number"],out:"number",category:"operation",icon:a.Kl4},multiply:{in:["number","number"],out:"number",category:"operation",icon:a.NBC},divide:{in:["number","number"],out:"number",category:"operation",icon:a.pGc},mod:{in:["number","number"],out:"number",category:"operation",icon:a.pGc},round:{in:["number"],out:"number",category:"operation",icon:a.lTt},eq:{in:[0,0],out:"boolean",category:"comparison",icon:a.Lvu},notEq:{in:[0,0],out:"boolean",category:"comparison",icon:a.u34},gt:{in:["number","number"],out:"boolean",category:"comparison",icon:a.WqQ},lt:{in:["number","number"],out:"boolean",category:"comparison",icon:a.GQf},gtEq:{in:["number","number"],out:"boolean",category:"comparison",icon:a.GJP},ltEq:{in:["number","number"],out:"boolean",category:"comparison",icon:a.ERW},strLen:{in:["string"],out:"number",category:"text",icon:a.Elr},strPick:{in:["string","number"],out:"string",category:"text",icon:a.Elr},strReplace:{in:["string","string","string"],out:"string",category:"text",icon:a.Elr},strReverse:{in:["string"],out:"string",category:"text",icon:a.Elr},join:{in:["stringArray","string"],out:"string",category:"text",icon:a.Elr},stringToNumber:{in:["string"],out:"number",category:"convert",icon:a.Ssp},numberToString:{in:["number"],out:"string",category:"convert",icon:a.Ssp},splitStrByLine:{in:["string"],out:"stringArray",category:"convert",icon:a.Ssp},pick:{in:[null,"number"],out:null,category:"list",icon:a.s$_},listLen:{in:[null],out:"number",category:"list",icon:a.s$_},rannum:{in:["number","number"],out:"number",category:"random",icon:a.RJo},dailyRannum:{in:["number","number"],out:"number",category:"random",icon:a.RJo},seedRannum:{in:[null,"number","number"],out:"number",category:"random",icon:a.RJo},random:{in:["number"],out:"boolean",category:"random",icon:a.RJo},dailyRandom:{in:["number"],out:"boolean",category:"random",icon:a.RJo},seedRandom:{in:[null,"number"],out:"boolean",category:"random",icon:a.RJo},randomPick:{in:[0],out:0,category:"random",icon:a.RJo},dailyRandomPick:{in:[0],out:0,category:"random",icon:a.RJo},seedRandomPick:{in:[null,0],out:0,category:"random",icon:a.RJo},DRPWPM:{in:["stringArray"],out:"string",category:"random",icon:a.RJo}},s={text:{out:"string",category:"value",icon:a.Elr},multiLineText:{out:"string",category:"value",icon:a.elf},textList:{out:"stringArray",category:"value",icon:a.Zrf},number:{out:"number",category:"value",icon:a.g2k},ref:{out:null,category:"value",icon:a.een},fn:{out:"function",category:"value",icon:a.by$}},n=[...Object.entries(s).map((([t,e])=>({type:t,out:e.out,category:e.category,icon:e.icon}))),...Object.entries(o).map((([t,e])=>({type:t,out:e.out,category:e.category,icon:e.icon})))];function l(t){return"fn"===t.type}const u={AI:"string",URL:"string",VERSION:"string",LOGIN:"boolean",NAME:"string",USERNAME:"string",USERID:"string",NOTES_COUNT:"number",FOLLOWERS_COUNT:"number",FOLLOWING_COUNT:"number",IS_CAT:"boolean",MY_NOTES_COUNT:"number",MY_FOLLOWERS_COUNT:"number",MY_FOLLOWING_COUNT:"number",SEED:null,YMD:"string",YEAR:"number",MON:"number",DAY:"number",HOUR:"number",MIN:"number",SEC:"number",NULL:null};function c(t){return null===t.type||!!s[t.type]}},51378:(t,e,i)=>{"use strict";i.d(e,{Z:()=>I});var a=i(31508),r=i(58945),o=i(49733);const s=a.ZP.extend({props:{value:{required:!0},script:{required:!0}},data(){return{text:this.script.interpolate(this.value.text)}},computed:{urls(){if(this.text){const t=(0,r.np)(this.text);return(0,o.Tw)(t.filter((t=>("url"==t.type||"link"==t.type)&&t.props.url&&!t.props.silent)).map((t=>t.props.url)))}return[]}},created(){this.$watch("script.vars",(()=>{this.text=this.script.interpolate(this.value.text)}),{deep:!0})}});i(93753);var n=i(26385);const l=(0,n.Z)(s,(function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{staticClass:"mrdgzndn"},[e("mfm",{key:t.text,attrs:{text:t.text,i:t.$store.state.i}}),t._l(t.urls,(function(t){return e("mk-url-preview",{key:t,staticClass:"url",attrs:{url:t}})}))],2)}),[],!1,null,"d562ca5a",null).exports;const u=a.ZP.extend({props:{value:{required:!0},script:{required:!0},page:{required:!0},h:{required:!0}},beforeCreate(){this.$options.components.XBlock=i(51378).Z}});i(8327);const c=(0,n.Z)(u,(function(){var t=this,e=t._self._c;t._self._setupProxy;return e("section",{staticClass:"sdgxphyu"},[e("h"+t.h,{tag:"component"},[e("mfm",{key:Math.random(),attrs:{text:t.value.title,plain:!0,nowrap:!0,i:t.$store.state.i}})],1),e("div",{staticClass:"children"},t._l(t.value.children,(function(i){return e("x-block",{key:i.id,attrs:{value:i,page:t.page,script:t.script,h:t.h+1}})})),1)],1)}),[],!1,null,"7e003235",null).exports;const p=a.ZP.extend({props:{value:{required:!0},page:{required:!0}},data:()=>({image:null}),created(){this.image=this.page.attachedFiles.find((t=>t.id===this.value.fileId))}});i(53624);const d=(0,n.Z)(p,(function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{staticClass:"lzyxtsnt"},[t.image?e("img",{attrs:{src:t.image.url}}):t._e()])}),[],!1,null,"607015d5",null).exports;const v=a.ZP.extend({props:{value:{required:!0},script:{required:!0}},methods:{click(){"dialog"===this.value.action?(this.script.eval(),this.$root.dialog({text:this.script.interpolate(this.value.content)})):"resetRandom"===this.value.action?(this.script.aiScript.updateRandomSeed(Math.random()),this.script.eval()):"pushEvent"===this.value.action&&(this.$root.api("page-push",Object.assign({pageId:this.script.page.id,event:this.value.event},this.value.var?{var:this.script.vars[this.value.var]}:{})),this.$root.dialog({type:"success",text:this.script.interpolate(this.value.message)}))}}});i(86203);const h=(0,n.Z)(v,(function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",[e("ui-button",{staticClass:"kudkigyw",attrs:{primary:t.value.primary},on:{click:function(e){return t.click()}}},[e("mfm",{key:Math.random(),attrs:{text:t.script.interpolate(t.value.text),plain:!0,nowrap:!0,i:t.$store.state.i}})],1)],1)}),[],!1,null,"72ab783d",null).exports;const m=a.ZP.extend({props:{value:{required:!0},script:{required:!0}},data(){return{v:this.value.default}},watch:{v(){this.script.aiScript.updatePageVar(this.value.name,this.v),this.script.eval()}}});i(46062);const g=(0,n.Z)(m,(function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",[e("ui-input",{staticClass:"kudkigyw",attrs:{type:"number"},model:{value:t.v,callback:function(e){t.v=e},expression:"v"}},[e("mfm",{key:Math.random(),attrs:{text:t.script.interpolate(t.value.text),plain:!0,nowrap:!0,i:t.$store.state.i}})],1)],1)}),[],!1,null,"37b7e992",null).exports;const f=a.ZP.extend({props:{value:{required:!0},script:{required:!0}},data(){return{v:this.value.default}},watch:{v(){this.script.aiScript.updatePageVar(this.value.name,this.v),this.script.eval()}}});i(16453);const x=(0,n.Z)(f,(function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",[e("ui-input",{staticClass:"kudkigyw",attrs:{type:"text"},model:{value:t.v,callback:function(e){t.v=e},expression:"v"}},[t._v(t._s(t.script.interpolate(t.value.text)))])],1)}),[],!1,null,"404fa3ca",null).exports;const y=a.ZP.extend({props:{value:{required:!0},script:{required:!0}},data(){return{v:this.value.default}},watch:{v(){this.script.aiScript.updatePageVar(this.value.name,this.v),this.script.eval()}}});const b=(0,n.Z)(y,(function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",[e("ui-textarea",{model:{value:t.v,callback:function(e){t.v=e},expression:"v"}},[e("mfm",{key:Math.random(),attrs:{text:t.value.text,plain:!0,nowrap:!0,i:t.$store.state.i}})],1)],1)}),[],!1,null,"6e971741",null).exports;const _=a.ZP.extend({props:{value:{required:!0},script:{required:!0}},data(){return{v:this.value.default}},watch:{v(){this.script.aiScript.updatePageVar(this.value.name,this.v),this.script.eval()}}});i(39597);const k=(0,n.Z)(_,(function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{staticClass:"hkcxmtwj"},[e("ui-switch",{model:{value:t.v,callback:function(e){t.v=e},expression:"v"}},[e("mfm",{key:Math.random(),attrs:{text:t.script.interpolate(t.value.text),plain:!0,nowrap:!0,i:t.$store.state.i}})],1)],1)}),[],!1,null,"6cc654da",null).exports;const w=a.ZP.extend({props:{value:{required:!0},script:{required:!0},page:{required:!0},h:{required:!0}},beforeCreate(){this.$options.components.XBlock=i(51378).Z}});const S=(0,n.Z)(w,(function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{directives:[{name:"show",rawName:"v-show",value:t.script.vars[t.value.var],expression:"script.vars[value.var]"}]},t._l(t.value.children,(function(i){return e("x-block",{key:i.id,attrs:{value:i,page:t.page,script:t.script,h:t.h}})})),1)}),[],!1,null,null,null).exports;const $=a.ZP.extend({props:{value:{required:!0},script:{required:!0}},data(){return{text:this.script.interpolate(this.value.text)}},created(){this.$watch("script.vars",(()=>{this.text=this.script.interpolate(this.value.text)}),{deep:!0})}});const C=(0,n.Z)($,(function(){var t=this,e=t._self._c;t._self._setupProxy;return e("ui-textarea",{attrs:{value:t.text,readonly:""}})}),[],!1,null,"2ea1e4b7",null).exports;var O=i(46813),P=i(93966),Z=i(28141),R=i(64687);const M=a.ZP.extend({i18n:(0,O.Z)("pages"),components:{MkVisibilityChooser:Z.Z,XVisibilityIcon:P.Z},props:{page:{required:!1},value:{required:!0},script:{required:!0}},data(){return{text:this.script.interpolate(this.value.text),visibility:"public",localOnly:!1,copyOnce:!1,useCw:!!this.page.sensitive,cw:this.page.title,posted:!1,posting:!1}},created(){this.$watch("script.vars",(()=>{this.text=this.script.interpolate(this.value.text)}),{deep:!0})},mounted(){this.applyVisibility(this.$store.state.settings.defaultNoteVisibility)},methods:{setVisibility(){this.$root.new(Z.Z,{source:this.$refs.visibilityButton,currentVisibility:this.visibility}).$once("chosen",(t=>{this.applyVisibility(t)}))},applyVisibility(t){const e=(0,R.Z)(t);this.localOnly=e.localOnly,this.copyOnce=e.copyOnce,this.visibility=e.visibility},post(){this.posting=!0,this.$root.api("notes/create",{text:this.text,visibility:this.visibility,localOnly:this.localOnly,copyOnce:this.copyOnce,cw:this.useCw?this.cw||"":void 0}).then((()=>{this.posted=!0,this.$root.dialog({type:"success",splash:!0})}))}}});i(86299);const E=(0,n.Z)(M,(function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{staticClass:"ngbfujlo"},[e("ui-textarea",{staticClass:"textarea",attrs:{value:t.text,readonly:""}}),null!=t.$store.state.i?e("ui-button",{attrs:{primary:"",disabled:t.posting||t.posted},on:{click:function(e){return t.post()}}},[t._v(t._s(t.posted?t.$t("posted-from-post-form"):t.$t("post-from-post-form")))]):t._e(),null!=t.$store.state.i?e("footer",{staticStyle:{"padding-top":"8px",display:"flex"}},[e("button",{ref:"visibilityButton",staticClass:"visibility",on:{click:t.setVisibility}},[e("x-visibility-icon",{attrs:{v:t.visibility,localOnly:t.localOnly,copyOnce:t.copyOnce}})],1),e("button",{staticClass:"cw",class:{useCW:this.useCw},attrs:{title:"Hide"},on:{click:function(e){t.useCw=!t.useCw}}},[e("fa",{attrs:{icon:["far","eye-slash"]}})],1),t.useCw?e("ui-input",{ref:"cw",staticStyle:{margin:"0"},model:{value:t.cw,callback:function(e){t.cw=e},expression:"cw"}}):t._e()],1):t._e()],1)}),[],!1,null,"47e60aa9",null).exports;const q=a.ZP.extend({props:{value:{required:!0},script:{required:!0}},data:()=>({v:0}),watch:{v(){this.script.aiScript.updatePageVar(this.value.name,this.v),this.script.eval()}},methods:{click(){this.v=this.v+(this.value.inc||1)}}});i(45001);const N=(0,n.Z)(q,(function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",[e("ui-button",{staticClass:"llumlmnx",on:{click:function(e){return t.click()}}},[e("mfm",{key:Math.random(),attrs:{text:t.script.interpolate(t.value.text),plain:!0,nowrap:!0,i:t.$store.state.i}})],1)],1)}),[],!1,null,"1a57fb1a",null).exports;const L=a.ZP.extend({props:{value:{required:!0},script:{required:!0}},data(){return{v:this.value.default}},watch:{v(){this.script.aiScript.updatePageVar(this.value.name,this.v),this.script.eval()}}});const T=(0,n.Z)(L,(function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",[e("div",[e("mfm",{key:Math.random(),attrs:{text:t.script.interpolate(t.value.title),plain:!0,nowrap:!0,i:t.$store.state.i}})],1),t._l(t.value.values,(function(i){return e("ui-radio",{key:i,attrs:{value:i},model:{value:t.v,callback:function(e){t.v=e},expression:"v"}},[e("mfm",{key:Math.random(),attrs:{text:i,plain:!0,nowrap:!0,i:t.$store.state.i}})],1)}))],2)}),[],!1,null,"1bc67de8",null).exports,z=a.ZP.extend({components:{XText:l,XSection:c,XImage:d,XButton:h,XNumberInput:g,XTextInput:x,XTextareaInput:b,XTextarea:C,XPost:E,XSwitch:k,XIf:S,XCounter:N,XRadioButton:T},props:{value:{required:!0},script:{required:!0},page:{required:!0},h:{required:!0}}});const I=(0,n.Z)(z,(function(){var t=this,e=t._self._c;t._self._setupProxy;return e("x-"+t.value.type,{key:t.value.id,tag:"component",attrs:{value:t.value,page:t.page,script:t.script,h:t.h}})}),[],!1,null,null,null).exports},15549:(t,e,i)=>{"use strict";i.d(e,{Z:()=>y});var a=i(31508),r=i(46813),o=i(32971),s=i(3123),n=i(51378),l=i(40289),u=i(68116),c=i(73300),p=i(87114),d=function(t,e,i,a){var r,o=arguments.length,s=o<3?e:null===a?a=Object.getOwnPropertyDescriptor(e,i):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,a);else for(var n=t.length-1;n>=0;n--)(r=t[n])&&(s=(o<3?r(s):o>3?r(e,i,s):r(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s};class v{constructor(t,e,i){this.variables=t,this.pageVars=e,this.opts=i;const a=new Date;this.envVars={AI:"kawaii",VERSION:p.i8,URL:i.page?`${i.url}/@${i.page.user.username}/pages/${i.page.name}`:"",LOGIN:null!=i.visitor,NAME:i.visitor?i.visitor.name||i.visitor.username:"",USERNAME:i.visitor?i.visitor.username:"",USERID:i.visitor?i.visitor.id:"",NOTES_COUNT:i.visitor?i.visitor.notesCount:0,FOLLOWERS_COUNT:i.visitor?i.visitor.followersCount:0,FOLLOWING_COUNT:i.visitor?i.visitor.followingCount:0,IS_CAT:!!i.visitor&&i.visitor.isCat,MY_NOTES_COUNT:i.user?i.user.notesCount:0,MY_FOLLOWERS_COUNT:i.user?i.user.followersCount:0,MY_FOLLOWING_COUNT:i.user?i.user.followingCount:0,SEED:i.randomSeed?i.randomSeed:"",YMD:`${a.getFullYear()}/${a.getMonth()+1}/${a.getDate()}`,YEAR:a.getFullYear(),MON:a.getMonth()+1,DAY:a.getDate(),HOUR:a.getHours(),MIN:a.getMinutes(),SEC:a.getSeconds(),NULL:null}}updatePageVar(t,e){const i=this.pageVars.find((e=>e.name===t));if(void 0===i)throw new h(`No such page var '${t}'`);i.value=e}updateRandomSeed(t){this.opts.randomSeed=t,this.envVars.SEED=t}interpolate(t,e){return t.replace(/{(.+?)}/g,(t=>{const i=e.getState(t.slice(1,-1).trim());return null==i?"NULL":i.toString()}))}evaluateVars(){const t={};for(const[e,i]of Object.entries(this.envVars))t[e]=i;for(const e of this.pageVars)t[e.name]=e.value;for(const e of this.variables)t[e.name]=this.evaluate(e,new m([t]));return t}evaluate(t,e){if(null===t.type)return null;if("number"===t.type)return parseInt(t.value,10);if("text"===t.type||"multiLineText"===t.type)return this.interpolate(t.value||"",e);if("textList"===t.type)return this.interpolate(t.value||"",e).trim().split("\n");if("ref"===t.type)return e.getState(t.value);if((0,c.vH)(t))return{slots:t.value.slots.map((t=>t.name)),exec:i=>this.evaluate(t.value.expression,e.createChildScope(i,t.id))};if(t.type.startsWith("fn:")){const i=t.type.split(":")[1],a=e.getState(i),r={};for(let i=0;i<a.slots.length;i++){r[a.slots[i]]=this.evaluate(t.args[i],e)}return a.exec(r)}if(void 0===t.args)return null;const i=new Date,a=`${this.opts.visitor?this.opts.visitor.id:""} ${i.getFullYear()}/${i.getMonth()+1}/${i.getDate()}`,r={not:t=>!t,or:(t,e)=>t||e,and:(t,e)=>t&&e,eq:(t,e)=>t===e,notEq:(t,e)=>t!==e,gt:(t,e)=>t>e,lt:(t,e)=>t<e,gtEq:(t,e)=>t>=e,ltEq:(t,e)=>t<=e,if:(t,e,i)=>t?e:i,for:(t,e)=>{const i=[];for(let a=0;a<t;a++)i.push(e.exec({[e.slots[0]]:a+1}));return i},add:(t,e)=>t+e,subtract:(t,e)=>t-e,multiply:(t,e)=>t*e,divide:(t,e)=>t/e,mod:(t,e)=>t%e,round:t=>Math.round(t),strLen:t=>t.length,strPick:(t,e)=>t[e-1],strReplace:(t,e,i)=>t.split(e).join(i),strReverse:t=>t.split("").reverse().join(""),join:(t,e)=>t.join(e||""),stringToNumber:t=>parseInt(t),numberToString:t=>t.toString(),splitStrByLine:t=>t.split("\n"),pick:(t,e)=>t[e-1],listLen:t=>t.length,random:e=>Math.floor(100*u(`${this.opts.randomSeed}:${t.id}`)())<e,rannum:(e,i)=>e+Math.floor(u(`${this.opts.randomSeed}:${t.id}`)()*(i-e+1)),randomPick:e=>e[Math.floor(u(`${this.opts.randomSeed}:${t.id}`)()*e.length)],dailyRandom:e=>Math.floor(100*u(`${a}:${t.id}`)())<e,dailyRannum:(e,i)=>e+Math.floor(u(`${a}:${t.id}`)()*(i-e+1)),dailyRandomPick:e=>e[Math.floor(u(`${a}:${t.id}`)()*e.length)],seedRandom:(t,e)=>Math.floor(100*u(t)())<e,seedRannum:(t,e,i)=>e+Math.floor(u(t)()*(i-e+1)),seedRandomPick:(t,e)=>e[Math.floor(u(t)()*e.length)],DRPWPM:e=>{const i=[];let r=0;for(const t of e){const e=t.split(" "),a=parseInt(e.pop(),10),o=e.join(" ");r+=a,i.push({factor:a,text:o})}const o=u(`${a}:${t.id}`)()*r;let s=0;for(const t of i){if(o>=s&&o<=s+t.factor)return t.text;s+=t.factor}return i[0].text}},o=t.type,s=r[o];if(null==s)throw new h(`No such function '${o}'`);return s(...t.args.map((t=>this.evaluate(t,e))))}}d([l.ZP],v.prototype,"updatePageVar",null),d([l.ZP],v.prototype,"updateRandomSeed",null),d([l.ZP],v.prototype,"interpolate",null),d([l.ZP],v.prototype,"evaluateVars",null),d([l.ZP],v.prototype,"evaluate",null);class h extends Error{constructor(t,e){super(t),this.info=e,Error.captureStackTrace&&Error.captureStackTrace(this,h)}}class m{constructor(t,e){this.layerdStates=t,this.name=e||"anonymous"}createChildScope(t,e){const i=[t,...this.layerdStates];return new m(i,e)}getState(t){for(const e of this.layerdStates){const i=e[t];if(void 0!==i)return i}throw new h(`No such variable '${t}' in scope '${this.name}'`,{scope:this.layerdStates})}}d([l.ZP],m.prototype,"createChildScope",null),d([l.ZP],m.prototype,"getState",null);var g=i(11804);class f{constructor(t,e,i){this.page=t,this.aiScript=e,this.onError=i,this.eval()}eval(){try{this.vars=this.aiScript.evaluateVars()}catch(t){this.onError(t)}}interpolate(t){return null==t?null:t.replace(/{(.+?)}/g,(t=>{const e=this.vars[t.slice(1,-1).trim()];return null==e?"NULL":e.toString()}))}}const x=a.ZP.extend({i18n:(0,r.Z)("pages"),components:{XBlock:n.Z},props:{page:{type:Object,required:!0},showTitle:{type:Boolean,required:!1,default:!0},showFooter:{type:Boolean,required:!1,default:!1}},data:()=>({script:null,faHeartS:o.m6i,faHeart:s.m6}),created(){const t=this.getPageVars();this.script=new f(this.page,new v(this.page.variables,t,{randomSeed:Math.random(),user:this.page.user,visitor:this.$store.state.i,page:this.page,url:p.HQ}),(t=>{console.dir(t)}))},methods:{getPageVars(){return(0,g.k)(this.page.content)},like(){this.$root.api("pages/like",{pageId:this.page.id}).then((()=>{this.page.isLiked=!0,this.page.likedCount++}))},unlike(){this.$root.api("pages/unlike",{pageId:this.page.id}).then((()=>{this.page.isLiked=!1,this.page.likedCount--}))}}});i(31566);const y=(0,i(26385).Z)(x,(function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{staticClass:"iroscrza",class:{center:t.page.alignCenter,serif:"serif"===t.page.font}},[t.showTitle?e("header",[e("div",{staticClass:"title"},[e("mfm",{key:t.page.title,attrs:{text:t.page.title,plain:!0,nowrap:!0,i:t.$store.state.i}})],1)]):t._e(),t.script?e("div",t._l(t.page.content,(function(i){return e("x-block",{key:i.id,attrs:{value:i,page:t.page,script:t.script,h:2},on:{input:e=>t.updateBlock(e)}})})),1):t._e(),t.showFooter?e("footer",[e("small",[t._v("@"+t._s(t.page.user.username))]),t.$store.getters.isSignedIn&&t.$store.state.i.id===t.page.userId?[e("router-link",{attrs:{to:`/i/pages/edit/${t.page.id}`}},[t._v(t._s(t.$t("edit-this-page")))])]:t._e(),e("router-link",{attrs:{to:`./${t.page.name}/view-source`}},[t._v(t._s(t.$t("view-source")))]),e("div",{staticClass:"like"},[t.page.isLiked?e("button",{attrs:{title:t.$t("unlike")},on:{click:function(e){return t.unlike()}}},[e("fa",{attrs:{icon:t.faHeartS}})],1):e("button",{attrs:{title:t.$t("like")},on:{click:function(e){return t.like()}}},[e("fa",{attrs:{icon:t.faHeart}})],1),t.page.likedCount>0?e("span",{staticClass:"count"},[t._v(t._s(t.page.likedCount))]):t._e()])],2):t._e()])}),[],!1,null,"ad151096",null).exports},86203:(t,e,i)=>{var a=i(71957);a.__esModule&&(a=a.default),"string"==typeof a&&(a=[[t.id,a,""]]),a.locals&&(t.exports=a.locals);(0,i(80950).Z)("415cac77",a,!0,{})},45001:(t,e,i)=>{var a=i(53747);a.__esModule&&(a=a.default),"string"==typeof a&&(a=[[t.id,a,""]]),a.locals&&(t.exports=a.locals);(0,i(80950).Z)("310e6092",a,!0,{})},53624:(t,e,i)=>{var a=i(95560);a.__esModule&&(a=a.default),"string"==typeof a&&(a=[[t.id,a,""]]),a.locals&&(t.exports=a.locals);(0,i(80950).Z)("3e01dd3e",a,!0,{})},46062:(t,e,i)=>{var a=i(58875);a.__esModule&&(a=a.default),"string"==typeof a&&(a=[[t.id,a,""]]),a.locals&&(t.exports=a.locals);(0,i(80950).Z)("57d0a5f2",a,!0,{})},86299:(t,e,i)=>{var a=i(58803);a.__esModule&&(a=a.default),"string"==typeof a&&(a=[[t.id,a,""]]),a.locals&&(t.exports=a.locals);(0,i(80950).Z)("4dd10a78",a,!0,{})},8327:(t,e,i)=>{var a=i(18161);a.__esModule&&(a=a.default),"string"==typeof a&&(a=[[t.id,a,""]]),a.locals&&(t.exports=a.locals);(0,i(80950).Z)("7636bca8",a,!0,{})},39597:(t,e,i)=>{var a=i(41898);a.__esModule&&(a=a.default),"string"==typeof a&&(a=[[t.id,a,""]]),a.locals&&(t.exports=a.locals);(0,i(80950).Z)("65e7c76d",a,!0,{})},16453:(t,e,i)=>{var a=i(59588);a.__esModule&&(a=a.default),"string"==typeof a&&(a=[[t.id,a,""]]),a.locals&&(t.exports=a.locals);(0,i(80950).Z)("2135f5d7",a,!0,{})},93753:(t,e,i)=>{var a=i(55589);a.__esModule&&(a=a.default),"string"==typeof a&&(a=[[t.id,a,""]]),a.locals&&(t.exports=a.locals);(0,i(80950).Z)("59524f84",a,!0,{})},31566:(t,e,i)=>{var a=i(48954);a.__esModule&&(a=a.default),"string"==typeof a&&(a=[[t.id,a,""]]),a.locals&&(t.exports=a.locals);(0,i(80950).Z)("106fcd3c",a,!0,{})},21440:()=>{}}]);