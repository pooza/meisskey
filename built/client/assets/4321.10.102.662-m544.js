(self.webpackChunkmisskey=self.webpackChunkmisskey||[]).push([[4321],{55158:(t,e,s)=>{var o=s(11063),a=s(26143)(o);a.push([t.id,".xUAVLSpWDS_v0j1gGnoq{color:var(--text);margin:0;padding:16px;text-align:center}.xUAVLSpWDS_v0j1gGnoq>[data-icon]{margin-right:4px}",""]),a.locals={fetching:"xUAVLSpWDS_v0j1gGnoq"},t.exports=a},76450:(t,e,s)=>{var o=s(11063),a=s(26143)(o);a.push([t.id,'.cpu-memory>svg[data-v-630aa99e]{display:block;float:left;padding:10px;width:50%}.cpu-memory>svg[data-v-630aa99e]:first-child{padding-right:5px}.cpu-memory>svg[data-v-630aa99e]:last-child{padding-left:5px}.cpu-memory>svg>text[data-v-630aa99e]{fill:var(--chartCaption);font-size:5px}.cpu-memory>svg>text>tspan[data-v-630aa99e]{opacity:.5}.cpu-memory[data-v-630aa99e]:after{clear:both;content:"";display:block}',""]),t.exports=a},73040:(t,e,s)=>{var o=s(11063),a=s(26143)(o);a.push([t.id,'.cpu>.pie[data-v-63ebaeca]{float:left;height:100px;padding:10px}.cpu>div[data-v-63ebaeca]{float:left;padding:10px 10px 10px 0;width:calc(100% - 100px)}.cpu>div>p[data-v-63ebaeca]{color:var(--chartCaption);font-size:12px;margin:0}.cpu>div>p[data-v-63ebaeca]:first-child{font-weight:700}.cpu>div>p:first-child>[data-icon][data-v-63ebaeca]{margin-right:4px}.cpu[data-v-63ebaeca]:after{clear:both;content:"";display:block}',""]),t.exports=a},5875:(t,e,s)=>{var o=s(11063),a=s(26143)(o);a.push([t.id,'.disk>.pie[data-v-905d263a]{float:left;height:100px;padding:10px}.disk>div[data-v-905d263a]{float:left;padding:10px 10px 10px 0;width:calc(100% - 100px)}.disk>div>p[data-v-905d263a]{color:var(--chartCaption);font-size:12px;margin:0}.disk>div>p[data-v-905d263a]:first-child{font-weight:700}.disk>div>p:first-child>[data-icon][data-v-905d263a]{margin-right:4px}.disk[data-v-905d263a]:after{clear:both;content:"";display:block}',""]),t.exports=a},32362:(t,e,s)=>{var o=s(11063),a=s(26143)(o);a.push([t.id,".info[data-v-174d319a]{padding:10px 14px}.info>p[data-v-174d319a]{color:var(--text);font-size:12px;margin:0}",""]),t.exports=a},49626:(t,e,s)=>{var o=s(11063),a=s(26143)(o);a.push([t.id,'.memory>.pie[data-v-2e2ca5f4]{float:left;height:100px;padding:10px}.memory>div[data-v-2e2ca5f4]{float:left;padding:10px 10px 10px 0;width:calc(100% - 100px)}.memory>div>p[data-v-2e2ca5f4]{color:var(--chartCaption);font-size:12px;margin:0}.memory>div>p[data-v-2e2ca5f4]:first-child{font-weight:700}.memory>div>p:first-child>[data-icon][data-v-2e2ca5f4]{margin-right:4px}.memory[data-v-2e2ca5f4]:after{clear:both;content:"";display:block}',""]),t.exports=a},47242:(t,e,s)=>{var o=s(11063),a=s(26143)(o);a.push([t.id,"svg[data-v-4053decb]{display:block;height:100%}svg>circle[data-v-4053decb]{transform:rotate(-90deg);transform-origin:center;transition:stroke-dashoffset .5s ease}svg>text[data-v-4053decb]{fill:var(--chartCaption);font-size:.15px}",""]),t.exports=a},77682:(t,e,s)=>{var o=s(11063),a=s(26143)(o);a.push([t.id,".uptimes[data-v-01a2b57a]{padding:10px 14px}.uptimes>p[data-v-01a2b57a]{color:var(--text);font-size:12px;margin:0}.uptimes>p[data-v-01a2b57a]:first-child{font-weight:700}",""]),t.exports=a},7711:(t,e,s)=>{"use strict";s.d(e,{Z:()=>a});var o=s(31508);function a(t){return o.ZP.extend({props:{widget:{type:Object},column:{type:Object,default:null},platform:{type:String,required:!0},isCustomizeMode:{type:Boolean,default:!1}},computed:{id(){return this.widget.id},props(){return this.widget.data}},data:()=>({bakedOldProps:null}),created(){this.mergeProps(),this.$watch("props",(()=>{this.mergeProps()})),this.bakeProps()},methods:{bakeProps(){this.bakedOldProps=JSON.stringify(this.props)},mergeProps(){if(t.props){const e=t.props();for(const t of Object.keys(e))this.props.hasOwnProperty(t)||o.ZP.set(this.props,t,e[t])}},save(){this.bakedOldProps!=JSON.stringify(this.props)&&(this.bakeProps(),"deck"==this.platform?this.$store.commit("device/updateDeckColumn",this.column):this.$root.api("i/update_widget",{id:this.id,data:this.props}))}}})}},14321:(t,e,s)=>{"use strict";s.r(e),s.d(e,{default:()=>S});var o=s(7711),a=s(46813),i=s(31508),n=s(37705);const r=i.ZP.extend({props:["connection"],data:()=>({viewBoxX:50,viewBoxY:30,stats:[],cpuGradientId:(0,n.Z)(),cpuMaskId:(0,n.Z)(),memGradientId:(0,n.Z)(),memMaskId:(0,n.Z)(),cpuPolylinePoints:"",memPolylinePoints:"",cpuPolygonPoints:"",memPolygonPoints:"",cpuHeadX:null,cpuHeadY:null,memHeadX:null,memHeadY:null,cpuP:"",memP:""}),mounted(){this.connection.on("stats",this.onStats),this.connection.on("statsLog",this.onStatsLog),this.connection.send("requestLog",{id:Math.random().toString().substr(2,8)})},beforeDestroy(){this.connection.off("stats",this.onStats),this.connection.off("statsLog",this.onStatsLog)},methods:{onStats(t){this.stats.push(t),this.stats.length>50&&this.stats.shift();const e=this.stats.map(((t,e)=>[this.viewBoxX-(this.stats.length-1-e),(1-t.cpu_usage)*this.viewBoxY])),s=this.stats.map(((t,e)=>[this.viewBoxX-(this.stats.length-1-e),(1-t.mem.active/t.mem.total)*this.viewBoxY]));this.cpuPolylinePoints=e.map((t=>`${t[0]},${t[1]}`)).join(" "),this.memPolylinePoints=s.map((t=>`${t[0]},${t[1]}`)).join(" "),this.cpuPolygonPoints=`${this.viewBoxX-(this.stats.length-1)},${this.viewBoxY} ${this.cpuPolylinePoints} ${this.viewBoxX},${this.viewBoxY}`,this.memPolygonPoints=`${this.viewBoxX-(this.stats.length-1)},${this.viewBoxY} ${this.memPolylinePoints} ${this.viewBoxX},${this.viewBoxY}`,this.cpuHeadX=e[e.length-1][0],this.cpuHeadY=e[e.length-1][1],this.memHeadX=s[s.length-1][0],this.memHeadY=s[s.length-1][1],this.cpuP=(100*t.cpu_usage).toFixed(0),this.memP=(t.mem.active/t.mem.total*100).toFixed(0)},onStatsLog(t){for(const e of t.reverse())this.onStats(e)}}});s(31729);var p=s(26385);const c=(0,p.Z)(r,(function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{staticClass:"cpu-memory"},[e("svg",{attrs:{viewBox:`0 0 ${t.viewBoxX} ${t.viewBoxY}`}},[e("defs",[e("linearGradient",{attrs:{id:t.cpuGradientId,x1:"0",x2:"0",y1:"1",y2:"0"}},[e("stop",{attrs:{offset:"0%","stop-color":"hsl(180, 80%, 70%)"}}),e("stop",{attrs:{offset:"100%","stop-color":"hsl(0, 80%, 70%)"}})],1),e("mask",{attrs:{id:t.cpuMaskId,x:"0",y:"0",width:t.viewBoxX,height:t.viewBoxY}},[e("polygon",{attrs:{points:t.cpuPolygonPoints,fill:"#fff","fill-opacity":"0.5"}}),e("polyline",{attrs:{points:t.cpuPolylinePoints,fill:"none",stroke:"#fff","stroke-width":"1"}}),e("circle",{attrs:{cx:t.cpuHeadX,cy:t.cpuHeadY,r:"1.5",fill:"#fff"}})])],1),e("rect",{style:`stroke: none; fill: url(#${t.cpuGradientId}); mask: url(#${t.cpuMaskId})`,attrs:{x:"-2",y:"-2",width:t.viewBoxX+4,height:t.viewBoxY+4}}),e("text",{attrs:{x:"1",y:"5"}},[t._v("CPU "),e("tspan",[t._v(t._s(t.cpuP)+"%")])])]),e("svg",{attrs:{viewBox:`0 0 ${t.viewBoxX} ${t.viewBoxY}`}},[e("defs",[e("linearGradient",{attrs:{id:t.memGradientId,x1:"0",x2:"0",y1:"1",y2:"0"}},[e("stop",{attrs:{offset:"0%","stop-color":"hsl(180, 80%, 70%)"}}),e("stop",{attrs:{offset:"100%","stop-color":"hsl(0, 80%, 70%)"}})],1),e("mask",{attrs:{id:t.memMaskId,x:"0",y:"0",width:t.viewBoxX,height:t.viewBoxY}},[e("polygon",{attrs:{points:t.memPolygonPoints,fill:"#fff","fill-opacity":"0.5"}}),e("polyline",{attrs:{points:t.memPolylinePoints,fill:"none",stroke:"#fff","stroke-width":"1"}}),e("circle",{attrs:{cx:t.memHeadX,cy:t.memHeadY,r:"1.5",fill:"#fff"}})])],1),e("rect",{style:`stroke: none; fill: url(#${t.memGradientId}); mask: url(#${t.memMaskId})`,attrs:{x:"-2",y:"-2",width:t.viewBoxX+4,height:t.viewBoxY+4}}),e("text",{attrs:{x:"1",y:"5"}},[t._v("MEM "),e("tspan",[t._v(t._s(t.memP)+"%")])])])])}),[],!1,null,"630aa99e",null).exports;const l=i.ZP.extend({props:{value:{type:Number,required:!0}},data:()=>({r:.4}),computed:{color(){return`hsl(${180-180*this.value}, 80%, 70%)`},strokeDashoffset(){return(1-this.value)*(Math.PI*(2*this.r))}}});s(9568);const d=(0,p.Z)(l,(function(){var t=this,e=t._self._c;t._self._setupProxy;return e("svg",{attrs:{viewBox:"0 0 1 1",preserveAspectRatio:"none"}},[e("circle",{attrs:{r:t.r,cx:"50%",cy:"50%",fill:"none","stroke-width":"0.1",stroke:"rgba(0, 0, 0, 0.05)"}}),e("circle",{attrs:{r:t.r,cx:"50%",cy:"50%","stroke-dasharray":Math.PI*(2*t.r),"stroke-dashoffset":t.strokeDashoffset,fill:"none","stroke-width":"0.1",stroke:t.color}}),e("text",{attrs:{x:"50%",y:"50%",dy:"0.05","text-anchor":"middle"}},[t._v(t._s((100*t.value).toFixed(0))+"%")])])}),[],!1,null,"4053decb",null).exports,h=i.ZP.extend({components:{XPie:d},props:["connection","meta"],data:()=>({usage:0,speed:0}),mounted(){this.connection.on("stats",this.onStats)},beforeDestroy(){this.connection.off("stats",this.onStats)},methods:{onStats(t){this.usage=t.cpu_usage,this.speed=t.cpu_speed.toFixed(2)}}});s(22128);const v=(0,p.Z)(h,(function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{staticClass:"cpu"},[e("x-pie",{staticClass:"pie",attrs:{value:t.usage}}),e("div",[e("p",[e("fa",{attrs:{icon:"microchip"}}),t._v("CPU")],1),e("p",[t._v(t._s(t.meta.cpu.cores)+" Logical cores")]),e("p",[t._v(t._s(t.meta.cpu.model))]),e("p",[t._v("Current: "+t._s(t.speed)+"GHz")])])],1)}),[],!1,null,"63ebaeca",null).exports;const f=i.ZP.extend({components:{XPie:d},props:["connection"],data:()=>({usage:0,total:0,used:0,active:0,free:0}),mounted(){this.connection.on("stats",this.onStats)},beforeDestroy(){this.connection.off("stats",this.onStats)},methods:{onStats(t){t.mem.free=t.mem.free,this.usage=t.mem.active/t.mem.total,this.total=t.mem.total,this.used=t.mem.used,this.active=t.mem.active,this.free=t.mem.free}}});s(69168);const u=(0,p.Z)(f,(function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{staticClass:"memory"},[e("x-pie",{staticClass:"pie",attrs:{value:t.usage}}),e("div",[e("p",[e("fa",{attrs:{icon:"memory"}}),t._v("Memory")],1),e("p",[t._v("Total: "+t._s(t._f("bytes")(t.total,1)))]),e("p",[t._v("Active: "+t._s(t._f("bytes")(t.active,1)))]),e("p",[t._v("Free: "+t._s(t._f("bytes")(t.free,1)))])])],1)}),[],!1,null,"2e2ca5f4",null).exports;const m=i.ZP.extend({components:{XPie:d},props:["connection"],data:()=>({usage:0,total:0,used:0,available:0}),mounted(){this.connection.on("stats",this.onStats)},beforeDestroy(){this.connection.off("stats",this.onStats)},methods:{onStats(t){t.disk.used=t.disk.total-t.disk.free,this.usage=t.disk.used/t.disk.total,this.total=t.disk.total,this.used=t.disk.used,this.available=t.disk.available}}});s(98970);const x=(0,p.Z)(m,(function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{staticClass:"disk"},[e("x-pie",{staticClass:"pie",attrs:{value:t.usage}}),e("div",[e("p",[e("fa",{attrs:{icon:["far","hdd"]}}),t._v("Storage")],1),e("p",[t._v("Total: "+t._s(t._f("bytes")(t.total,1)))]),e("p",[t._v("Free: "+t._s(t._f("bytes")(t.available,1)))]),e("p",[t._v("Used: "+t._s(t._f("bytes")(t.used,1)))])])],1)}),[],!1,null,"905d263a",null).exports;function g(t){if(!t)return t;const e=Math.floor(t/86400),s=t%86400,o=e>=2?`${e} days`:e>=1?`${e} day`:null;let a="";return o&&(a+=`${o}, `),a+=s<60?`${Math.floor(s)} sec`:s<3600?`${Math.floor(s/60)} min`:`${Math.floor(s/60/60)}:${Math.floor(s/60%60).toString().padStart(2,"0")}`,a}const _=i.ZP.extend({props:["connection"],data:()=>({process:"Unknown",os:"Unknown"}),mounted(){this.connection.on("stats",this.onStats)},beforeDestroy(){this.connection.off("stats",this.onStats)},methods:{onStats(t){this.process=t.process_uptime>0?g(t.process_uptime):"Unknown",this.os=t.process_uptime>0?g(t.os_uptime):"Unknown"}}});s(10298);const y=(0,p.Z)(_,(function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{staticClass:"uptimes"},[e("p",[t._v("Uptimes")]),e("p",[t._v("Process: "+t._s(t.process))]),e("p",[t._v("OS: "+t._s(t.os))])])}),[],!1,null,"01a2b57a",null).exports;const w=i.ZP.extend({props:["meta"]});s(19071);const k=(0,p.Z)(w,(function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{staticClass:"info"},[e("p",[t._v("Maintainer: "),e("b",[e("a",{attrs:{href:"mailto:"+t.meta.maintainer.email,target:"_blank"}},[t._v(t._s(t.meta.maintainer.name))])])]),e("p",[t._v("Machine: "+t._s(t.meta.machine))]),e("p",[t._v("Node: "+t._s(t.meta.node))]),e("p",[t._v("Version: "+t._s(t.meta.version)+" ")])])}),[],!1,null,"174d319a",null).exports,P=(0,o.Z)({name:"server",props:()=>({design:0,view:0})}).extend({i18n:(0,a.Z)("common/views/widgets/server.vue"),components:{XCpuMemory:c,XCpu:v,XMemory:u,XDisk:x,XUptimes:y,XInfo:k},data:()=>({fetching:!0,meta:null,connection:null}),mounted(){this.$root.getMeta().then((t=>{this.meta=t,this.fetching=!1})),this.connection=this.$root.stream.useSharedConnection("serverStats")},beforeDestroy(){this.connection.dispose()},methods:{toggle(){5==this.props.view?this.props.view=0:this.props.view++,this.save()},func(){2==this.props.design?this.props.design=0:this.props.design++,this.save()}}});var b=s(47859),$=s.n(b);const S=(0,p.Z)(P,(function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{staticClass:"mkw-server"},[e("ui-container",{attrs:{"show-header":0==t.props.design,naked:2==t.props.design},scopedSlots:t._u([{key:"header",fn:function(){return[e("fa",{attrs:{icon:"server"}}),t._v(t._s(t.$t("title")))]},proxy:!0},{key:"func",fn:function(){return[e("button",{attrs:{title:t.$t("toggle")},on:{click:t.toggle}},[e("fa",{attrs:{icon:"sort"}})],1)]},proxy:!0}])},[t.fetching?e("p",{class:t.$style.fetching},[e("fa",{attrs:{icon:"spinner",pulse:"","fixed-width":""}}),t._v(t._s(t.$t("@.loading"))),e("mk-ellipsis")],1):t._e(),t.fetching?t._e():[e("x-cpu-memory",{directives:[{name:"show",rawName:"v-show",value:0==t.props.view,expression:"props.view == 0"}],attrs:{connection:t.connection}}),e("x-cpu",{directives:[{name:"show",rawName:"v-show",value:1==t.props.view,expression:"props.view == 1"}],attrs:{connection:t.connection,meta:t.meta}}),e("x-memory",{directives:[{name:"show",rawName:"v-show",value:2==t.props.view,expression:"props.view == 2"}],attrs:{connection:t.connection}}),e("x-disk",{directives:[{name:"show",rawName:"v-show",value:3==t.props.view,expression:"props.view == 3"}],attrs:{connection:t.connection}}),e("x-uptimes",{directives:[{name:"show",rawName:"v-show",value:4==t.props.view,expression:"props.view == 4"}],attrs:{connection:t.connection}}),e("x-info",{directives:[{name:"show",rawName:"v-show",value:5==t.props.view,expression:"props.view == 5"}],attrs:{connection:t.connection,meta:t.meta}})]],2)],1)}),[],!1,(function(t){this.$style=$().locals||$()}),null,null).exports},47859:(t,e,s)=>{var o=s(55158);o.__esModule&&(o=o.default),"string"==typeof o&&(o=[[t.id,o,""]]),o.locals&&(t.exports=o.locals);(0,s(80950).Z)("fbe0db4c",o,!0,{})},31729:(t,e,s)=>{var o=s(76450);o.__esModule&&(o=o.default),"string"==typeof o&&(o=[[t.id,o,""]]),o.locals&&(t.exports=o.locals);(0,s(80950).Z)("07c98e86",o,!0,{})},22128:(t,e,s)=>{var o=s(73040);o.__esModule&&(o=o.default),"string"==typeof o&&(o=[[t.id,o,""]]),o.locals&&(t.exports=o.locals);(0,s(80950).Z)("45f3f30c",o,!0,{})},98970:(t,e,s)=>{var o=s(5875);o.__esModule&&(o=o.default),"string"==typeof o&&(o=[[t.id,o,""]]),o.locals&&(t.exports=o.locals);(0,s(80950).Z)("247c312e",o,!0,{})},19071:(t,e,s)=>{var o=s(32362);o.__esModule&&(o=o.default),"string"==typeof o&&(o=[[t.id,o,""]]),o.locals&&(t.exports=o.locals);(0,s(80950).Z)("644e4668",o,!0,{})},69168:(t,e,s)=>{var o=s(49626);o.__esModule&&(o=o.default),"string"==typeof o&&(o=[[t.id,o,""]]),o.locals&&(t.exports=o.locals);(0,s(80950).Z)("f47d07f0",o,!0,{})},9568:(t,e,s)=>{var o=s(47242);o.__esModule&&(o=o.default),"string"==typeof o&&(o=[[t.id,o,""]]),o.locals&&(t.exports=o.locals);(0,s(80950).Z)("40384718",o,!0,{})},10298:(t,e,s)=>{var o=s(77682);o.__esModule&&(o=o.default),"string"==typeof o&&(o=[[t.id,o,""]]),o.locals&&(t.exports=o.locals);(0,s(80950).Z)("5d0db6e6",o,!0,{})}}]);