(self.webpackChunkmisskey=self.webpackChunkmisskey||[]).push([[5808],{78517:(e,t,a)=>{var n=a(11063),s=a(26143)(n);s.push([e.id,".xfhsjczc[data-v-bdc6ed76]{padding:0 16px}",""]),e.exports=s},57985:(e,t,a)=>{var n=a(11063),s=a(26143)(n);s.push([e.id,".romcojzs[data-v-7cdac738]{padding:0 16px 16px}",""]),e.exports=s},30203:(e,t,a)=>{var n=a(11063),s=a(26143)(n);s.push([e.id,".oyyftmcf>.preview[data-v-028dbefa]{height:150px}",""]),e.exports=s},76722:(e,t,a)=>{var n=a(11063),s=a(26143)(n);s.push([e.id,".ilrvjyvi>.children[data-v-7b88a5ee]{padding:16px}",""]),e.exports=s},41035:(e,t,a)=>{var n=a(11063),s=a(26143)(n);s.push([e.id,".kjuadyyj[data-v-65af1c48]{padding:0 16px 16px}",""]),e.exports=s},30424:(e,t,a)=>{var n=a(11063),s=a(26143)(n);s.push([e.id,".ihymsbbe>textarea[data-v-678b3625]{-webkit-appearance:none;-moz-appearance:none;appearance:none;background:transparent;border:none;box-shadow:none;color:var(--text);display:block;font-size:14px;min-height:150px;min-width:100%;padding:16px;resize:vertical;width:100%}",""]),e.exports=s},21165:(e,t,a)=>{var n=a(11063),s=a(26143)(n);s.push([e.id,".ihymsbbe>textarea[data-v-fa398676]{-webkit-appearance:none;-moz-appearance:none;appearance:none;background:transparent;border:none;box-shadow:none;color:var(--text);display:block;font-size:14px;min-height:150px;min-width:100%;padding:16px;resize:vertical;width:100%}",""]),e.exports=s},76876:(e,t,a)=>{var n=a(11063),s=a(26143)(n);s.push([e.id,".cpjygsrt[data-v-60ccf125]{background:var(--face);border:2px solid var(--pageBlockBorder);border-radius:6px;overflow:hidden}.cpjygsrt[data-v-60ccf125]:hover{border:2px solid var(--pageBlockBorderHover)}.cpjygsrt.warn[data-v-60ccf125]{border:2px solid #dec44c}.cpjygsrt.error[data-v-60ccf125]{border:2px solid red}.cpjygsrt+.cpjygsrt[data-v-60ccf125]{margin-top:16px}.cpjygsrt>header>.title[data-v-60ccf125]{box-shadow:0 1px rgba(0,0,0,.07);color:var(--faceHeaderText);font-size:.9em;font-weight:700;line-height:42px;margin:0;padding:0 16px;z-index:1}.cpjygsrt>header>.title>[data-icon][data-v-60ccf125]{margin-right:6px}.cpjygsrt>header>.title[data-v-60ccf125]:empty{display:none}.cpjygsrt>header>.buttons[data-v-60ccf125]{position:absolute;right:0;top:0;z-index:2}.cpjygsrt>header>.buttons>button[data-v-60ccf125]{color:var(--faceTextButton);font-size:.9em;line-height:42px;padding:0;width:42px}.cpjygsrt>header>.buttons>button[data-v-60ccf125]:hover{color:var(--faceTextButtonHover)}.cpjygsrt>header>.buttons>button[data-v-60ccf125]:active{color:var(--faceTextButtonActive)}.cpjygsrt>header>.buttons .drag-handle[data-v-60ccf125]{cursor:move}.cpjygsrt>.warn[data-v-60ccf125]{color:#b19e49}.cpjygsrt>.error[data-v-60ccf125],.cpjygsrt>.warn[data-v-60ccf125]{font-size:14px;margin:0;padding:16px 16px 0}.cpjygsrt>.error[data-v-60ccf125]{color:red}",""]),e.exports=s},47735:(e,t,a)=>{var n=a(11063),s=a(26143)(n);s.push([e.id,".turmquns[data-v-51cafd99]{opacity:.7}.pbglfege[data-v-51cafd99]{color:var(--text);cursor:pointer;opacity:.5;padding:16px;text-align:center}.tbwccoaw>input[data-v-51cafd99],.tbwccoaw>textarea[data-v-51cafd99]{-webkit-appearance:none;-moz-appearance:none;appearance:none;background:transparent;border:none;box-shadow:none;color:var(--text);display:block;font-size:16px;max-width:100%;min-width:100%;padding:16px;width:100%}.tbwccoaw>textarea[data-v-51cafd99]{min-height:100px}.hpdwcrvs[data-v-51cafd99]{padding:16px}.hpdwcrvs>select[data-v-51cafd99]{display:block;font-size:16px;padding:4px;width:100%}",""]),e.exports=s},88857:(e,t,a)=>{var n=a(11063),s=a(26143)(n);s.push([e.id,".gwbmwxkm[data-v-50ba5632]{background:var(--face);border-radius:6px;box-shadow:0 3px 8px rgba(0,0,0,.2);margin-bottom:16px;overflow:hidden}.gwbmwxkm>header[data-v-50ba5632]{background:var(--faceHeader)}.gwbmwxkm>header>.title[data-v-50ba5632]{box-shadow:0 var(--lineWidth) rgba(0,0,0,.07);color:var(--faceHeaderText);font-size:.9em;font-weight:700;line-height:42px;margin:0;padding:0 16px;z-index:1}.gwbmwxkm>header>.title>[data-icon][data-v-50ba5632]{margin-right:6px}.gwbmwxkm>header>.title[data-v-50ba5632]:empty{display:none}.gwbmwxkm>header>.buttons[data-v-50ba5632]{position:absolute;right:0;top:0;z-index:2}.gwbmwxkm>header>.buttons>button[data-v-50ba5632]{color:var(--faceTextButton);font-size:.9em;line-height:42px;padding:0;width:42px}.gwbmwxkm>header>.buttons>button[data-v-50ba5632]:hover{color:var(--faceTextButtonHover)}.gwbmwxkm>header>.buttons>button[data-v-50ba5632]:active{color:var(--faceTextButtonActive)}.gwbmwxkm>section[data-v-50ba5632]{padding:0 32px 32px}@media (max-width:500px){.gwbmwxkm>section[data-v-50ba5632]{padding:0 16px 16px}}.gwbmwxkm>section>.view[data-v-50ba5632]{display:inline-block;font-size:14px;margin:16px 0 0}.gwbmwxkm>section>.content[data-v-50ba5632],.gwbmwxkm>section>.eyeCatch[data-v-50ba5632]{margin-bottom:16px}.gwbmwxkm>section>.eyeCatch>div>img[data-v-50ba5632]{max-width:100%}.qmuvgica[data-v-50ba5632]{padding:32px}@media (max-width:500px){.qmuvgica[data-v-50ba5632]{padding:16px}}.qmuvgica>.add[data-v-50ba5632],.qmuvgica>.variables[data-v-50ba5632]{margin-bottom:16px}",""]),e.exports=s},11804:(e,t,a)=>{"use strict";function n(e){const t=[],a=e=>{for(const n of e)"textInput"===n.type||"textareaInput"===n.type?t.push({name:n.name,type:"string",value:n.default||""}):"numberInput"===n.type?t.push({name:n.name,type:"number",value:n.default||0}):"switch"===n.type?t.push({name:n.name,type:"boolean",value:n.default||!1}):"counter"===n.type?t.push({name:n.name,type:"number",value:0}):"radioButton"===n.type?t.push({name:n.name,type:"string",value:n.default||""}):n.children&&a(n.children)};return a(e),t}a.d(t,{k:()=>n})},73300:(e,t,a)=>{"use strict";a.d(t,{Mo:()=>u,iN:()=>i,kO:()=>c,uA:()=>r,vH:()=>l});var n=a(32971),s=a(3123);const i={if:{in:["boolean",0,0],out:0,category:"flow",icon:n.EfQ},for:{in:["number","function"],out:null,category:"flow",icon:n.TZC},not:{in:["boolean"],out:"boolean",category:"logical",icon:s.Rr},or:{in:["boolean","boolean"],out:"boolean",category:"logical",icon:s.Rr},and:{in:["boolean","boolean"],out:"boolean",category:"logical",icon:s.Rr},add:{in:["number","number"],out:"number",category:"operation",icon:n.r8p},subtract:{in:["number","number"],out:"number",category:"operation",icon:n.Kl4},multiply:{in:["number","number"],out:"number",category:"operation",icon:n.NBC},divide:{in:["number","number"],out:"number",category:"operation",icon:n.pGc},mod:{in:["number","number"],out:"number",category:"operation",icon:n.pGc},round:{in:["number"],out:"number",category:"operation",icon:n.lTt},eq:{in:[0,0],out:"boolean",category:"comparison",icon:n.Lvu},notEq:{in:[0,0],out:"boolean",category:"comparison",icon:n.u34},gt:{in:["number","number"],out:"boolean",category:"comparison",icon:n.WqQ},lt:{in:["number","number"],out:"boolean",category:"comparison",icon:n.GQf},gtEq:{in:["number","number"],out:"boolean",category:"comparison",icon:n.GJP},ltEq:{in:["number","number"],out:"boolean",category:"comparison",icon:n.ERW},strLen:{in:["string"],out:"number",category:"text",icon:n.Elr},strPick:{in:["string","number"],out:"string",category:"text",icon:n.Elr},strReplace:{in:["string","string","string"],out:"string",category:"text",icon:n.Elr},strReverse:{in:["string"],out:"string",category:"text",icon:n.Elr},join:{in:["stringArray","string"],out:"string",category:"text",icon:n.Elr},stringToNumber:{in:["string"],out:"number",category:"convert",icon:n.Ssp},numberToString:{in:["number"],out:"string",category:"convert",icon:n.Ssp},splitStrByLine:{in:["string"],out:"stringArray",category:"convert",icon:n.Ssp},pick:{in:[null,"number"],out:null,category:"list",icon:n.s$_},listLen:{in:[null],out:"number",category:"list",icon:n.s$_},rannum:{in:["number","number"],out:"number",category:"random",icon:n.RJo},dailyRannum:{in:["number","number"],out:"number",category:"random",icon:n.RJo},seedRannum:{in:[null,"number","number"],out:"number",category:"random",icon:n.RJo},random:{in:["number"],out:"boolean",category:"random",icon:n.RJo},dailyRandom:{in:["number"],out:"boolean",category:"random",icon:n.RJo},seedRandom:{in:[null,"number"],out:"boolean",category:"random",icon:n.RJo},randomPick:{in:[0],out:0,category:"random",icon:n.RJo},dailyRandomPick:{in:[0],out:0,category:"random",icon:n.RJo},seedRandomPick:{in:[null,0],out:0,category:"random",icon:n.RJo},DRPWPM:{in:["stringArray"],out:"string",category:"random",icon:n.RJo}},o={text:{out:"string",category:"value",icon:n.Elr},multiLineText:{out:"string",category:"value",icon:n.elf},textList:{out:"stringArray",category:"value",icon:n.Zrf},number:{out:"number",category:"value",icon:n.g2k},ref:{out:null,category:"value",icon:n.een},fn:{out:"function",category:"value",icon:n.by$}},r=[...Object.entries(o).map((([e,t])=>({type:e,out:t.out,category:t.category,icon:t.icon}))),...Object.entries(i).map((([e,t])=>({type:e,out:t.out,category:t.category,icon:t.icon})))];function l(e){return"fn"===e.type}const u={AI:"string",URL:"string",VERSION:"string",LOGIN:"boolean",NAME:"string",USERNAME:"string",USERID:"string",NOTES_COUNT:"number",FOLLOWERS_COUNT:"number",FOLLOWING_COUNT:"number",IS_CAT:"boolean",MY_NOTES_COUNT:"number",MY_FOLLOWERS_COUNT:"number",MY_FOLLOWING_COUNT:"number",SEED:null,YMD:"string",YEAR:"number",MON:"number",DAY:"number",HOUR:"number",MIN:"number",SEC:"number",NULL:null};function c(e){return null===e.type||!!o[e.type]}},45025:(e,t,a)=>{"use strict";a.d(t,{Z:()=>R});var n=a(31508),s=a(77513),i=a.n(s),o=a(37705),r=a(32971),l=a(3123),u=a(46813),c=a(65787);const p=n.ZP.extend({i18n:(0,u.Z)("pages"),components:{XContainer:c.Z},inject:["getPageBlockList"],props:{value:{required:!0},aiScript:{required:!0}},data:()=>({faStickyNote:l.L4,faPlus:r.r8p,faPencilAlt:r.UJf}),beforeCreate(){this.$options.components.XBlocks=a(45025).Z},created(){null==this.value.title&&n.ZP.set(this.value,"title",null),null==this.value.children&&n.ZP.set(this.value,"children",[])},mounted(){null==this.value.title&&this.rename()},methods:{async rename(){const{canceled:e,result:t}=await this.$root.dialog({title:"Enter title",input:{type:"text",default:this.value.title},showCancelButton:!0});e||(this.value.title=t)},async add(){const{canceled:e,result:t}=await this.$root.dialog({type:null,title:this.$t("choose-block"),select:{groupedItems:this.getPageBlockList()},showCancelButton:!0});if(e)return;const a=(0,o.Z)();this.value.children.push({id:a,type:t})}}});a(14879);var d=a(26385);const v=(0,d.Z)(p,(function(){var e=this,t=e._self._c;e._self._setupProxy;return t("x-container",{attrs:{draggable:!0},on:{remove:()=>e.$emit("remove")},scopedSlots:e._u([{key:"header",fn:function(){return[t("fa",{attrs:{icon:e.faStickyNote}}),e._v(" "+e._s(e.value.title))]},proxy:!0},{key:"func",fn:function(){return[t("button",{on:{click:function(t){return e.rename()}}},[t("fa",{attrs:{icon:e.faPencilAlt}})],1),t("button",{on:{click:function(t){return e.add()}}},[t("fa",{attrs:{icon:e.faPlus}})],1)]},proxy:!0}])},[t("section",{staticClass:"ilrvjyvi"},[t("x-blocks",{staticClass:"children",attrs:{"ai-script":e.aiScript},model:{value:e.value.children,callback:function(t){e.$set(e.value,"children",t)},expression:"value.children"}})],1)])}),[],!1,null,"7b88a5ee",null).exports;const m=n.ZP.extend({i18n:(0,u.Z)("pages"),components:{XContainer:c.Z},props:{value:{required:!0}},data:()=>({faAlignLeft:r.elf}),created(){null==this.value.text&&n.ZP.set(this.value,"text","")}});a(10444);const f=(0,d.Z)(m,(function(){var e=this,t=e._self._c;e._self._setupProxy;return t("x-container",{attrs:{draggable:!0},on:{remove:()=>e.$emit("remove")},scopedSlots:e._u([{key:"header",fn:function(){return[t("fa",{attrs:{icon:e.faAlignLeft}}),e._v(" "+e._s(e.$t("blocks.text")))]},proxy:!0}])},[t("section",{staticClass:"ihymsbbe"},[t("textarea",{directives:[{name:"model",rawName:"v-model",value:e.value.text,expression:"value.text"}],domProps:{value:e.value.text},on:{input:function(t){t.target.composing||e.$set(e.value,"text",t.target.value)}}})])])}),[],!1,null,"678b3625",null).exports;const h=n.ZP.extend({i18n:(0,u.Z)("pages"),components:{XContainer:c.Z},props:{value:{required:!0}},data:()=>({faAlignLeft:r.elf}),created(){null==this.value.text&&n.ZP.set(this.value,"text","")}});a(85035);const g=(0,d.Z)(h,(function(){var e=this,t=e._self._c;e._self._setupProxy;return t("x-container",{attrs:{draggable:!0},on:{remove:()=>e.$emit("remove")},scopedSlots:e._u([{key:"header",fn:function(){return[t("fa",{attrs:{icon:e.faAlignLeft}}),e._v(" "+e._s(e.$t("blocks.textarea")))]},proxy:!0}])},[t("section",{staticClass:"ihymsbbe"},[t("textarea",{directives:[{name:"model",rawName:"v-model",value:e.value.text,expression:"value.text"}],domProps:{value:e.value.text},on:{input:function(t){t.target.composing||e.$set(e.value,"text",t.target.value)}}})])])}),[],!1,null,"fa398676",null).exports;var b=a(21892);const y=n.ZP.extend({i18n:(0,u.Z)("pages"),components:{XContainer:c.Z,XFileThumbnail:b.Z},props:{value:{required:!0}},data:()=>({file:null,faPencilAlt:r.UJf,faImage:l.Vm,faFolderOpen:l.cC}),created(){void 0===this.value.fileId&&n.ZP.set(this.value,"fileId",null)},mounted(){null==this.value.fileId?this.choose():this.$root.api("drive/files/show",{fileId:this.value.fileId}).then((e=>{this.file=e}))},methods:{async choose(){this.$chooseDriveFile({multiple:!1}).then((e=>{this.file=e,this.value.fileId=e.id}))}}});a(9937);const x=(0,d.Z)(y,(function(){var e=this,t=e._self._c;e._self._setupProxy;return t("x-container",{attrs:{draggable:!0},on:{remove:()=>e.$emit("remove")},scopedSlots:e._u([{key:"header",fn:function(){return[t("fa",{attrs:{icon:e.faImage}}),e._v(" "+e._s(e.$t("blocks.image")))]},proxy:!0},{key:"func",fn:function(){return[t("button",{on:{click:function(t){return e.choose()}}},[t("fa",{attrs:{icon:e.faFolderOpen}})],1)]},proxy:!0}])},[t("section",{staticClass:"oyyftmcf"},[e.file?t("x-file-thumbnail",{staticClass:"preview",attrs:{file:e.file,detail:!0,fit:"contain"},on:{click:function(t){return e.choose()}}}):e._e()],1)])}),[],!1,null,"028dbefa",null).exports;const _=n.ZP.extend({i18n:(0,u.Z)("pages"),components:{XContainer:c.Z},props:{value:{required:!0},aiScript:{required:!0}},data:()=>({faBolt:r.BDt}),created(){null==this.value.text&&n.ZP.set(this.value,"text",""),null==this.value.action&&n.ZP.set(this.value,"action","dialog"),null==this.value.content&&n.ZP.set(this.value,"content",null),null==this.value.event&&n.ZP.set(this.value,"event",null),null==this.value.message&&n.ZP.set(this.value,"message",null),null==this.value.primary&&n.ZP.set(this.value,"primary",!1),null==this.value.var&&n.ZP.set(this.value,"var",null)}});a(39606);const k=(0,d.Z)(_,(function(){var e=this,t=e._self._c;e._self._setupProxy;return t("x-container",{attrs:{draggable:!0},on:{remove:()=>e.$emit("remove")},scopedSlots:e._u([{key:"header",fn:function(){return[t("fa",{attrs:{icon:e.faBolt}}),e._v(" "+e._s(e.$t("blocks.button")))]},proxy:!0}])},[t("section",{staticClass:"xfhsjczc"},[t("ui-input",{model:{value:e.value.text,callback:function(t){e.$set(e.value,"text",t)},expression:"value.text"}},[t("span",[e._v(e._s(e.$t("blocks._button.text")))])]),t("ui-switch",{model:{value:e.value.primary,callback:function(t){e.$set(e.value,"primary",t)},expression:"value.primary"}},[t("span",[e._v(e._s(e.$t("blocks._button.colored")))])]),t("ui-select",{scopedSlots:e._u([{key:"label",fn:function(){return[e._v(e._s(e.$t("blocks._button.action")))]},proxy:!0}]),model:{value:e.value.action,callback:function(t){e.$set(e.value,"action",t)},expression:"value.action"}},[t("option",{attrs:{value:"dialog"}},[e._v(e._s(e.$t("blocks._button._action.dialog")))]),t("option",{attrs:{value:"resetRandom"}},[e._v(e._s(e.$t("blocks._button._action.resetRandom")))]),t("option",{attrs:{value:"pushEvent"}},[e._v(e._s(e.$t("blocks._button._action.pushEvent")))])]),"dialog"===e.value.action?[t("ui-input",{model:{value:e.value.content,callback:function(t){e.$set(e.value,"content",t)},expression:"value.content"}},[t("span",[e._v(e._s(e.$t("blocks._button._action._dialog.content")))])])]:"pushEvent"===e.value.action?[t("ui-input",{model:{value:e.value.event,callback:function(t){e.$set(e.value,"event",t)},expression:"value.event"}},[t("span",[e._v(e._s(e.$t("blocks._button._action._pushEvent.event")))])]),t("ui-input",{model:{value:e.value.message,callback:function(t){e.$set(e.value,"message",t)},expression:"value.message"}},[t("span",[e._v(e._s(e.$t("blocks._button._action._pushEvent.message")))])]),t("ui-select",{scopedSlots:e._u([{key:"label",fn:function(){return[e._v(e._s(e.$t("blocks._button._action._pushEvent.variable")))]},proxy:!0}]),model:{value:e.value.var,callback:function(t){e.$set(e.value,"var",t)},expression:"value.var"}},[t("option",{domProps:{value:null}},[e._v(e._s(e.$t("blocks._button._action._pushEvent.no-variable")))]),e._l(e.aiScript.getVarsByType(),(function(a){return t("option",{domProps:{value:a.name}},[e._v(e._s(a.name))])})),t("optgroup",{attrs:{label:e.$t("script.pageVariables")}},e._l(e.aiScript.getPageVarsByType(),(function(a){return t("option",{domProps:{value:a}},[e._v(e._s(a))])})),0),t("optgroup",{attrs:{label:e.$t("script.enviromentVariables")}},e._l(e.aiScript.getEnvVarsByType(),(function(a){return t("option",{domProps:{value:a}},[e._v(e._s(a))])})),0)],2)]:e._e()],2)])}),[],!1,null,"bdc6ed76",null).exports;const $=n.ZP.extend({i18n:(0,u.Z)("pages"),components:{XContainer:c.Z},props:{value:{required:!0}},data:()=>({faBolt:r.BDt,faMagic:r.een}),created(){null==this.value.name&&n.ZP.set(this.value,"name","")}});const w=(0,d.Z)($,(function(){var e=this,t=e._self._c;e._self._setupProxy;return t("x-container",{attrs:{draggable:!0},on:{remove:()=>e.$emit("remove")},scopedSlots:e._u([{key:"header",fn:function(){return[t("fa",{attrs:{icon:e.faBolt}}),e._v(" "+e._s(e.$t("blocks.textInput")))]},proxy:!0}])},[t("section",{staticStyle:{padding:"0 16px 0 16px"}},[t("ui-input",{scopedSlots:e._u([{key:"prefix",fn:function(){return[t("fa",{attrs:{icon:e.faMagic}})]},proxy:!0}]),model:{value:e.value.name,callback:function(t){e.$set(e.value,"name",t)},expression:"value.name"}},[t("span",[e._v(e._s(e.$t("blocks._textInput.name")))])]),t("ui-input",{model:{value:e.value.text,callback:function(t){e.$set(e.value,"text",t)},expression:"value.text"}},[t("span",[e._v(e._s(e.$t("blocks._textInput.text")))])]),t("ui-input",{attrs:{type:"text"},model:{value:e.value.default,callback:function(t){e.$set(e.value,"default",t)},expression:"value.default"}},[t("span",[e._v(e._s(e.$t("blocks._textInput.default")))])])],1)])}),[],!1,null,null,null).exports;const P=n.ZP.extend({i18n:(0,u.Z)("pages"),components:{XContainer:c.Z},props:{value:{required:!0}},data:()=>({faBolt:r.BDt,faMagic:r.een}),created(){null==this.value.name&&n.ZP.set(this.value,"name","")}});const Z=(0,d.Z)(P,(function(){var e=this,t=e._self._c;e._self._setupProxy;return t("x-container",{attrs:{draggable:!0},on:{remove:()=>e.$emit("remove")},scopedSlots:e._u([{key:"header",fn:function(){return[t("fa",{attrs:{icon:e.faBolt}}),e._v(" "+e._s(e.$t("blocks.textareaInput")))]},proxy:!0}])},[t("section",{staticStyle:{padding:"0 16px 16px 16px"}},[t("ui-input",{scopedSlots:e._u([{key:"prefix",fn:function(){return[t("fa",{attrs:{icon:e.faMagic}})]},proxy:!0}]),model:{value:e.value.name,callback:function(t){e.$set(e.value,"name",t)},expression:"value.name"}},[t("span",[e._v(e._s(e.$t("blocks._textareaInput.name")))])]),t("ui-input",{model:{value:e.value.text,callback:function(t){e.$set(e.value,"text",t)},expression:"value.text"}},[t("span",[e._v(e._s(e.$t("blocks._textareaInput.text")))])]),t("ui-textarea",{model:{value:e.value.default,callback:function(t){e.$set(e.value,"default",t)},expression:"value.default"}},[t("span",[e._v(e._s(e.$t("blocks._textareaInput.default")))])])],1)])}),[],!1,null,null,null).exports;const S=n.ZP.extend({i18n:(0,u.Z)("pages"),components:{XContainer:c.Z},props:{value:{required:!0}},data:()=>({faBolt:r.BDt,faMagic:r.een}),created(){null==this.value.name&&n.ZP.set(this.value,"name","")}});const C=(0,d.Z)(S,(function(){var e=this,t=e._self._c;e._self._setupProxy;return t("x-container",{attrs:{draggable:!0},on:{remove:()=>e.$emit("remove")},scopedSlots:e._u([{key:"header",fn:function(){return[t("fa",{attrs:{icon:e.faBolt}}),e._v(" "+e._s(e.$t("blocks.numberInput")))]},proxy:!0}])},[t("section",{staticStyle:{padding:"0 16px 0 16px"}},[t("ui-input",{scopedSlots:e._u([{key:"prefix",fn:function(){return[t("fa",{attrs:{icon:e.faMagic}})]},proxy:!0}]),model:{value:e.value.name,callback:function(t){e.$set(e.value,"name",t)},expression:"value.name"}},[t("span",[e._v(e._s(e.$t("blocks._numberInput.name")))])]),t("ui-input",{model:{value:e.value.text,callback:function(t){e.$set(e.value,"text",t)},expression:"value.text"}},[t("span",[e._v(e._s(e.$t("blocks._numberInput.text")))])]),t("ui-input",{attrs:{type:"number"},model:{value:e.value.default,callback:function(t){e.$set(e.value,"default",t)},expression:"value.default"}},[t("span",[e._v(e._s(e.$t("blocks._numberInput.default")))])])],1)])}),[],!1,null,null,null).exports;const I=n.ZP.extend({i18n:(0,u.Z)("pages"),components:{XContainer:c.Z},props:{value:{required:!0}},data:()=>({faBolt:r.BDt,faMagic:r.een}),created(){null==this.value.name&&n.ZP.set(this.value,"name","")}});a(37402);const B=(0,d.Z)(I,(function(){var e=this,t=e._self._c;e._self._setupProxy;return t("x-container",{attrs:{draggable:!0},on:{remove:()=>e.$emit("remove")},scopedSlots:e._u([{key:"header",fn:function(){return[t("fa",{attrs:{icon:e.faBolt}}),e._v(" "+e._s(e.$t("blocks.switch")))]},proxy:!0}])},[t("section",{staticClass:"kjuadyyj"},[t("ui-input",{scopedSlots:e._u([{key:"prefix",fn:function(){return[t("fa",{attrs:{icon:e.faMagic}})]},proxy:!0}]),model:{value:e.value.name,callback:function(t){e.$set(e.value,"name",t)},expression:"value.name"}},[t("span",[e._v(e._s(e.$t("blocks._switch.name")))])]),t("ui-input",{model:{value:e.value.text,callback:function(t){e.$set(e.value,"text",t)},expression:"value.text"}},[t("span",[e._v(e._s(e.$t("blocks._switch.text")))])]),t("ui-switch",{model:{value:e.value.default,callback:function(t){e.$set(e.value,"default",t)},expression:"value.default"}},[t("span",[e._v(e._s(e.$t("blocks._switch.default")))])])],1)])}),[],!1,null,"65af1c48",null).exports;const T=n.ZP.extend({i18n:(0,u.Z)("pages"),components:{XContainer:c.Z},inject:["getPageBlockList"],props:{value:{required:!0},aiScript:{required:!0}},data:()=>({faPlus:r.r8p,faQuestion:r.Psp}),beforeCreate(){this.$options.components.XBlocks=a(45025).Z},created(){null==this.value.children&&n.ZP.set(this.value,"children",[]),void 0===this.value.var&&n.ZP.set(this.value,"var",null)},methods:{async add(){const{canceled:e,result:t}=await this.$root.dialog({type:null,title:this.$t("choose-block"),select:{groupedItems:this.getPageBlockList()},showCancelButton:!0});if(e)return;const a=(0,o.Z)();this.value.children.push({id:a,type:t})}}});a(58497);const E=(0,d.Z)(T,(function(){var e=this,t=e._self._c;e._self._setupProxy;return t("x-container",{attrs:{draggable:!0},on:{remove:()=>e.$emit("remove")},scopedSlots:e._u([{key:"header",fn:function(){return[t("fa",{attrs:{icon:e.faQuestion}}),e._v(" "+e._s(e.$t("blocks.if")))]},proxy:!0},{key:"func",fn:function(){return[t("button",{on:{click:function(t){return e.add()}}},[t("fa",{attrs:{icon:e.faPlus}})],1)]},proxy:!0}])},[t("section",{staticClass:"romcojzs"},[t("ui-select",{scopedSlots:e._u([{key:"label",fn:function(){return[e._v(e._s(e.$t("blocks._if.variable")))]},proxy:!0}]),model:{value:e.value.var,callback:function(t){e.$set(e.value,"var",t)},expression:"value.var"}},[e._l(e.aiScript.getVarsByType("boolean"),(function(a){return t("option",{domProps:{value:a.name}},[e._v(e._s(a.name))])})),t("optgroup",{attrs:{label:e.$t("script.pageVariables")}},e._l(e.aiScript.getPageVarsByType("boolean"),(function(a){return t("option",{domProps:{value:a}},[e._v(e._s(a))])})),0),t("optgroup",{attrs:{label:e.$t("script.enviromentVariables")}},e._l(e.aiScript.getEnvVarsByType("boolean"),(function(a){return t("option",{domProps:{value:a}},[e._v(e._s(a))])})),0)],2),t("x-blocks",{staticClass:"children",attrs:{"ai-script":e.aiScript},model:{value:e.value.children,callback:function(t){e.$set(e.value,"children",t)},expression:"value.children"}})],1)])}),[],!1,null,"7cdac738",null).exports;const N=n.ZP.extend({i18n:(0,u.Z)("pages"),components:{XContainer:c.Z},props:{value:{required:!0}},data:()=>({faPaperPlane:l.XC}),created(){null==this.value.text&&n.ZP.set(this.value,"text","")}});const L=(0,d.Z)(N,(function(){var e=this,t=e._self._c;e._self._setupProxy;return t("x-container",{attrs:{draggable:!0},on:{remove:()=>e.$emit("remove")},scopedSlots:e._u([{key:"header",fn:function(){return[t("fa",{attrs:{icon:e.faPaperPlane}}),e._v(" "+e._s(e.$t("blocks.post")))]},proxy:!0}])},[t("section",{staticStyle:{padding:"0 16px 16px 16px"}},[t("ui-textarea",{model:{value:e.value.text,callback:function(t){e.$set(e.value,"text",t)},expression:"value.text"}},[e._v(e._s(e.$t("blocks._post.text")))])],1)])}),[],!1,null,null,null).exports;const q=n.ZP.extend({i18n:(0,u.Z)("pages"),components:{XContainer:c.Z},props:{value:{required:!0}},data:()=>({faBolt:r.BDt,faMagic:r.een}),created(){null==this.value.name&&n.ZP.set(this.value,"name","")}});const M=(0,d.Z)(q,(function(){var e=this,t=e._self._c;e._self._setupProxy;return t("x-container",{attrs:{draggable:!0},on:{remove:()=>e.$emit("remove")},scopedSlots:e._u([{key:"header",fn:function(){return[t("fa",{attrs:{icon:e.faBolt}}),e._v(" "+e._s(e.$t("blocks.counter")))]},proxy:!0}])},[t("section",{staticStyle:{padding:"0 16px 0 16px"}},[t("ui-input",{scopedSlots:e._u([{key:"prefix",fn:function(){return[t("fa",{attrs:{icon:e.faMagic}})]},proxy:!0}]),model:{value:e.value.name,callback:function(t){e.$set(e.value,"name",t)},expression:"value.name"}},[t("span",[e._v(e._s(e.$t("blocks._counter.name")))])]),t("ui-input",{model:{value:e.value.text,callback:function(t){e.$set(e.value,"text",t)},expression:"value.text"}},[t("span",[e._v(e._s(e.$t("blocks._counter.text")))])]),t("ui-input",{attrs:{type:"number"},model:{value:e.value.inc,callback:function(t){e.$set(e.value,"inc",t)},expression:"value.inc"}},[t("span",[e._v(e._s(e.$t("blocks._counter.inc")))])])],1)])}),[],!1,null,null,null).exports;const j=n.ZP.extend({i18n:(0,u.Z)("pages"),components:{XContainer:c.Z},props:{value:{required:!0}},data:()=>({values:"",faBolt:r.BDt,faMagic:r.een}),watch:{values(){n.ZP.set(this.value,"values",this.values.split("\n"))}},created(){null==this.value.name&&n.ZP.set(this.value,"name",""),null==this.value.title&&n.ZP.set(this.value,"title",""),null==this.value.values&&n.ZP.set(this.value,"values",[]),this.values=this.value.values.join("\n")}});const V=(0,d.Z)(j,(function(){var e=this,t=e._self._c;e._self._setupProxy;return t("x-container",{attrs:{draggable:!0},on:{remove:()=>e.$emit("remove")},scopedSlots:e._u([{key:"header",fn:function(){return[t("fa",{attrs:{icon:e.faBolt}}),e._v(" "+e._s(e.$t("blocks.radioButton")))]},proxy:!0}])},[t("section",{staticStyle:{padding:"0 16px 16px 16px"}},[t("ui-input",{scopedSlots:e._u([{key:"prefix",fn:function(){return[t("fa",{attrs:{icon:e.faMagic}})]},proxy:!0}]),model:{value:e.value.name,callback:function(t){e.$set(e.value,"name",t)},expression:"value.name"}},[t("span",[e._v(e._s(e.$t("blocks._radioButton.name")))])]),t("ui-input",{model:{value:e.value.title,callback:function(t){e.$set(e.value,"title",t)},expression:"value.title"}},[t("span",[e._v(e._s(e.$t("blocks._radioButton.title")))])]),t("ui-textarea",{model:{value:e.values,callback:function(t){e.values=t},expression:"values"}},[t("span",[e._v(e._s(e.$t("blocks._radioButton.values")))])]),t("ui-input",{model:{value:e.value.default,callback:function(t){e.$set(e.value,"default",t)},expression:"value.default"}},[t("span",[e._v(e._s(e.$t("blocks._radioButton.default")))])])],1)])}),[],!1,null,null,null).exports,O=n.ZP.extend({components:{XDraggable:i(),XSection:v,XText:f,XImage:x,XButton:k,XTextarea:g,XTextInput:w,XTextareaInput:Z,XNumberInput:C,XSwitch:B,XIf:E,XPost:L,XCounter:M,XRadioButton:V},props:{value:{type:Array,required:!0},aiScript:{required:!0}},computed:{blocks(){return this.value}},methods:{updateItem(e){const t=this.blocks.findIndex((t=>t.id===e.id)),a=[...this.blocks.slice(0,t),e,...this.blocks.slice(t+1)];this.$emit("input",a)},removeItem(e){const t=this.blocks.findIndex((t=>t.id===e.id)),a=[...this.blocks.slice(0,t),...this.blocks.slice(t+1)];this.$emit("input",a)}}});const R=(0,d.Z)(O,(function(){var e=this,t=e._self._c;e._self._setupProxy;return t("x-draggable",{attrs:{tag:"div",list:e.blocks,handle:".drag-handle",group:{name:"blocks"},animation:"150","swap-threshold":"0.5"}},e._l(e.blocks,(function(a){return t("x-"+a.type,{key:a.id,tag:"component",attrs:{value:a,"ai-script":e.aiScript},on:{input:e.updateItem,remove:()=>e.removeItem(a)}})})),1)}),[],!1,null,null,null).exports},65787:(e,t,a)=>{"use strict";a.d(t,{Z:()=>l});var n=a(31508),s=a(32971),i=a(3123),o=a(46813);const r=n.ZP.extend({i18n:(0,o.Z)("pages"),props:{expanded:{type:Boolean,default:!0},removable:{type:Boolean,default:!0},draggable:{type:Boolean,default:!1},error:{required:!1,default:null},warn:{required:!1,default:null}},data(){return{showBody:this.expanded,faTrashAlt:i.I7,faBars:s.xiG}},methods:{toggleContent(e){this.showBody=e,this.$emit("toggle",e)},remove(){this.$emit("remove")}}});a(17925);const l=(0,a(26385).Z)(r,(function(){var e=this,t=e._self._c;e._self._setupProxy;return t("div",{staticClass:"cpjygsrt",class:{error:null!=e.error,warn:null!=e.warn}},[t("header",[t("div",{staticClass:"title"},[e._t("header")],2),t("div",{staticClass:"buttons"},[e._t("func"),e.removable?t("button",{on:{click:function(t){return e.remove()}}},[t("fa",{attrs:{icon:e.faTrashAlt}})],1):e._e(),e.draggable?t("button",{staticClass:"drag-handle"},[t("fa",{attrs:{icon:e.faBars}})],1):e._e(),t("button",{on:{click:function(t){return e.toggleContent(!e.showBody)}}},[e.showBody?[t("fa",{attrs:{icon:"angle-up"}})]:[t("fa",{attrs:{icon:"angle-down"}})]],2)],2)]),null!=e.error?t("p",{directives:[{name:"show",rawName:"v-show",value:e.showBody,expression:"showBody"}],staticClass:"error"},[e._v(e._s(e.$t("script.typeError",{slot:e.error.arg+1,expect:e.$t(`script.types.${e.error.expect}`),actual:e.$t(`script.types.${e.error.actual}`)})))]):e._e(),null!=e.warn?t("p",{directives:[{name:"show",rawName:"v-show",value:e.showBody,expression:"showBody"}],staticClass:"warn"},[e._v(e._s(e.$t("script.thereIsEmptySlot",{slot:e.warn.slot+1})))]):e._e(),t("div",{directives:[{name:"show",rawName:"v-show",value:e.showBody,expression:"showBody"}]},[e._t("default")],2)])}),[],!1,null,"60ccf125",null).exports},72776:(e,t,a)=>{"use strict";a.d(t,{Z:()=>c});var n=a(31508),s=a(46813),i=a(65787),o=a(32971),r=a(73300),l=a(37705);const u=n.ZP.extend({i18n:(0,s.Z)("pages"),components:{XContainer:i.Z},inject:["getScriptBlockList"],props:{getExpectedType:{required:!1,default:null},value:{required:!0},title:{required:!1},removable:{required:!1,default:!1},aiScript:{required:!0},name:{required:!0},fnSlots:{required:!1},draggable:{required:!1,default:!1}},data:()=>({error:null,warn:null,slots:"",faPencilAlt:o.UJf}),computed:{icon(){return null===this.value.type?null:this.value.type.startsWith("fn:")?o.oso:r.uA.find((e=>e.type===this.value.type)).icon},typeText(){return null===this.value.type?null:this.value.type.startsWith("fn:")?this.value.type.split(":")[1]:this.$t(`script.blocks.${this.value.type}`)}},watch:{slots(){this.value.value.slots=this.slots.split("\n").map((e=>({name:e,type:null})))}},beforeCreate(){this.$options.components.XV=a(72776).Z},created(){null==this.value.value&&n.ZP.set(this.value,"value",null),this.value.value&&this.value.value.slots&&(this.slots=this.value.value.slots.map((e=>e.name)).join("\n")),this.$watch("value.type",(e=>{if(this.warn=null,"fn"===this.value.type){const e=(0,l.Z)();return this.value.value={},n.ZP.set(this.value.value,"slots",[]),void n.ZP.set(this.value.value,"expression",{id:e,type:null})}if(this.value.type&&this.value.type.startsWith("fn:")){const e=this.value.type.split(":")[1],t=this.aiScript.getVarByName(e),a=[];for(let e=0;e<t.value.slots.length;e++){const e=(0,l.Z)();a.push({id:e,type:null})}return void n.ZP.set(this.value,"args",a)}if((0,r.kO)(this.value))return;const t=[];for(let e=0;e<r.iN[this.value.type].in.length;e++){const e=(0,l.Z)();t.push({id:e,type:null})}n.ZP.set(this.value,"args",t);for(let e=0;e<r.iN[this.value.type].in.length;e++){const t=r.iN[this.value.type].in[e];"number"!=typeof t&&("number"===t&&(this.value.args[e].type="number"),"string"===t&&(this.value.args[e].type="text"))}})),this.$watch("value.args",(e=>{if(null==e)return void(this.warn=null);const t=e.findIndex((e=>null===e.type));-1!==t&&t<e.length?this.warn={slot:t}:this.warn=null}),{deep:!0}),this.$watch("aiScript.variables",(()=>{null!=this.type&&this.value&&(this.error=this.aiScript.typeCheck(this.value))}),{deep:!0})},methods:{async changeType(){const{canceled:e,result:t}=await this.$root.dialog({type:null,title:this.$t("select-type"),select:{groupedItems:this.getScriptBlockList(this.getExpectedType?this.getExpectedType():null)},showCancelButton:!0});e||(this.value.type=t)},_getExpectedType(e){return this.aiScript.getExpectedType(this.value,e)}}});a(3193);const c=(0,a(26385).Z)(u,(function(){var e=this,t=e._self._c;e._self._setupProxy;return t("x-container",{attrs:{removable:e.removable,error:e.error,warn:e.warn,draggable:e.draggable},on:{remove:()=>e.$emit("remove")},scopedSlots:e._u([{key:"header",fn:function(){return[e.icon?t("fa",{attrs:{icon:e.icon}}):e._e(),e.title?[e._v(e._s(e.title)+" "),e.typeText?t("span",{staticClass:"turmquns"},[e._v("("+e._s(e.typeText)+")")]):e._e()]:e.typeText?[e._v(e._s(e.typeText))]:e._e()]},proxy:!0},{key:"func",fn:function(){return[t("button",{on:{click:function(t){return e.changeType()}}},[t("fa",{attrs:{icon:e.faPencilAlt}})],1)]},proxy:!0}])},[null===e.value.type?t("section",{staticClass:"pbglfege",on:{click:function(t){return e.changeType()}}},[e._v("\n\t\t"+e._s(e.$t("script.emptySlot"))+"\n\t")]):"text"===e.value.type?t("section",{staticClass:"tbwccoaw"},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.value.value,expression:"value.value"}],domProps:{value:e.value.value},on:{input:function(t){t.target.composing||e.$set(e.value,"value",t.target.value)}}})]):"multiLineText"===e.value.type?t("section",{staticClass:"tbwccoaw"},[t("textarea",{directives:[{name:"model",rawName:"v-model",value:e.value.value,expression:"value.value"}],domProps:{value:e.value.value},on:{input:function(t){t.target.composing||e.$set(e.value,"value",t.target.value)}}})]):"textList"===e.value.type?t("section",{staticClass:"tbwccoaw"},[t("textarea",{directives:[{name:"model",rawName:"v-model",value:e.value.value,expression:"value.value"}],attrs:{placeholder:e.$t("script.blocks._textList.info")},domProps:{value:e.value.value},on:{input:function(t){t.target.composing||e.$set(e.value,"value",t.target.value)}}})]):"number"===e.value.type?t("section",{staticClass:"tbwccoaw"},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.value.value,expression:"value.value"}],attrs:{type:"number"},domProps:{value:e.value.value},on:{input:function(t){t.target.composing||e.$set(e.value,"value",t.target.value)}}})]):"ref"===e.value.type?t("section",{staticClass:"hpdwcrvs"},[t("select",{directives:[{name:"model",rawName:"v-model",value:e.value.value,expression:"value.value"}],on:{change:function(t){var a=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){return"_value"in e?e._value:e.value}));e.$set(e.value,"value",t.target.multiple?a:a[0])}}},[e._l(e.aiScript.getVarsByType(e.getExpectedType?e.getExpectedType():null).filter((t=>t.name!==e.name)),(function(a){return t("option",{domProps:{value:a.name}},[e._v(e._s(a.name))])})),t("optgroup",{attrs:{label:e.$t("script.argVariables")}},e._l(e.fnSlots,(function(a){return t("option",{domProps:{value:a.name}},[e._v(e._s(a.name))])})),0),t("optgroup",{attrs:{label:e.$t("script.pageVariables")}},e._l(e.aiScript.getPageVarsByType(e.getExpectedType?e.getExpectedType():null),(function(a){return t("option",{domProps:{value:a}},[e._v(e._s(a))])})),0),t("optgroup",{attrs:{label:e.$t("script.enviromentVariables")}},e._l(e.aiScript.getEnvVarsByType(e.getExpectedType?e.getExpectedType():null),(function(a){return t("option",{domProps:{value:a}},[e._v(e._s(a))])})),0)],2)]):"fn"===e.value.type?t("section",{staticStyle:{padding:"0 16px 16px 16px"}},[t("ui-textarea",{scopedSlots:e._u([{key:"desc",fn:function(){return[e._v(e._s(e.$t("script.blocks._fn.slots-info")))]},proxy:!0}]),model:{value:e.slots,callback:function(t){e.slots=t},expression:"slots"}},[t("span",[e._v(e._s(e.$t("script.blocks._fn.slots")))])]),e.value.value.expression?t("x-v",{attrs:{title:e.$t("script.blocks._fn.arg1"),"get-expected-type":()=>null,"ai-script":e.aiScript,"fn-slots":e.value.value.slots,name:e.name},model:{value:e.value.value.expression,callback:function(t){e.$set(e.value.value,"expression",t)},expression:"value.value.expression"}}):e._e()],1):e.value.type.startsWith("fn:")?t("section",{staticStyle:{padding:"16px"}},e._l(e.value.args,(function(a,n){return t("x-v",{key:n,attrs:{title:e.aiScript.getVarByName(e.value.type.split(":")[1]).value.slots[n].name,"get-expected-type":()=>null,"ai-script":e.aiScript,name:e.name},model:{value:e.value.args[n],callback:function(t){e.$set(e.value.args,n,t)},expression:"value.args[i]"}})})),1):t("section",{staticStyle:{padding:"16px"}},e._l(e.value.args,(function(a,n){return t("x-v",{key:n,attrs:{title:e.$t(`script.blocks._${e.value.type}.arg${n+1}`),"get-expected-type":()=>e._getExpectedType(n),"ai-script":e.aiScript,name:e.name,"fn-slots":e.fnSlots},model:{value:e.value.args[n],callback:function(t){e.$set(e.value.args,n,t)},expression:"value.args[i]"}})})),1)])}),[],!1,null,"51cafd99",null).exports},45808:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>y});var n=a(31508),s=a(77513),i=a.n(s),o=a(32971),r=a(3123),l=a(46813),u=a(72776),c=a(45025),p=a(37705),d=a(73300),v=a(40289),m=function(e,t,a,n){var s,i=arguments.length,o=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,a):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,a,n);else for(var r=e.length-1;r>=0;r--)(s=e[r])&&(o=(i<3?s(o):i>3?s(t,a,o):s(t,a))||o);return i>3&&o&&Object.defineProperty(t,a,o),o};class f{constructor(e=[],t=[]){this.variables=e,this.pageVars=t}typeCheck(e){if((0,d.kO)(e))return null;const t=d.iN[e.type];if(null==t)throw new Error("Unknown type: "+e.type);const a=[];for(let n=0;n<t.in.length;n++){const s=t.in[n],i=this.infer(e.args[n]);if(null!==i)if("number"==typeof s){if(void 0===a[s])a[s]=i;else if(i!==a[s])return{arg:n,expect:a[s],actual:i}}else if(i!==s)return{arg:n,expect:s,actual:i}}return null}getExpectedType(e,t){const a=d.iN[e.type];if(null==a)throw new Error("Unknown type: "+e.type);const n=[];for(let t=0;t<a.in.length;t++){const s=a.in[t],i=this.infer(e.args[t]);null!==i&&("number"==typeof s&&void 0===n[s]&&(n[s]=i))}return"number"==typeof a.in[t]?n[a.in[t]]||null:a.in[t]}infer(e){if(null===e.type)return null;if("text"===e.type)return"string";if("multiLineText"===e.type)return"string";if("textList"===e.type)return"stringArray";if("number"===e.type)return"number";if("ref"===e.type){const t=this.variables.find((t=>t.name===e.value));if(t)return this.infer(t);const a=this.pageVars.find((t=>t.name===e.value));if(a)return a.type;const n=d.Mo[e.value];return void 0!==n?n:null}if("fn"===e.type)return null;if(e.type.startsWith("fn:"))return null;const t=[],a=d.iN[e.type];for(let n=0;n<a.in.length;n++){const s=a.in[n];if("number"==typeof s){const a=this.infer(e.args[n]);void 0===t[s]?t[s]=a:a!==t[s]&&(t[s]=null)}}return"number"==typeof a.out?t[a.out]:a.out}getVarByName(e){const t=this.variables.find((t=>t.name===e));if(void 0!==t)return t;throw new Error(`No such variable '${e}'`)}getVarsByType(e){return null==e?this.variables:this.variables.filter((t=>null===this.infer(t)||this.infer(t)===e))}getEnvVarsByType(e){return null==e?Object.keys(d.Mo):Object.entries(d.Mo).filter((([t,a])=>null===a||e===a)).map((([e,t])=>e))}getPageVarsByType(e){return null==e?this.pageVars.map((e=>e.name)):this.pageVars.filter((t=>e===t.type)).map((e=>e.name))}isUsedName(e){return!!this.variables.some((t=>t.name===e))||(!!this.pageVars.some((t=>t.name===e))||!!d.Mo[e])}}m([v.ZP],f.prototype,"typeCheck",null),m([v.ZP],f.prototype,"getExpectedType",null),m([v.ZP],f.prototype,"infer",null),m([v.ZP],f.prototype,"getVarByName",null),m([v.ZP],f.prototype,"getVarsByType",null),m([v.ZP],f.prototype,"getEnvVarsByType",null),m([v.ZP],f.prototype,"getPageVarsByType",null),m([v.ZP],f.prototype,"isUsedName",null);var h=a(87114),g=a(11804);const b=n.ZP.extend({i18n:(0,l.Z)("pages"),components:{XDraggable:i(),XVariable:u.Z,XBlocks:c.Z},props:{initPageId:{type:String,required:!1},initPageName:{type:String,required:!1},initUser:{type:String,required:!1}},data(){return{author:this.$store.state.i,readonly:!1,page:null,pageId:null,currentName:null,title:"",summary:null,name:Date.now().toString(),eyeCatchingImage:null,eyeCatchingImageId:null,font:"sans-serif",content:[],sensitive:!1,alignCenter:!1,hideTitleWhenPinned:!1,variables:[],aiScript:null,showOptions:!1,moreDetails:!1,url:h.HQ,faPlus:o.r8p,faICursor:o.sdN,faSave:r.r6,faStickyNote:r.L4,faMagic:o.een,faCog:o.b7W,faTrashAlt:r.I7,faExternalLinkSquareAlt:o.cyx,faCode:o.dT$}},watch:{async eyeCatchingImageId(){null==this.eyeCatchingImageId?this.eyeCatchingImage=null:this.eyeCatchingImage=await this.$root.api("drive/files/show",{fileId:this.eyeCatchingImageId})}},async created(){if(this.aiScript=new f,this.$watch("variables",(()=>{this.aiScript.variables=this.variables}),{deep:!0}),this.$watch("content",(()=>{this.aiScript.pageVars=(0,g.k)(this.content)}),{deep:!0}),this.initPageId?this.page=await this.$root.api("pages/show",{pageId:this.initPageId}):this.initPageName&&this.initUser&&(this.page=await this.$root.api("pages/show",{name:this.initPageName,username:this.initUser}),this.readonly=!0),this.page)this.author=this.page.user,this.pageId=this.page.id,this.title=this.page.title,this.name=this.page.name,this.currentName=this.page.name,this.summary=this.page.summary,this.font=this.page.font,this.hideTitleWhenPinned=this.page.hideTitleWhenPinned,this.sensitive=this.page.sensitive,this.alignCenter=this.page.alignCenter,this.content=this.page.content,this.variables=this.page.variables,this.eyeCatchingImageId=this.page.eyeCatchingImageId;else{const e=(0,p.Z)();this.content=[{id:e,type:"text",text:"Hello World!"}]}},provide(){return{readonly:this.readonly,getScriptBlockList:this.getScriptBlockList,getPageBlockList:this.getPageBlockList}},methods:{save(){const e={title:this.title.trim(),name:this.name.trim(),summary:this.summary,font:this.font,hideTitleWhenPinned:this.hideTitleWhenPinned,sensitive:this.sensitive,alignCenter:this.alignCenter,content:this.content,variables:this.variables,eyeCatchingImageId:this.eyeCatchingImageId},t=e=>{"3d81ceae-475f-4600-b2a8-2bc116157532"==e.id?"name"==e.info.param&&this.$root.dialog({type:"error",title:this.$t("title-invalid-name"),text:this.$t("text-invalid-name")}):"NAME_ALREADY_EXISTS"==e.code&&this.$root.dialog({type:"error",text:this.$t("name-already-exists")})};this.pageId?(e.pageId=this.pageId,this.$root.api("pages/update",e).then((e=>{this.currentName=this.name.trim(),this.$root.dialog({type:"success",text:this.$t("page-updated")})})).catch(t)):this.$root.api("pages/create",e).then((e=>{this.pageId=e.id,this.currentName=this.name.trim(),this.$root.dialog({type:"success",text:this.$t("page-created")}),this.$router.push(`/i/pages/edit/${this.pageId}`)})).catch(t)},del(){this.$root.dialog({type:"warning",text:this.$t("are-you-sure-delete"),showCancelButton:!0}).then((({canceled:e})=>{e||this.$root.api("pages/delete",{pageId:this.pageId}).then((()=>{this.$root.dialog({type:"success",text:this.$t("page-deleted")}),this.$router.push("/i/pages")}))}))},async add(){const{canceled:e,result:t}=await this.$root.dialog({type:null,title:this.$t("choose-block"),select:{groupedItems:this.getPageBlockList()},showCancelButton:!0});if(e)return;const a=(0,p.Z)();this.content.push({id:a,type:t})},async addVariable(){let{canceled:e,result:t}=await this.$root.dialog({title:this.$t("enter-variable-name"),input:{type:"text"},showCancelButton:!0});if(e)return;if(t=t.trim(),this.aiScript.isUsedName(t))return void this.$root.dialog({type:"error",text:this.$t("the-variable-name-is-already-used")});const a=(0,p.Z)();this.variables.push({id:a,name:t,type:null})},removeVariable(e){const t=this.variables.findIndex((t=>t.name===e.name)),a=[...this.variables.slice(0,t),...this.variables.slice(t+1)];this.variables=a},getPageBlockList(){return[{label:this.$t("content-blocks"),items:[{value:"section",text:this.$t("blocks.section")},{value:"text",text:this.$t("blocks.text")},{value:"image",text:this.$t("blocks.image")},{value:"textarea",text:this.$t("blocks.textarea")}]},{label:this.$t("input-blocks"),items:[{value:"button",text:this.$t("blocks.button")},{value:"radioButton",text:this.$t("blocks.radioButton")},{value:"textInput",text:this.$t("blocks.textInput")},{value:"textareaInput",text:this.$t("blocks.textareaInput")},{value:"numberInput",text:this.$t("blocks.numberInput")},{value:"switch",text:this.$t("blocks.switch")},{value:"counter",text:this.$t("blocks.counter")}]},{label:this.$t("special-blocks"),items:[{value:"if",text:this.$t("blocks.if")},{value:"post",text:this.$t("blocks.post")}]}]},getScriptBlockList(e=null){const t=[],a=d.uA.filter((t=>null===e||null===t.out||t.out===e||"number"==typeof t.out));for(const e of a){const a=t.find((t=>t.category===e.category));a?a.items.push({value:e.type,text:this.$t(`script.blocks.${e.type}`)}):t.push({category:e.category,label:this.$t(`script.categories.${e.category}`),items:[{value:e.type,text:this.$t(`script.blocks.${e.type}`)}]})}const n=this.variables.filter((e=>"fn"===e.type));return n.length>0&&t.unshift({label:this.$t("script.categories.fn"),items:n.map((e=>({value:"fn:"+e.name,text:e.name})))}),t},setEyeCatchingImage(){this.$chooseDriveFile({multiple:!1}).then((e=>{this.eyeCatchingImageId=e.id}))},removeEyeCatchingImage(){this.eyeCatchingImageId=null}}});a(72009);const y=(0,a(26385).Z)(b,(function(){var e=this,t=e._self._c;e._self._setupProxy;return t("div",[t("div",{staticClass:"gwbmwxkm"},[t("header",[t("div",{staticClass:"title"},[t("fa",{attrs:{icon:e.faStickyNote}}),e._v(" "+e._s(e.readonly?e.$t("read-page"):e.pageId?e.$t("edit-page"):e.$t("new-page")))],1),t("div",{staticClass:"buttons"},[e.readonly?e._e():t("button",{on:{click:function(t){return e.del()}}},[t("fa",{attrs:{icon:e.faTrashAlt}})],1),t("button",{on:{click:()=>e.showOptions=!e.showOptions}},[t("fa",{attrs:{icon:e.faCog}})],1),e.readonly?e._e():t("button",{on:{click:function(t){return e.save()}}},[t("fa",{attrs:{icon:e.faSave}})],1)])]),t("section",[e.pageId?t("router-link",{staticClass:"view",attrs:{to:`/@${e.author.username}/pages/${e.currentName}`}},[t("fa",{attrs:{icon:e.faExternalLinkSquareAlt}}),e._v(" "+e._s(e.$t("view-page")))],1):e._e(),t("ui-input",{model:{value:e.title,callback:function(t){e.title=t},expression:"title"}},[t("span",[e._v(e._s(e.$t("title")))])]),e.showOptions?[t("ui-input",{model:{value:e.summary,callback:function(t){e.summary=t},expression:"summary"}},[t("span",[e._v(e._s(e.$t("summary")))])]),t("ui-input",{scopedSlots:e._u([{key:"prefix",fn:function(){return[e._v(e._s(e.url)+"/@"+e._s(e.author.username)+"/pages/")]},proxy:!0}],null,!1,4273545007),model:{value:e.name,callback:function(t){e.name=t},expression:"name"}},[t("span",[e._v(e._s(e.$t("url")))])]),t("ui-switch",{model:{value:e.sensitive,callback:function(t){e.sensitive=t},expression:"sensitive"}},[e._v(e._s(e.$t("sensitive-page")))]),t("ui-switch",{model:{value:e.alignCenter,callback:function(t){e.alignCenter=t},expression:"alignCenter"}},[e._v(e._s(e.$t("align-center")))]),t("ui-select",{scopedSlots:e._u([{key:"label",fn:function(){return[e._v(e._s(e.$t("font")))]},proxy:!0}],null,!1,3493738196),model:{value:e.font,callback:function(t){e.font=t},expression:"font"}},[t("option",{attrs:{value:"serif"}},[e._v(e._s(e.$t("fontSerif")))]),t("option",{attrs:{value:"sans-serif"}},[e._v(e._s(e.$t("fontSansSerif")))])]),t("div",{staticClass:"eyeCatch"},[null!=e.eyeCatchingImageId||e.readonly?e.eyeCatchingImage?t("div",[t("img",{attrs:{src:e.eyeCatchingImage.url,alt:e.eyeCatchingImage.name}}),e.readonly?e._e():t("ui-button",{on:{click:function(t){return e.removeEyeCatchingImage()}}},[t("fa",{attrs:{icon:e.faTrashAlt}}),e._v(" "+e._s(e.$t("remove-eye-catching-image")))],1)],1):e._e():t("ui-button",{on:{click:function(t){return e.setEyeCatchingImage()}}},[t("fa",{attrs:{icon:e.faPlus}}),e._v(" "+e._s(e.$t("set-eye-catching-image")))],1)],1)]:e._e(),t("x-blocks",{staticClass:"content",attrs:{"ai-script":e.aiScript},model:{value:e.content,callback:function(t){e.content=t},expression:"content"}}),e.readonly?e._e():t("ui-button",{on:{click:function(t){return e.add()}}},[t("fa",{attrs:{icon:e.faPlus}})],1)],2)]),t("ui-container",{attrs:{"body-togglable":!0},scopedSlots:e._u([{key:"header",fn:function(){return[t("fa",{attrs:{icon:e.faMagic}}),e._v(" "+e._s(e.$t("variables")))]},proxy:!0}])},[t("div",{staticClass:"qmuvgica"},[t("x-draggable",{directives:[{name:"show",rawName:"v-show",value:e.variables.length>0,expression:"variables.length > 0"}],staticClass:"variables",attrs:{tag:"div",list:e.variables,handle:".drag-handle",group:{name:"variables"},animation:"150","swap-threshold":"0.5"}},e._l(e.variables,(function(a){return t("x-variable",{key:a.name,attrs:{value:a,removable:!0,"ai-script":e.aiScript,name:a.name,title:a.name,draggable:!0},on:{input:t=>e.updateVariable(t),remove:()=>e.removeVariable(a)}})})),1),e.readonly?e._e():t("ui-button",{staticClass:"add",on:{click:function(t){return e.addVariable()}}},[t("fa",{attrs:{icon:e.faPlus}})],1),t("ui-info",[t("span",{domProps:{innerHTML:e._s(e.$t("variables-info"))}}),t("a",{staticStyle:{display:"block"},on:{click:()=>e.moreDetails=!0}},[e._v(e._s(e.$t("more-details")))])]),e.moreDetails?[t("ui-info",[t("span",{domProps:{innerHTML:e._s(e.$t("variables-info2"))}})]),t("ui-info",[t("span",{domProps:{innerHTML:e._s(e.$t("variables-info3"))}})]),t("ui-info",[t("span",{domProps:{innerHTML:e._s(e.$t("variables-info4"))}})])]:e._e()],2)]),t("ui-container",{attrs:{"body-togglable":!0,expanded:!1},scopedSlots:e._u([{key:"header",fn:function(){return[t("fa",{attrs:{icon:e.faCode}}),e._v(" "+e._s(e.$t("inspector")))]},proxy:!0}])},[t("div",{staticStyle:{padding:"0 32px 32px 32px"}},[t("ui-textarea",{attrs:{value:JSON.stringify(e.content,null,2),readonly:"",tall:""}},[e._v(e._s(e.$t("content")))]),t("ui-textarea",{attrs:{value:JSON.stringify(e.variables,null,2),readonly:"",tall:""}},[e._v(e._s(e.$t("variables")))])],1)])],1)}),[],!1,null,"50ba5632",null).exports},39606:(e,t,a)=>{var n=a(78517);n.__esModule&&(n=n.default),"string"==typeof n&&(n=[[e.id,n,""]]),n.locals&&(e.exports=n.locals);(0,a(80950).Z)("5b434afd",n,!0,{})},58497:(e,t,a)=>{var n=a(57985);n.__esModule&&(n=n.default),"string"==typeof n&&(n=[[e.id,n,""]]),n.locals&&(e.exports=n.locals);(0,a(80950).Z)("2dd58244",n,!0,{})},9937:(e,t,a)=>{var n=a(30203);n.__esModule&&(n=n.default),"string"==typeof n&&(n=[[e.id,n,""]]),n.locals&&(e.exports=n.locals);(0,a(80950).Z)("77ff0008",n,!0,{})},14879:(e,t,a)=>{var n=a(76722);n.__esModule&&(n=n.default),"string"==typeof n&&(n=[[e.id,n,""]]),n.locals&&(e.exports=n.locals);(0,a(80950).Z)("48a3d3a2",n,!0,{})},37402:(e,t,a)=>{var n=a(41035);n.__esModule&&(n=n.default),"string"==typeof n&&(n=[[e.id,n,""]]),n.locals&&(e.exports=n.locals);(0,a(80950).Z)("53cc9b9a",n,!0,{})},10444:(e,t,a)=>{var n=a(30424);n.__esModule&&(n=n.default),"string"==typeof n&&(n=[[e.id,n,""]]),n.locals&&(e.exports=n.locals);(0,a(80950).Z)("58afa456",n,!0,{})},85035:(e,t,a)=>{var n=a(21165);n.__esModule&&(n=n.default),"string"==typeof n&&(n=[[e.id,n,""]]),n.locals&&(e.exports=n.locals);(0,a(80950).Z)("49cf1ae2",n,!0,{})},17925:(e,t,a)=>{var n=a(76876);n.__esModule&&(n=n.default),"string"==typeof n&&(n=[[e.id,n,""]]),n.locals&&(e.exports=n.locals);(0,a(80950).Z)("1a16558f",n,!0,{})},3193:(e,t,a)=>{var n=a(47735);n.__esModule&&(n=n.default),"string"==typeof n&&(n=[[e.id,n,""]]),n.locals&&(e.exports=n.locals);(0,a(80950).Z)("737eb00e",n,!0,{})},72009:(e,t,a)=>{var n=a(88857);n.__esModule&&(n=n.default),"string"==typeof n&&(n=[[e.id,n,""]]),n.locals&&(e.exports=n.locals);(0,a(80950).Z)("b14a0f12",n,!0,{})}}]);