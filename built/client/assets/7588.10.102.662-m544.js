(self.webpackChunkmisskey=self.webpackChunkmisskey||[]).push([[7588],{72177:(e,t,i)=>{var a=i(11063),s=i(26143)(a);s.push([e.id,".pyvicwrksnfyhpfgkjwqknuururpaztw>.preview[data-v-13386e0c]{background:var(--bg);padding:8px}.pyvicwrksnfyhpfgkjwqknuururpaztw>.preview>.preview[data-v-13386e0c]{box-shadow:1px 1px 4px rgba(0,0,0,.2);color:var(--driveFileIcon);margin:0 auto;max-width:100%;overflow:hidden;width:fit-content}.pyvicwrksnfyhpfgkjwqknuururpaztw>.preview>footer[data-v-13386e0c]{color:var(--text);font-size:.8em;opacity:.7;padding:8px 8px 0;text-align:center}.pyvicwrksnfyhpfgkjwqknuururpaztw>.preview>footer>.separator[data-v-13386e0c]{display:inline;padding:0 4px}.pyvicwrksnfyhpfgkjwqknuururpaztw>.preview>footer>.size[data-v-13386e0c]{display:inline}.pyvicwrksnfyhpfgkjwqknuururpaztw>.preview>footer>.size .time[data-v-13386e0c]{margin:0 2px}.pyvicwrksnfyhpfgkjwqknuururpaztw>.preview>footer>.size .px[data-v-13386e0c]{margin-left:4px}.pyvicwrksnfyhpfgkjwqknuururpaztw>.info[data-v-13386e0c]{border-top:1px solid var(--faceDivider);font-size:.8em;padding:14px}.pyvicwrksnfyhpfgkjwqknuururpaztw>.info>div[data-v-13386e0c]{color:var(--text);margin:0 auto;max-width:500px}.pyvicwrksnfyhpfgkjwqknuururpaztw>.info>div>.separator[data-v-13386e0c]{padding:0 4px}.pyvicwrksnfyhpfgkjwqknuururpaztw>.info>div>.created-at>[data-icon][data-v-13386e0c]{margin-right:2px}.pyvicwrksnfyhpfgkjwqknuururpaztw>.info>div>.nsfw[data-v-13386e0c]{color:#bf4633}.pyvicwrksnfyhpfgkjwqknuururpaztw>.menu[data-v-13386e0c]{border-top:1px solid var(--faceDivider);padding:0 14px 14px}.pyvicwrksnfyhpfgkjwqknuururpaztw>.menu>div[data-v-13386e0c]{margin:0 auto;max-width:500px}.pyvicwrksnfyhpfgkjwqknuururpaztw>.hash[data-v-13386e0c]{border-top:1px solid var(--faceDivider);padding:14px}.pyvicwrksnfyhpfgkjwqknuururpaztw>.hash>div[data-v-13386e0c]{margin:0 auto;max-width:500px}.pyvicwrksnfyhpfgkjwqknuururpaztw>.hash>div>p[data-v-13386e0c]{color:var(--text);display:block;font-size:.9em;margin:0;padding:0}.pyvicwrksnfyhpfgkjwqknuururpaztw>.hash>div>p>[data-icon][data-v-13386e0c]{margin-right:4px}.pyvicwrksnfyhpfgkjwqknuururpaztw>.hash>div>code[data-v-13386e0c]{background:#f5f5f5;border:1px solid #dfdfdf;border-radius:2px;color:#222;display:block;font-size:.8em;margin:6px 0 0;overflow:auto;padding:8px;white-space:nowrap;width:100%}",""]),e.exports=s},87635:(e,t,i)=>{var a=i(11063),s=i(26143)(a);s.push([e.id,'.vupkuhvjnjyqaqhsiogfbywvjxynrgsm[data-v-8e016c5c]{display:block;text-decoration:none!important}.vupkuhvjnjyqaqhsiogfbywvjxynrgsm *[data-v-8e016c5c]{pointer-events:none;user-select:none}.vupkuhvjnjyqaqhsiogfbywvjxynrgsm>.container[data-v-8e016c5c]{grid-column-gap:10px;display:grid;grid-template-columns:64px 1fr;margin:0 auto;max-width:500px;padding:16px}.vupkuhvjnjyqaqhsiogfbywvjxynrgsm>.container[data-v-8e016c5c]:after{clear:both;content:"";display:block}.vupkuhvjnjyqaqhsiogfbywvjxynrgsm>.container>.thumbnail[data-v-8e016c5c]{color:var(--driveFileIcon);height:64px;width:64px}.vupkuhvjnjyqaqhsiogfbywvjxynrgsm>.container>.body[data-v-8e016c5c]{display:block;word-break:break-all}.vupkuhvjnjyqaqhsiogfbywvjxynrgsm>.container>.body>.name[data-v-8e016c5c]{color:var(--text);display:block;font-size:.9em;font-weight:700;margin:0;padding:0;word-break:break-word}.vupkuhvjnjyqaqhsiogfbywvjxynrgsm>.container>.body>.name>.ext[data-v-8e016c5c]{opacity:.5}.vupkuhvjnjyqaqhsiogfbywvjxynrgsm>.container>.body>.tags[data-v-8e016c5c]{display:block;font-size:.5em;list-style:none;margin:4px 0 0;padding:0}.vupkuhvjnjyqaqhsiogfbywvjxynrgsm>.container>.body>.tags>.tag[data-v-8e016c5c]{border-radius:2px;display:inline-block;margin:0 5px 0 0;padding:1px 5px}.vupkuhvjnjyqaqhsiogfbywvjxynrgsm>.container>.body>footer[data-v-8e016c5c]{color:var(--text);display:block;font-size:.7em;margin:4px 0 0}.vupkuhvjnjyqaqhsiogfbywvjxynrgsm>.container>.body>footer>.separator[data-v-8e016c5c]{padding:0 4px}.vupkuhvjnjyqaqhsiogfbywvjxynrgsm>.container>.body>footer>.type[data-v-8e016c5c]{opacity:.7}.vupkuhvjnjyqaqhsiogfbywvjxynrgsm>.container>.body>footer>.type>.mk-file-type-icon[data-v-8e016c5c]{margin-right:4px}.vupkuhvjnjyqaqhsiogfbywvjxynrgsm>.container>.body>footer>.created-at[data-v-8e016c5c],.vupkuhvjnjyqaqhsiogfbywvjxynrgsm>.container>.body>footer>.data-size[data-v-8e016c5c]{opacity:.7}.vupkuhvjnjyqaqhsiogfbywvjxynrgsm>.container>.body>footer>.created-at>[data-icon][data-v-8e016c5c]{margin-right:2px}.vupkuhvjnjyqaqhsiogfbywvjxynrgsm>.container>.body>footer>.nsfw[data-v-8e016c5c]{color:#bf4633}.vupkuhvjnjyqaqhsiogfbywvjxynrgsm[data-is-selected][data-v-8e016c5c]{background:var(--primary)}.vupkuhvjnjyqaqhsiogfbywvjxynrgsm[data-is-selected][data-v-8e016c5c],.vupkuhvjnjyqaqhsiogfbywvjxynrgsm[data-is-selected] *[data-v-8e016c5c]{color:var(--primaryForeground)!important}',""]),e.exports=s},31715:(e,t,i)=>{var a=i(11063),s=i(26143)(a);s.push([e.id,".jvwxssxsytqlqvrpiymarjlzlsxskqsr[data-v-32b547d6]{color:var(--text);display:block;text-decoration:none!important}.jvwxssxsytqlqvrpiymarjlzlsxskqsr *[data-v-32b547d6]{pointer-events:none;user-select:none}.jvwxssxsytqlqvrpiymarjlzlsxskqsr>.container[data-v-32b547d6]{margin:0 auto;max-width:500px;padding:16px}.jvwxssxsytqlqvrpiymarjlzlsxskqsr>.container>.name[data-v-32b547d6]{display:block;margin:0;padding:0}.jvwxssxsytqlqvrpiymarjlzlsxskqsr>.container>.name>[data-icon][data-v-32b547d6]{margin-right:6px}.jvwxssxsytqlqvrpiymarjlzlsxskqsr>.container>[data-icon][data-v-32b547d6]{bottom:0;height:100%;position:absolute;right:20px;top:0}",""]),e.exports=s},23531:(e,t,i)=>{var a=i(11063),s=i(26143)(a);s.push([e.id,".kmmwchoexgckptowjmjgfsygeltxfeqs[data-v-aaada056]{background:var(--face)}.kmmwchoexgckptowjmjgfsygeltxfeqs>nav[data-v-aaada056]{-webkit-backdrop-filter:blur(12px);backdrop-filter:blur(12px);background-color:var(--mobileDriveNavBg);color:var(--text);display:block;font-size:.9em;overflow:auto;padding:10px 12px;position:sticky;position:-webkit-sticky;top:0;white-space:nowrap;width:100%;z-index:1}.kmmwchoexgckptowjmjgfsygeltxfeqs>nav>a[data-v-aaada056],.kmmwchoexgckptowjmjgfsygeltxfeqs>nav>p[data-v-aaada056]{color:inherit;display:inline;margin:0;padding:0;text-decoration:none!important}.kmmwchoexgckptowjmjgfsygeltxfeqs>nav>a[data-v-aaada056]:last-child,.kmmwchoexgckptowjmjgfsygeltxfeqs>nav>p[data-v-aaada056]:last-child{font-weight:700}.kmmwchoexgckptowjmjgfsygeltxfeqs>nav>a>[data-icon][data-v-aaada056],.kmmwchoexgckptowjmjgfsygeltxfeqs>nav>p>[data-icon][data-v-aaada056]{margin-right:4px}.kmmwchoexgckptowjmjgfsygeltxfeqs>nav>span[data-v-aaada056]{margin:0 8px;opacity:.5}.kmmwchoexgckptowjmjgfsygeltxfeqs>.browser.fetching[data-v-aaada056]{opacity:.5}.kmmwchoexgckptowjmjgfsygeltxfeqs>.browser>.info[data-v-aaada056]:empty{display:none}.kmmwchoexgckptowjmjgfsygeltxfeqs>.browser>.info>p[data-v-aaada056]{color:var(--text);display:block;font-size:10px;margin:0 auto;max-width:500px;padding:4px 16px}.kmmwchoexgckptowjmjgfsygeltxfeqs>.browser>.files>.more[data-v-aaada056],.kmmwchoexgckptowjmjgfsygeltxfeqs>.browser>.folders>.more[data-v-aaada056]{color:#555;display:block;font-size:16px;padding:16px;width:100%}.kmmwchoexgckptowjmjgfsygeltxfeqs>.browser>.empty[data-v-aaada056]{color:#999;padding:16px;pointer-events:none;text-align:center}.kmmwchoexgckptowjmjgfsygeltxfeqs>.browser>.empty>p[data-v-aaada056]{margin:0}.kmmwchoexgckptowjmjgfsygeltxfeqs>.fetching .spinner[data-v-aaada056]{animation:sk-rotate-aaada056 2s linear infinite;height:40px;margin:100px auto;text-align:center;width:40px}.kmmwchoexgckptowjmjgfsygeltxfeqs>.fetching .dot1[data-v-aaada056],.kmmwchoexgckptowjmjgfsygeltxfeqs>.fetching .dot2[data-v-aaada056]{animation:sk-bounce-aaada056 2s ease-in-out infinite;background:rgba(0,0,0,.2);border-radius:100%;display:inline-block;height:60%;position:absolute;top:0;width:60%}.kmmwchoexgckptowjmjgfsygeltxfeqs>.fetching .dot2[data-v-aaada056]{animation-delay:-1s;bottom:0;top:auto}@-moz-keyframes sk-rotate-aaada056{to{transform:rotate(1turn)}}@-webkit-keyframes sk-rotate-aaada056{to{transform:rotate(1turn)}}@-o-keyframes sk-rotate-aaada056{to{transform:rotate(1turn)}}@keyframes sk-rotate-aaada056{to{transform:rotate(1turn)}}@-moz-keyframes sk-bounce-aaada056{0%,to{transform:scale(0)}50%{transform:scale(1)}}@-webkit-keyframes sk-bounce-aaada056{0%,to{transform:scale(0)}50%{transform:scale(1)}}@-o-keyframes sk-bounce-aaada056{0%,to{transform:scale(0)}50%{transform:scale(1)}}@keyframes sk-bounce-aaada056{0%,to{transform:scale(0)}50%{transform:scale(1)}}.kmmwchoexgckptowjmjgfsygeltxfeqs>.file[data-v-aaada056]{display:none}",""]),e.exports=s},27588:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>u});var a=i(31508),s=i(46813);const o=a.ZP.extend({props:["folder"],computed:{browser(){return this.$parent}},methods:{onClick(){this.browser.cd(this.folder)}}});i(92515);var r=i(26385);const l=(0,r.Z)(o,(function(){var e=this,t=e._self._c;e._self._setupProxy;return t("a",{staticClass:"jvwxssxsytqlqvrpiymarjlzlsxskqsr",attrs:{href:`/i/drive/folder/${e.folder.id}`},on:{click:function(t){return t.preventDefault(),e.onClick.apply(null,arguments)}}},[t("div",{staticClass:"container"},[t("p",{staticClass:"name"},[t("fa",{attrs:{icon:"folder"}}),e._v(e._s(e.folder.name))],1),t("fa",{attrs:{icon:"angle-right"}})],1)])}),[],!1,null,"32b547d6",null).exports;var n=i(21892);const d=a.ZP.extend({i18n:(0,s.Z)("mobile/views/components/drive.file.vue"),props:["file"],components:{XFileThumbnail:n.Z},data:()=>({isSelected:!1}),computed:{browser(){return this.$parent}},created(){this.isSelected=this.browser.selectedFiles.some((e=>e.id==this.file.id)),this.browser.$on("change-selection",this.onBrowserChangeSelection)},beforeDestroy(){this.browser.$off("change-selection",this.onBrowserChangeSelection)},methods:{onBrowserChangeSelection(e){this.isSelected=e.some((e=>e.id==this.file.id))},onClick(){this.browser.chooseFile(this.file)}}});i(73312);const f=(0,r.Z)(d,(function(){var e=this,t=e._self._c;e._self._setupProxy;return t("a",{staticClass:"vupkuhvjnjyqaqhsiogfbywvjxynrgsm",attrs:{href:`/i/drive/file/${e.file.id}`,"data-is-selected":e.isSelected},on:{click:function(t){return t.preventDefault(),e.onClick.apply(null,arguments)}}},[t("div",{staticClass:"container"},[t("x-file-thumbnail",{staticClass:"thumbnail",attrs:{file:e.file,fit:"cover"}}),t("div",{staticClass:"body"},[t("p",{staticClass:"name"},[t("span",[e._v(e._s(-1!=e.file.name.lastIndexOf(".")?e.file.name.substr(0,e.file.name.lastIndexOf(".")):e.file.name))]),-1!=e.file.name.lastIndexOf(".")?t("span",{staticClass:"ext"},[e._v(e._s(e.file.name.substr(e.file.name.lastIndexOf("."))))]):e._e()]),t("footer",[t("span",{staticClass:"type"},[t("mk-file-type-icon",{attrs:{type:e.file.type}}),e._v(e._s(e.file.type))],1),t("span",{staticClass:"separator"}),t("span",{staticClass:"created-at"},[t("fa",{attrs:{icon:["far","clock"]}}),t("mk-time",{attrs:{time:e.file.createdAt}})],1),e.file.isSensitive?[t("span",{staticClass:"separator"}),t("span",{staticClass:"nsfw"},[t("fa",{attrs:{icon:["far","eye-slash"]}}),e._v(" "+e._s(e.$t("nsfw")))],1)]:e._e()],2)])],1)])}),[],!1,null,"8e016c5c",null).exports;var c=i(32971);const h=a.ZP.extend({i18n:(0,s.Z)("mobile/views/components/drive.file-detail.vue"),props:["file"],components:{XFileThumbnail:n.Z},data:()=>({exif:null,faExternalLinkAlt:c.Xjp}),computed:{browser(){return this.$parent},kind(){return this.file.type.split("/")[0]},style:()=>({}),dlUrl(){return this.file.url}},methods:{rename(){const e=window.prompt(this.$t("rename"),this.file.name);null!=e&&""!=e&&e!=this.file.name&&this.$root.api("drive/files/update",{fileId:this.file.id,name:e}).then((()=>{this.browser.cf(this.file,!0)}))},move(){this.$chooseDriveFolder().then((e=>{this.$root.api("drive/files/update",{fileId:this.file.id,folderId:null==e?null:e.id}).then((()=>{this.browser.cf(this.file,!0)}))}))},del(){this.$root.api("drive/files/delete",{fileId:this.file.id}).then((()=>{this.browser.cd(this.file.folderId)}))},toggleSensitive(){this.$root.api("drive/files/update",{fileId:this.file.id,isSensitive:!this.file.isSensitive}),this.file.isSensitive=!this.file.isSensitive},showCreatedAt(){alert(new Date(this.file.createdAt).toLocaleString())}}});i(96794);const p=(0,r.Z)(h,(function(){var e=this,t=e._self._c;e._self._setupProxy;return t("div",{staticClass:"pyvicwrksnfyhpfgkjwqknuururpaztw"},[t("div",{staticClass:"preview"},[t("x-file-thumbnail",{staticClass:"preview",attrs:{file:e.file,detail:!0}}),"image"!=e.kind?[t("fa",{attrs:{icon:"file"}})]:e._e()],2),t("div",{staticClass:"info"},[t("div",[t("span",{staticClass:"type"},[t("mk-file-type-icon",{attrs:{type:e.file.type}}),e._v(" "+e._s(e.file.type))],1),t("span",{staticClass:"separator"}),t("span",{staticClass:"created-at",on:{click:e.showCreatedAt}},[t("fa",{attrs:{icon:["far","clock"]}}),t("mk-time",{attrs:{time:e.file.createdAt}})],1),e.file.isSensitive?[t("span",{staticClass:"separator"}),t("span",{staticClass:"nsfw"},[t("fa",{attrs:{icon:["far","eye-slash"]}}),e._v(" "+e._s(e.$t("nsfw")))],1)]:e._e()],2)]),t("div",{staticClass:"menu"},[t("div",[t("ui-input",{attrs:{readonly:"",value:e.file.url}},[e._v("URL")]),t("ui-button",{attrs:{link:"",href:e.dlUrl}},[t("fa",{attrs:{icon:e.faExternalLinkAlt}}),e._v(" "+e._s(e.$t("open")))],1),t("ui-button",{on:{click:e.rename}},[t("fa",{attrs:{icon:"pencil-alt"}}),e._v(" "+e._s(e.$t("rename")))],1),t("ui-button",{on:{click:e.move}},[t("fa",{attrs:{icon:["far","folder-open"]}}),e._v(" "+e._s(e.$t("move")))],1),e.file.isSensitive?t("ui-button",{on:{click:e.toggleSensitive}},[t("fa",{attrs:{icon:["far","eye"]}}),e._v(" "+e._s(e.$t("unmark-as-sensitive")))],1):t("ui-button",{on:{click:e.toggleSensitive}},[t("fa",{attrs:{icon:["far","eye-slash"]}}),e._v(" "+e._s(e.$t("mark-as-sensitive")))],1),t("ui-button",{on:{click:e.del}},[t("fa",{attrs:{icon:["far","trash-alt"]}}),e._v(" "+e._s(e.$t("delete")))],1)],1)]),t("div",{staticClass:"hash"},[t("div",[t("p",[t("fa",{attrs:{icon:"hashtag"}}),e._v(e._s(e.$t("hash"))+"\n\t\t\t")],1),t("code",[e._v(e._s(e.file.md5))])])])])}),[],!1,null,"13386e0c",null).exports,v=a.ZP.extend({i18n:(0,s.Z)("mobile/views/components/drive.vue"),components:{XFolder:l,XFile:f,XFileDetail:p},props:["initFolder","initFile","selectFile","multiple","isNaked","top"],data:()=>({folder:null,file:null,files:[],folders:[],moreFiles:!1,moreFolders:!1,hierarchyFolders:[],selectedFiles:[],info:null,connection:null,attached:"all",type:"",fetching:!0,fetchingMoreFiles:!1,fetchingMoreFolders:!1}),computed:{isFileSelectMode(){return this.selectFile}},watch:{top(){this.isNaked&&(this.$refs.nav.style.top=`${this.top}px`)},attached(){this.fetch()},type(){this.fetch()}},mounted(){this.connection=this.$root.stream.useSharedConnection("drive"),this.connection.on("fileCreated",this.onStreamDriveFileCreated),this.connection.on("fileUpdated",this.onStreamDriveFileUpdated),this.connection.on("fileDeleted",this.onStreamDriveFileDeleted),this.connection.on("folderCreated",this.onStreamDriveFolderCreated),this.connection.on("folderUpdated",this.onStreamDriveFolderUpdated),this.initFolder?this.cd(this.initFolder,!0):this.initFile?this.cf(this.initFile,!0):this.fetch(),this.isNaked&&(this.$refs.nav.style.top=`${this.top}px`)},beforeDestroy(){this.connection.dispose()},methods:{onStreamDriveFileCreated(e){this.addFile(e,!0)},onStreamDriveFileUpdated(e){(this.folder?this.folder.id:null)!=e.folderId?this.removeFile(e):this.addFile(e,!0)},onStreamDriveFileDeleted(e){this.removeFile(e)},onStreamDriveFolderCreated(e){this.addFolder(e,!0)},onStreamDriveFolderUpdated(e){(this.folder?this.folder.id:null)!=e.parentId?this.removeFolder(e):this.addFolder(e,!0)},dive(e){this.hierarchyFolders.unshift(e),e.parent&&this.dive(e.parent)},cd(e,t=!1){null!=e?("object"==typeof e&&(e=e.id),this.file=null,this.fetching=!0,this.$root.api("drive/folders/show",{folderId:e}).then((e=>{this.folder=e,this.hierarchyFolders=[],e.parent&&this.dive(e.parent),this.$emit("open-folder",this.folder,t),this.fetch()}))):this.goRoot(t)},addFolder(e,t=!1){(this.folder?this.folder.id:null)==e.parentId&&(this.folders.some((t=>t.id==e.id))||(t?this.folders.unshift(e):this.folders.push(e)))},addFile(e,t=!1){if((this.folder?this.folder.id:null)==e.folderId)if(this.files.some((t=>t.id==e.id))){const t=this.files.map((e=>e.id)).indexOf(e.id);a.ZP.set(this.files,t,e)}else t?this.files.unshift(e):this.files.push(e)},removeFolder(e){"object"==typeof e&&(e=e.id),this.folders=this.folders.filter((t=>t.id!=e))},removeFile(e){"object"==typeof e&&(e=e.id),this.files=this.files.filter((t=>t.id!=e))},appendFile(e){this.addFile(e)},appendFolder(e){this.addFolder(e)},prependFile(e){this.addFile(e,!0)},prependFolder(e){this.addFolder(e,!0)},goRoot(e=!1){null==this.folder&&null==this.file||(this.file=null,this.folder=null,this.hierarchyFolders=[],this.$emit("move-root",e),this.fetch())},fetch(){this.folders=[],this.files=[],this.moreFolders=!1,this.moreFiles=!1,this.fetching=!0,this.$emit("begin-fetch");let e=null,t=null;this.$root.api("drive/folders",{folderId:this.folder?this.folder.id:null,limit:21}).then((t=>{21==t.length&&(this.moreFolders=!0,t.pop()),e=t,a()})),this.$root.api("drive/files",{folderId:this.folder?this.folder.id:null,attached:this.attached,type:this.type||void 0,limit:21}).then((e=>{21==e.length&&(this.moreFiles=!0,e.pop()),t=e,a()}));let i=!1;const a=()=>{if(i){for(const t of e)this.appendFolder(t);for(const e of t)this.appendFile(e);this.fetching=!1,this.$emit("fetched")}else i=!0,this.$emit("fetch-mid")};null==this.folder&&this.$root.api("drive").then((e=>{this.info=e}))},fetchMoreFiles(){this.fetching=!0,this.fetchingMoreFiles=!0;this.$root.api("drive/files",{folderId:this.folder?this.folder.id:null,attached:this.attached,type:this.type||void 0,limit:31,untilId:this.files[this.files.length-1].id}).then((e=>{31==e.length?(this.moreFiles=!0,e.pop()):this.moreFiles=!1;for(const t of e)this.appendFile(t);this.fetching=!1,this.fetchingMoreFiles=!1}))},chooseFile(e){this.isFileSelectMode?this.multiple?(this.selectedFiles.some((t=>t.id==e.id))?this.selectedFiles=this.selectedFiles.filter((t=>t.id!=e.id)):this.selectedFiles.push(e),this.$emit("change-selection",this.selectedFiles)):this.$emit("selected",e):this.cf(e)},cf(e,t=!1){"object"==typeof e&&(e=e.id),this.fetching=!0,this.$root.api("drive/files/show",{fileId:e}).then((e=>{this.file=e,this.folder=null,this.hierarchyFolders=[],e.folder&&this.dive(e.folder),this.fetching=!1,this.$emit("open-file",this.file,t)}))},selectLocalFile(){this.$refs.file.click()},createFolder(){this.$root.dialog({title:this.$t("folder-name"),input:{default:""}}).then((({result:e})=>{e?this.$root.api("drive/folders/create",{name:e,parentId:this.folder?this.folder.id:void 0}).then((e=>{this.addFolder(e,!0)})):this.$root.dialog({type:"error",text:this.$t("folder-name-cannot-empty")})}))},renameFolder(){null!=this.folder?this.$root.dialog({title:this.$t("folder-name"),input:{default:this.folder.name}}).then((({result:e})=>{e?this.$root.api("drive/folders/update",{name:e,folderId:this.folder.id}).then((e=>{this.cd(e)})):this.$root.dialog({type:"error",text:this.$t("cannot-empty")})})):this.$root.dialog({type:"error",text:this.$t("here-is-root")})},moveFolder(){null!=this.folder?this.$chooseDriveFolder().then((e=>{this.$root.api("drive/folders/update",{parentId:e?e.id:null,folderId:this.folder.id}).then((e=>{this.cd(e)}))})):this.$root.dialog({type:"error",text:this.$t("here-is-root")})},urlUpload(){const e=window.prompt(this.$t("url-prompt"));null!=e&&""!=e&&(this.$root.api("drive/files/upload_from_url",{url:e,folderId:this.folder?this.folder.id:void 0}),this.$root.dialog({type:"info",text:this.$t("uploading")}))},onChangeLocalFile(){for(const e of Array.from(this.$refs.file.files))this.$refs.uploader.upload(e,this.folder)},deleteFolder(){null!=this.folder?this.$root.api("drive/folders/delete",{folderId:this.folder.id}).then((e=>{this.cd(this.folder.parentId)})).catch((e=>{this.$root.dialog({type:"error",title:"Error",text:e.message||e})})):this.$root.dialog({type:"error",text:this.$t("here-is-root")})}}});i(20075);const u=(0,r.Z)(v,(function(){var e=this,t=e._self._c;e._self._setupProxy;return t("div",{staticClass:"kmmwchoexgckptowjmjgfsygeltxfeqs"},[t("nav",{ref:"nav"},[t("a",{attrs:{href:"/i/drive"},on:{click:function(t){return t.preventDefault(),e.goRoot()}}},[t("fa",{attrs:{icon:"cloud"}}),e._v(e._s(e.$t("@.drive")))],1),e._l(e.hierarchyFolders,(function(i){return[t("span",{key:i.id+">"},[t("fa",{attrs:{icon:"angle-right"}})],1),t("a",{key:i.id,attrs:{href:`/i/drive/folder/${i.id}`},on:{click:function(t){return t.preventDefault(),e.cd(i)}}},[e._v(e._s(i.name))])]})),null!=e.folder?[t("span",[t("fa",{attrs:{icon:"angle-right"}})],1),t("p",[e._v(e._s(e.folder.name))])]:e._e(),null!=e.file?[t("span",[t("fa",{attrs:{icon:"angle-right"}})],1),t("p",[e._v(e._s(e.file.name))])]:e._e()],2),t("mk-uploader",{ref:"uploader"}),null==e.file?t("div",{staticClass:"browser",class:{fetching:e.fetching}},[t("ui-horizon-group",{staticClass:"filter"},[t("ui-select",{model:{value:e.attached,callback:function(t){e.attached=t},expression:"attached"}},[t("option",{attrs:{value:"all"}},[e._v(e._s(e.$t("@.allAttached")))]),t("option",{attrs:{value:"attached"}},[e._v(e._s(e.$t("@.attached")))]),t("option",{attrs:{value:"notAttached"}},[e._v(e._s(e.$t("@.notAttached")))])]),t("ui-select",{model:{value:e.type,callback:function(t){e.type=t},expression:"type"}},[t("option",{attrs:{value:""}},[e._v(e._s(e.$t("@.allType")))]),t("option",{attrs:{value:"image/*"}},[e._v(e._s(e.$t("@.image")))]),t("option",{attrs:{value:"video/*"}},[e._v(e._s(e.$t("@.video")))]),t("option",{attrs:{value:"audio/*"}},[e._v(e._s(e.$t("@.audio")))])])],1),e.info?t("div",{staticClass:"info"},[null!=e.folder&&(e.folder.foldersCount>0||e.folder.filesCount>0)?t("p",[e.folder.foldersCount>0?[e._v(e._s(e.folder.foldersCount)+" "+e._s(e.$t("folder-count")))]:e._e(),e.folder.foldersCount>0&&e.folder.filesCount>0?[e._v(e._s(e.$t("count-separator")))]:e._e(),e.folder.filesCount>0?[e._v(e._s(e.folder.filesCount)+" "+e._s(e.$t("file-count")))]:e._e()],2):e._e()]):e._e(),e.folders.length>0||e.moreFolders?t("div",{staticClass:"folders"},[e._l(e.folders,(function(e){return t("x-folder",{key:e.id,staticClass:"folder",attrs:{folder:e}})})),e.moreFolders?t("p",[e._v(e._s(e.$t("@.load-more")))]):e._e()],2):e._e(),e.files.length>0||e.moreFiles?t("div",{staticClass:"files"},[e._l(e.files,(function(e){return t("x-file",{key:e.id,staticClass:"file",attrs:{file:e}})})),e.moreFiles?t("button",{staticClass:"more",on:{click:e.fetchMoreFiles}},[e._v("\n\t\t\t\t"+e._s(e.fetchingMoreFiles?this.$t("@.loading"):this.$t("@.load-more"))+"\n\t\t\t")]):e._e()],2):e._e(),0!=e.files.length||e.moreFiles||0!=e.folders.length||e.moreFolders||e.fetching?e._e():t("div",{staticClass:"empty"},[null==e.folder?t("p",[e._v(e._s(e.$t("nothing-in-drive")))]):e._e(),null!=e.folder?t("p",[e._v(e._s(e.$t("folder-is-empty")))]):e._e()])],1):e._e(),e.fetching&&null==e.file&&0==e.files.length&&0==e.folders.length?t("div",{staticClass:"fetching"},[e._m(0)]):e._e(),t("input",{ref:"file",staticClass:"file",attrs:{type:"file",multiple:"multiple"},on:{change:e.onChangeLocalFile}}),null!=e.file?t("x-file-detail",{attrs:{file:e.file}}):e._e()],1)}),[function(){var e=this._self._c;this._self._setupProxy;return e("div",{staticClass:"spinner"},[e("div",{staticClass:"dot1"}),e("div",{staticClass:"dot2"})])}],!1,null,"aaada056",null).exports},96794:(e,t,i)=>{var a=i(72177);a.__esModule&&(a=a.default),"string"==typeof a&&(a=[[e.id,a,""]]),a.locals&&(e.exports=a.locals);(0,i(80950).Z)("582c915a",a,!0,{})},73312:(e,t,i)=>{var a=i(87635);a.__esModule&&(a=a.default),"string"==typeof a&&(a=[[e.id,a,""]]),a.locals&&(e.exports=a.locals);(0,i(80950).Z)("476ef159",a,!0,{})},92515:(e,t,i)=>{var a=i(31715);a.__esModule&&(a=a.default),"string"==typeof a&&(a=[[e.id,a,""]]),a.locals&&(e.exports=a.locals);(0,i(80950).Z)("c7368442",a,!0,{})},20075:(e,t,i)=>{var a=i(23531);a.__esModule&&(a=a.default),"string"==typeof a&&(a=[[e.id,a,""]]),a.locals&&(e.exports=a.locals);(0,i(80950).Z)("b7442906",a,!0,{})}}]);