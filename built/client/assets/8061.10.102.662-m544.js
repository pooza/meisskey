(self.webpackChunkmisskey=self.webpackChunkmisskey||[]).push([[8061],{74922:(t,e,s)=>{var a=s(11063),i=s(26143)(a);i.push([t.id,".mntrproz[data-v-40d7fdea]{display:flex;padding:4px}.mntrproz>div[data-v-40d7fdea]{padding:4px;width:50%}.mntrproz>div>b[data-v-40d7fdea]{color:var(--text);display:block;font-size:12px}.mntrproz>div>span[data-v-40d7fdea]{color:var(--text);font-size:12px;opacity:.7;position:absolute;right:4px;top:4px}",""]),t.exports=i},7711:(t,e,s)=>{"use strict";s.d(e,{Z:()=>i});var a=s(31508);function i(t){return a.ZP.extend({props:{widget:{type:Object},column:{type:Object,default:null},platform:{type:String,required:!0},isCustomizeMode:{type:Boolean,default:!1}},computed:{id(){return this.widget.id},props(){return this.widget.data}},data:()=>({bakedOldProps:null}),created(){this.mergeProps(),this.$watch("props",(()=>{this.mergeProps()})),this.bakeProps()},methods:{bakeProps(){this.bakedOldProps=JSON.stringify(this.props)},mergeProps(){if(t.props){const e=t.props();for(const t of Object.keys(e))this.props.hasOwnProperty(t)||a.ZP.set(this.props,t,e[t])}},save(){this.bakedOldProps!=JSON.stringify(this.props)&&(this.bakeProps(),"deck"==this.platform?this.$store.commit("device/updateDeckColumn",this.column):this.$root.api("i/update_widget",{id:this.id,data:this.props}))}}})}},68061:(t,e,s)=>{"use strict";s.r(e),s.d(e,{default:()=>d});var a=s(7711),i=s(32971),r=s(6800),o=s.n(r);const n=(0,a.Z)({name:"queue",props:()=>({compact:!1})}).extend({data:()=>({stats:[],inChart:null,outChart:null,faTasks:i.A8}),watch:{stats(t){this.inChart.updateSeries([{type:"area",data:t.map(((t,e)=>({x:e,y:t.inbox.activeSincePrevTick})))},{type:"area",data:t.map(((t,e)=>({x:e,y:t.inbox.active})))},{type:"line",data:t.map(((t,e)=>({x:e,y:t.inbox.waiting})))},{type:"line",data:t.map(((t,e)=>({x:e,y:t.inbox.delayed})))}]),this.outChart.updateSeries([{type:"area",data:t.map(((t,e)=>({x:e,y:t.deliver.activeSincePrevTick})))},{type:"area",data:t.map(((t,e)=>({x:e,y:t.deliver.active})))},{type:"line",data:t.map(((t,e)=>({x:e,y:t.deliver.waiting})))},{type:"line",data:t.map(((t,e)=>({x:e,y:t.deliver.delayed})))}])}},computed:{latestStats(){return this.stats[this.stats.length-1]}},mounted(){const t={chart:{type:"area",height:70,animations:{dynamicAnimation:{enabled:!1}},sparkline:{enabled:!0}},tooltip:{enabled:!1},stroke:{curve:"straight",width:1},colors:["#00E396","#00BCD4","#FFB300","#e53935"],series:[{data:[]},{data:[]},{data:[]},{data:[]}],yaxis:{min:0}};this.inChart=new(o())(this.$refs.in,t),this.outChart=new(o())(this.$refs.out,t),this.inChart.render(),this.outChart.render();const e=this.$root.stream.useSharedConnection("queueStats");e.on("stats",this.onStats),e.on("statsLog",this.onStatsLog),e.send("requestLog",{id:Math.random().toString().substr(2,8),length:50}),this.$once("hook:beforeDestroy",(()=>{e.dispose(),this.inChart.destroy(),this.outChart.destroy()}))},methods:{func(){this.props.compact=!this.props.compact,this.save()},onStats(t){this.stats.push(t),this.stats.length>50&&this.stats.shift()},onStatsLog(t){for(const e of t.reverse())this.onStats(e)}}});s(83508);const d=(0,s(26385).Z)(n,(function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",[e("ui-container",{attrs:{"show-header":!t.props.compact},scopedSlots:t._u([{key:"header",fn:function(){return[e("fa",{attrs:{icon:t.faTasks}}),t._v("Queue")]},proxy:!0}])},[e("div",{staticClass:"mntrproz"},[e("div",[e("b",[t._v("In")]),t.latestStats?e("span",[t._v(t._s(t._f("number")(t.latestStats.inbox.active))+" / "+t._s(t._f("number")(t.latestStats.inbox.limit))+" ("+t._s(t._f("number")(t.latestStats.inbox.waiting))+")")]):t._e(),e("div",{ref:"in"})]),e("div",[e("b",[t._v("Out")]),t.latestStats?e("span",[t._v(t._s(t._f("number")(t.latestStats.deliver.active))+" / "+t._s(t._f("number")(t.latestStats.deliver.limit))+" ("+t._s(t._f("number")(t.latestStats.deliver.waiting))+")")]):t._e(),e("div",{ref:"out"})])])])],1)}),[],!1,null,"40d7fdea",null).exports},83508:(t,e,s)=>{var a=s(74922);a.__esModule&&(a=a.default),"string"==typeof a&&(a=[[t.id,a,""]]),a.locals&&(t.exports=a.locals);(0,s(80950).Z)("2c5e3422",a,!0,{})}}]);