(self.webpackChunkmisskey=self.webpackChunkmisskey||[]).push([[8156],{31329:(e,t,s)=>{var a=s(11063),i=s(26143)(a);i.push([e.id,".mk-autocomplete[data-v-7b83f9ae]{background:var(--secondary);border:1px solid rgba(0,0,0,.1);border-radius:4px;margin-top:calc(1em + 8px);max-width:100%;overflow:hidden;position:fixed;transition:top .1s ease,left .1s ease;z-index:65535}.mk-autocomplete>ol[data-v-7b83f9ae]{display:block;list-style:none;margin:0;max-height:190px;max-width:500px;overflow:auto;padding:4px 0}.mk-autocomplete>ol>li[data-v-7b83f9ae]{align-items:center;color:rgba(0,0,0,.8);cursor:default;display:flex;font-size:.9em;overflow:hidden;padding:4px 12px;white-space:nowrap}.mk-autocomplete>ol>li[data-v-7b83f9ae],.mk-autocomplete>ol>li *[data-v-7b83f9ae]{user-select:none}.mk-autocomplete>ol>li *[data-v-7b83f9ae]{overflow:hidden;text-overflow:ellipsis}.mk-autocomplete>ol>li[data-v-7b83f9ae]:hover{background:var(--autocompleteItemHoverBg)}.mk-autocomplete>ol>li[data-selected=true][data-v-7b83f9ae]{background:var(--primary)}.mk-autocomplete>ol>li[data-selected=true][data-v-7b83f9ae],.mk-autocomplete>ol>li[data-selected=true] *[data-v-7b83f9ae]{color:#fff!important}.mk-autocomplete>ol>li[data-v-7b83f9ae]:active{background:var(--primaryDarken10)}.mk-autocomplete>ol>li[data-v-7b83f9ae]:active,.mk-autocomplete>ol>li:active *[data-v-7b83f9ae]{color:#fff!important}.mk-autocomplete>.users>li .avatar[data-v-7b83f9ae]{border-radius:100%;margin:0 8px 0 0;max-height:28px;max-width:28px;min-height:28px;min-width:28px}.mk-autocomplete>.users>li .name[data-v-7b83f9ae]{color:var(--autocompleteItemText);margin:0 8px 0 0}.mk-autocomplete>.users>li .username[data-v-7b83f9ae]{color:var(--autocompleteItemTextSub)}.mk-autocomplete>.hashtags>li .name[data-v-7b83f9ae]{color:var(--autocompleteItemText)}.mk-autocomplete>.emojis>li .emoji[data-v-7b83f9ae]{display:inline-block;margin:0 4px 0 0;width:24px}.mk-autocomplete>.emojis>li .emoji>img[data-v-7b83f9ae]{vertical-align:bottom;width:24px}.mk-autocomplete>.emojis>li .name[data-v-7b83f9ae]{color:var(--autocompleteItemText)}.mk-autocomplete>.emojis>li .alias[data-v-7b83f9ae]{color:var(--autocompleteItemTextSub);margin:0 0 0 8px}.mk-autocomplete>.mfms>li[data-v-7b83f9ae]{color:var(--autocompleteItemText);display:flex;justify-content:space-between}.mk-autocomplete>.mfms>li .name[data-v-7b83f9ae]{margin-right:1em}",""]),e.exports=i},10492:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});const a=(e,t)=>{let s=t.parentNode;for(;s;){if(s==e)return!0;s=s.parentNode}return!1}},68156:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>f});var a=s(31508),i=s(77988),l=s(10492),o=s(39233),n=s(59966);const m=i.W.filter((e=>"flags"!==e.category)),r=e=>{let t=Array.from(e).map((e=>e.codePointAt(0).toString(16)));return t.includes("200d")||(t=t.filter((e=>"fe0f"!=e))),t=t.filter((e=>e&&e.length)),t.join("-")},h=m.map((e=>({emoji:e.char,name:e.name,aliasOf:null,url:`${o.P}/${r(e.char)}.svg`})));for(const e of m)if(e.keywords)for(const t of e.keywords)h.push({emoji:e.char,name:t,aliasOf:e.name,url:`${o.P}/${r(e.char)}.svg`});h.sort(((e,t)=>e.name.length-t.name.length));const c=[{name:"small",head:"<small>",tail:"</small>",desc:"<small>small</small>"},{name:"i",head:"<i>",tail:"</i>",desc:"<small>italic</small>"},{name:"sup",head:"<sup>",tail:"</sup>",desc:"foo<sup>sup</sup>"},{name:"sub",head:"<sub>",tail:"</sub>",desc:"foo<sub>sub</sub>"},{name:"center",head:"<center>",tail:"</center>"},{name:"motion",head:"<motion>",tail:"</motion>",desc:"<motion>🍮</motion>"},{name:"jump",head:"<jump>",tail:"</jump>",desc:"<jump>🍮</jump>"},{name:"blink",head:"<blink>",tail:"</blink>",desc:"<blink>🍮</blink>"},{name:"twitch",head:"<twitch>",tail:"</twitch>",desc:"<twitch>🍮</twitch>"},{name:"shake",head:"<shake>",tail:"</shake>",desc:"<shake>🍮</shake>"},{name:"rgbshift",head:"<rgbshift>",tail:"</rgbshift>",desc:"<rgbshift>rpgshift</rgbshift>"},{name:"x1",head:"<x1>",tail:"</x1>",desc:"<x1>🍮</x1>"},{name:"x2",head:"<x2>",tail:"</x2>",desc:"<x2>🍮</x2>"},{name:"x3",head:"<x3>",tail:"</x3>",desc:"<x3>🍮</x3>"},{name:"x4",head:"<x4>",tail:"</x4>",desc:"<x4>🍮</x4>"},{name:"color",head:"<color red blue>",tail:"</color>"},{name:"flip",head:"<flip>",tail:"</flip>",desc:"<flip>flip</flip>"},{name:"vflip",head:"<vflip>",tail:"</vflip>",desc:"<vflip>vflip</vflip>"},{name:"spin",head:"<spin>",tail:"</spin>",desc:"<spin>spin</spin>"},{name:"spin left",head:"<spin left>",tail:"</spin>",desc:"<spin left>spin</spin>"},{name:"spin alternate",head:"<spin alternate>",tail:"</spin>",desc:"<spin left>spin</spin>"},{name:"xspin",head:"<xspin>",tail:"</xspin>",desc:"<xspin left>xspin</xspin>"},{name:"xspin left",head:"<xspin left>",tail:"</xspin>",desc:"<xspin left>xspin</xspin>"},{name:"xspin alternate",head:"<xspin alternate>",tail:"</xspin>",desc:"<xspin left>xspin</xspin>"},{name:"yspin",head:"<yspin>",tail:"</yspin>",desc:"<yspin left>yspin</yspin>"},{name:"yspin left",head:"<yspin left>",tail:"</yspin>",desc:"<yspin left>yspin</yspin>"},{name:"yspin alternate",head:"<yspin alternate>",tail:"</yspin>",desc:"<yspin left>yspin</yspin>"},{name:"rotate",head:"<rotate DEG>",tail:"</rotate>",desc:"<rotate 20>rotate</rotate>"},{name:"marquee",head:"<marquee>",tail:"</marquee>"},{name:"marquee reverse",head:"<marquee reverse>",tail:"</marquee>"},{name:"marquee alternate",head:"<marquee alternate>",tail:"</marquee>"},{name:"marquee slide",head:"<marquee slide>",tail:"</marquee>"}],p=[{name:"jelly",head:"$[jelly ",tail:"]",desc:"$[jelly 🍮]"},{name:"tada",head:"$[tada ",tail:"]",desc:"$[tada 🍮]"},{name:"jump",head:"$[jump ",tail:"]",desc:"$[jump 🍮]"},{name:"bounce",head:"$[bounce ",tail:"]",desc:"$[bounce 🍮]"},{name:"shake",head:"$[shake ",tail:"]",desc:"$[shake 🍮]"},{name:"twitch",head:"$[twitch ",tail:"]",desc:"$[twitch 🍮]"},{name:"flip",head:"$[flip ",tail:"]",desc:"$[flip flip]"},{name:"flip.v",head:"$[flip.v ",tail:"]",desc:"$[flip.v flip]"},{name:"flip.v,h",head:"$[flip.v,h ",tail:"]",desc:"$[flip.v,h flip]"},{name:"spin",head:"$[spin ",tail:"]",desc:"$[spin spin]"},{name:"spin.x",head:"$[spin.x ",tail:"]",desc:"$[spin.x spin]"},{name:"spin.y",head:"$[spin.y ",tail:"]",desc:"$[spin.y spin]"},{name:"x1",head:"$[x1 ",tail:"]",desc:"$[x1 🍮]"},{name:"x2",head:"$[x2 ",tail:"]",desc:"$[x2 🍮]"},{name:"x3",head:"$[x3 ",tail:"]",desc:"$[x3 🍮]"},{name:"x4",head:"$[x4 ",tail:"]",desc:"$[x4 🍮]"},{name:"blur",head:"$[blur ",tail:"]",desc:"$[blur 🍮]"},{name:"font.serif",head:"$[font.serif ",tail:"]",desc:"$[font.serif serif]"},{name:"font.monospace",head:"$[font.monospace ",tail:"]",desc:"$[font.monospace monospace]"}],d=a.ZP.extend({props:["type","q","textarea","complete","close","x","y","localOnly"],data:()=>({getStaticImageUrl:n.e,fetching:!0,users:[],hashtags:[],emojis:[],mfms:[],items:[],select:-1,emojilist:i.W,emojiDb:[]}),updated(){var e;this.x+this.$el.offsetWidth>window.innerWidth?this.$el.style.left=window.innerWidth-this.$el.offsetWidth+"px":this.$el.style.left=this.x+"px",this.y+this.$el.offsetHeight>window.innerHeight?(this.$el.style.top=this.y-this.$el.offsetHeight+"px",this.$el.style.marginTop="0"):(this.$el.style.top=this.y+"px",this.$el.style.marginTop="calc(1em + 8px)"),this.items=(null===(e=this.$refs.suggests)||void 0===e?void 0:e.children)||[]},mounted(){const e=(this.$root.getMetaSync()||{emojis:[]}).emojis||[],t=[];for(const s of e)if(t.push({name:s.name,emoji:`:${s.name}:`,url:s.url,isCustomEmoji:!0}),s.aliases)for(const e of s.aliases)t.push({name:e,aliasOf:s.name,emoji:`:${s.name}:`,url:s.url,isCustomEmoji:!0});t.sort(((e,t)=>e.name.length-t.name.length)),this.emojiDb=t.concat(h),this.textarea.addEventListener("keydown",this.onKeydown);for(const e of Array.from(document.querySelectorAll("body *")))e.addEventListener("mousedown",this.onMousedown);this.$nextTick((()=>{this.exec(),this.$watch("q",(()=>{this.$nextTick((()=>{this.exec()}))}))}))},beforeDestroy(){this.textarea.removeEventListener("keydown",this.onKeydown);for(const e of Array.from(document.querySelectorAll("body *")))e.removeEventListener("mousedown",this.onMousedown)},methods:{exec(){if(this.select=-1,this.$refs.suggests)for(const e of Array.from(this.items))e.removeAttribute("data-selected");if("user"==this.type)this.$root.api("users/search",{query:`@${this.q}`,localOnly:!!this.localOnly,limit:20,detail:!1},!1,!1).then((e=>{this.users=e,this.fetching=!1}));else if("hashtag"==this.type)null==this.q||""==this.q?(this.hashtags=JSON.parse(localStorage.getItem("hashtags")||"[]"),this.fetching=!1):this.$root.api("hashtags/search",{query:this.q,limit:30},!1,!0).then((e=>{this.hashtags=e,this.fetching=!1}));else if("emoji"==this.type){if(null==this.q||""==this.q)return void(this.emojis=this.emojiDb.filter((e=>e.isCustomEmoji&&!e.aliasOf)).sort(((e,t)=>{var s=e.name.toUpperCase(),a=t.name.toUpperCase();return s<a?-1:s>a?1:0})));const e=[],t=30;e.length<t&&this.emojiDb.some((s=>(s.name!==this.q||e.some((e=>e.emoji==s.emoji))||e.push(s),e.length==t))),e.length<t&&this.emojiDb.some((s=>(s.name.includes(this.q)&&s.isCustomEmoji&&!s.aliasOf&&!e.some((e=>e.emoji==s.emoji))&&e.push(s),e.length==t))),e.length<t&&this.emojiDb.some((s=>(!s.name.startsWith(this.q)||s.aliasOf||e.some((e=>e.emoji==s.emoji))||e.push(s),e.length==t))),e.length<t&&this.emojiDb.some((s=>(s.name.startsWith(this.q)&&!e.some((e=>e.emoji==s.emoji))&&e.push(s),e.length==t))),e.length<t&&this.emojiDb.some((s=>(s.name.includes(this.q)&&!e.some((e=>e.emoji==s.emoji))&&e.push(s),e.length==t))),this.emojis=e}else if("mfm"===this.type)if(this.q.startsWith("<")){const e=this.q.substr(1),t=c.filter((t=>t.name.startsWith(e)));this.mfms=t}else if(this.q.startsWith("$[")){const e=this.q.substr(2),t=p.filter((t=>t.name.startsWith(e)));this.mfms=t}},onMousedown(e){(0,l.Z)(this.$el,e.target)||this.$el==e.target||this.close()},onKeydown(e){const t=()=>{e.preventDefault(),e.stopPropagation()};switch(e.which){case 10:case 13:-1!==this.select?(t(),this.items[this.select].click()):this.close();break;case 27:t(),this.close();break;case 38:-1!==this.select?(t(),this.selectPrev()):this.close();break;case 9:case 40:t(),this.selectNext();break;default:e.stopPropagation(),this.textarea.focus()}},selectNext(){++this.select>=this.items.length&&(this.select=0),0===this.items.length&&(this.select=-1),this.applySelect()},selectPrev(){--this.select<0&&(this.select=this.items.length-1),this.applySelect()},applySelect(){for(const e of Array.from(this.items))e.removeAttribute("data-selected");-1!==this.select&&(this.items[this.select].setAttribute("data-selected","true"),this.items[this.select].focus())}}});s(32322);const f=(0,s(26385).Z)(d,(function(){var e=this,t=e._self._c;e._self._setupProxy;return t("div",{staticClass:"mk-autocomplete",on:{contextmenu:function(e){return e.preventDefault(),(()=>{}).apply(null,arguments)}}},[e.users.length>0?t("ol",{ref:"suggests",staticClass:"users"},e._l(e.users,(function(s){return t("li",{key:s.id,attrs:{tabindex:"-1"},on:{click:function(t){return e.complete(e.type,s)},keydown:e.onKeydown}},[t("img",{staticClass:"avatar",attrs:{src:s.avatarUrl,alt:""}}),t("span",{staticClass:"name"},[t("mk-user-name",{key:s.id,attrs:{user:s}})],1),t("span",{staticClass:"username"},[e._v("@"+e._s(e._f("acct")(s)))])])})),0):e._e(),e.hashtags.length>0?t("ol",{ref:"suggests",staticClass:"hashtags"},e._l(e.hashtags,(function(s){return t("li",{key:s,attrs:{tabindex:"-1"},on:{click:function(t){return e.complete(e.type,s)},keydown:e.onKeydown}},[t("span",{staticClass:"name"},[e._v(e._s(s))])])})),0):e._e(),e.emojis.length>0?t("ol",{ref:"suggests",staticClass:"emojis"},e._l(e.emojis,(function(s){return t("li",{key:s.emoji,attrs:{tabindex:"-1"},on:{click:function(t){return e.complete(e.type,s.emoji)},keydown:e.onKeydown}},[s.isCustomEmoji?t("span",{staticClass:"emoji"},[t("img",{attrs:{src:e.$store.state.device.disableShowingAnimatedImages?e.getStaticImageUrl(s.url):s.url,alt:s.emoji}})]):t("span",{staticClass:"emoji"},[t("img",{attrs:{src:s.url,alt:s.emoji}})]),t("span",{staticClass:"name",domProps:{innerHTML:e._s(s.name.replace(e.q,`<b>${e.q}</b>`))}}),s.aliasOf?t("span",{staticClass:"alias"},[e._v("("+e._s(s.aliasOf)+")")]):e._e()])})),0):e._e(),e.mfms.length>0?t("ol",{ref:"suggests",staticClass:"mfms"},e._l(e.mfms,(function(s){return t("li",{key:s.name,attrs:{tabindex:"-1"},on:{click:function(t){return e.complete(e.type,s)},keydown:e.onKeydown}},[t("div",{staticClass:"name"},[e._v(e._s(s.name))]),t("div",{staticClass:"desc"},[s.desc?t("mfm",{attrs:{text:s.desc,plain:!0,extra:!0,nowrap:!0}}):e._e()],1)])})),0):e._e()])}),[],!1,null,"7b83f9ae",null).exports},32322:(e,t,s)=>{var a=s(31329);a.__esModule&&(a=a.default),"string"==typeof a&&(a=[[e.id,a,""]]),a.locals&&(e.exports=a.locals);(0,s(80950).Z)("9a372144",a,!0,{})}}]);