(()=>{"use strict";const e=t=>{if(t.deletedAt)return"(削除された投稿)";if(t.isHidden)return"(非公開の投稿)";let n="";return null!=t.cw?n+=t.cw:n+=t.text?t.text:"",0!=(t.files||[]).length&&(n+=` (📎${t.files.length})`),t.poll&&(n+=" (投票)"),t.replyId&&(t.reply?n+=`\n\nRE: ${e(t.reply)}`:n+="\n\nRE: ..."),t.renoteId&&(t.renote?n+=`\n\nRN: ${e(t.renote)}`:n+="\n\nRN: ..."),n.trim()},t=e;function n(e){switch(e){case"like":return"👍";case"love":return"❤️";case"laugh":return"😆";case"hmm":return"🤔";case"surprise":return"😮";case"congrats":return"🎉";case"angry":return"💢";case"confused":return"😥";case"rip":return"😇";case"pudding":return"🍮";case"star":return"⭐";default:return e}}function r(e){return e.name||e.username}self.addEventListener("install",(e=>{console.info("installed"),e.waitUntil(Promise.all([self.skipWaiting()]))})),self.addEventListener("push",(e=>{e.waitUntil(self.clients.matchAll({includeUncontrolled:!0}).then((i=>{if(0!=i.length)return;const{type:o,body:l}=e.data.json(),a=function(e,i){var o,l,a,s,u,c,d;switch(e){case"driveFileCreated":return{title:"File uploaded",body:i.name,icon:i.url};case"unreadMessagingMessage":return{title:`New message from ${r(i.user)}`,body:i.text,icon:i.user.avatarUrl};case"reversiInvited":return{title:"Play reversi with me",body:`You got reversi invitation from ${r(i.parent)}`,icon:i.parent.avatarUrl};case"notification":{const e=i;switch(e.type){case"follow":return{title:`Followed by ${r(e.user)}`,body:"",icon:e.user.avatarUrl};case"mention":return{title:`Mention from ${r(e.user)}`,body:e._truncated?null===(o=e.note)||void 0===o?void 0:o.text:t(e.note),icon:e.user.avatarUrl};case"reply":return{title:`Reply from ${r(e.user)}`,body:e._truncated?null===(l=e.note)||void 0===l?void 0:l.text:t(e.note),icon:e.user.avatarUrl};case"renote":return{title:`Renoted by ${r(e.user)}`,body:e._truncated?null===(a=e.note)||void 0===a?void 0:a.text:t(e.note),icon:e.user.avatarUrl};case"quote":return{title:`Quoted by ${r(e.user)}`,body:e._truncated?null===(s=e.note)||void 0===s?void 0:s.text:t(e.note),icon:e.user.avatarUrl};case"reaction":return{title:`${n(e.reaction)} from ${r(e.user)}`,body:e._truncated?null===(u=e.note)||void 0===u?void 0:u.text:t(e.note),icon:e.user.avatarUrl};case"poll_vote":return{title:`Voted by ${r(e.user)}`,body:e._truncated?null===(c=e.note)||void 0===c?void 0:c.text:t(e.note),icon:e.user.avatarUrl};case"poll_finished":return{title:"Poll finished",body:e._truncated?null===(d=e.note)||void 0===d?void 0:d.text:t(e.note),icon:e.user.avatarUrl};case"receiveFollowRequest":return{title:`Follow request from ${r(e.user)}`,body:"",icon:e.user.avatarUrl};case"highlight":return{title:`Highlighte: ${r(e.user)}`,body:t(e.note),icon:e.user.avatarUrl};default:return null}}default:return null}}(o,l);return null!=a?self.registration.showNotification(a.title,{body:a.body,icon:a.icon}):void 0})))})),self.addEventListener("fetch",(e=>{})),self.addEventListener("notificationclick",(function(e){e.notification.close(),e.waitUntil(clients.matchAll({type:"window"}).then((function(e){for(var t=0;t<e.length;t++){var n=e[t];if("/"==n.url&&"focus"in n)return n.focus()}if(clients.openWindow)return clients.openWindow("/")})))}))})();