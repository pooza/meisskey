{"version":3,"sources":["remote/activitypub/db-resolver.js"],"names":["DbResolver","getNoteFromApId","value","parsed","parseUri","id","Note","findOne","_id","mongo","ObjectID","deletedAt","$exists","uri","getMessageFromApId","MessagingMessage","getRemoteUserFromKeyId","keyId","user","User","host","$ne","getUserFromApId","getApId","localRegex","RegExp","escapeRegexp","config","url","matchLocal","match","type","constructor"],"mappings":";;;;eAQqBA;;;yBARE;wBACJ;sBACsB;sBACb;sBACK;8BACH;kCACsB;AAErC,IAAA,AAAMA,aAAN,MAAMA;IAIpB;;EAEC,GACD,MAAaC,gBAAgBC,KAAuB,EAAyB;QAC5E,MAAMC,SAAS,IAAI,CAACC,QAAQ,CAACF;QAE7B,IAAIC,OAAOE,EAAE,EAAE;YACd,OAAO,AAAC,MAAMC,aAAI,CAACC,OAAO,CAAC;gBAC1BC,KAAK,IAAIC,SAAMC,QAAQ,CAACP,OAAOE,EAAE;gBACjCM,WAAW;oBAAEC,SAAS;gBAAM;YAC7B,MAAO;QACR;QAEA,IAAIT,OAAOU,GAAG,EAAE;YACf,OAAO,AAAC,MAAMP,aAAI,CAACC,OAAO,CAAC;gBAC1BM,KAAKV,OAAOU,GAAG;gBACfF,WAAW;oBAAEC,SAAS;gBAAM;YAC7B,MAAO;QACR;QAEA,OAAO;IACR;IAEA,MAAaE,mBAAmBZ,KAAuB,EAAqC;QAC3F,MAAMC,SAAS,IAAI,CAACC,QAAQ,CAACF;QAE7B,IAAIC,OAAOE,EAAE,EAAE;YACd,OAAO,AAAC,MAAMU,yBAAgB,CAACR,OAAO,CAAC;gBACtCC,KAAK,IAAIC,SAAMC,QAAQ,CAACP,OAAOE,EAAE;gBACjCM,WAAW;oBAAEC,SAAS;gBAAM;YAC7B,MAAO;QACR;QAEA,IAAIT,OAAOU,GAAG,EAAE;YACf,OAAO,AAAC,MAAME,yBAAgB,CAACR,OAAO,CAAC;gBACtCM,KAAKV,OAAOU,GAAG;gBACfF,WAAW;oBAAEC,SAAS;gBAAM;YAC7B,MAAO;QACR;QAEA,OAAO;IACR;IAEA,MAAaI,uBAAuBC,KAAa,EAA+B;QAC/E,MAAMC,OAAO,MAAMC,aAAI,CAACZ,OAAO,CAAC;YAC/Ba,MAAM;gBAAEC,KAAK;YAAK;YAClB,gBAAgBJ;YAChBN,WAAW;gBAAEC,SAAS;YAAM;QAC7B;QAEA,OAAOM,QAAQ;IAChB;IAEA;;EAEC,GACD,MAAaI,gBAAgBpB,KAAuB,EAAyB;QAC5E,MAAMC,SAAS,IAAI,CAACC,QAAQ,CAACF;QAE7B,IAAIC,OAAOE,EAAE,EAAE;YACd,OAAO,AAAC,MAAMc,aAAI,CAACZ,OAAO,CAAC;gBAC1BC,KAAK,IAAIC,SAAMC,QAAQ,CAACP,OAAOE,EAAE;gBACjCM,WAAW;oBAAEC,SAAS;gBAAM;YAC7B,MAAO;QACR;QAEA,IAAIT,OAAOU,GAAG,EAAE;YACf,OAAO,AAAC,MAAMM,aAAI,CAACZ,OAAO,CAAC;gBAC1BM,KAAKV,OAAOU,GAAG;gBACfF,WAAW;oBAAEC,SAAS;gBAAM;YAC7B,MAAO;QACR;QAEA,OAAO;IACR;IAEOR,SAASF,KAAuB,EAAkB;QACxD,MAAMW,MAAMU,IAAAA,aAAO,EAACrB;QAEpB,MAAMsB,aAAa,IAAIC,OAAO,MAAMC,cAAaC,eAAM,CAACC,GAAG,IAAI,MAAM,WAAW,MAAM;QACtF,MAAMC,aAAahB,IAAIiB,KAAK,CAACN;QAE7B,IAAIK,YAAY;YACf,OAAO;gBACNE,MAAMF,UAAU,CAAC,EAAE;gBACnBxB,IAAIwB,UAAU,CAAC,EAAE;YAClB;QACD,OAAO;YACN,OAAO;gBACNhB;YACD;QACD;IACD;IA/FAmB,aAAc,CACd;AA+FD","file":"db-resolver.js","sourceRoot":"../../../built"}