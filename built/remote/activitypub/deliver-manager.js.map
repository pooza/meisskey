{"version":3,"sources":["remote/activitypub/deliver-manager.js"],"names":["DeliverManager","deliverToFollowers","deliverToUser","isFollowers","recipe","type","isDirect","addFollowersRecipe","deliver","addRecipe","addDirectRecipe","to","recipes","push","execute","lowSeverity","isLocalUser","actor","inboxes","addToDeliver","inbox","url","match","map","x","includes","some","r","followers","Following","find","followeeId","_id","following","follower","_follower","isRemoteUser","sharedInbox","origin","userId","filter","host","URL","isBlockedHost","isClosedHost","activity","constructor","manager"],"mappings":"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","file":"deliver-manager.js","sourceRoot":"../../../built"}