{"version":3,"sources":["remote/resolve-user.js"],"names":["logger","remoteLogger","createSubLogger","username","_host","option","resync","usernameLower","toLowerCase","info","User","findOne","host","config","disableFederation","configHostAscii","toASCII","configHost","toUnicode","hostAscii","user","acctLower","self","resolveSelf","succ","createPerson","href","lastFetchedAt","Date","now","getTime","update","_id","$set","uri","URL","hostname","Error","updatePerson","e","warn","message","finger","webFinger","catch","error","statusCode","links","find","link","rel"],"mappings":"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","file":"resolve-user.js","sourceRoot":"../../built"}