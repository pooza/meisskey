{"version":3,"sources":["server/activitypub/following.js"],"names":["ctx","config","disableFederation","throw","ObjectID","isValid","params","user","status","userId","cursor","cursorErr","$","optional","type","ID","get","request","query","pageErr","str","or","ok","page","User","findOne","_id","isDeleted","$ne","isSuspended","noFederation","host","hideFollows","limit","partOf","url","followerId","$lt","transform","followings","Following","find","sort","inStock","length","pop","renderedFollowees","Promise","all","map","following","renderFollowUser","followeeId","rendered","renderOrderedCollectionPage","followingCount","toHexString","body","renderActivity","setResponseType","renderOrderedCollection","set"],"mappings":"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","file":"following.js","sourceRoot":"../../../built"}