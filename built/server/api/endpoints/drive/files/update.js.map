{"version":3,"sources":["server/api/endpoints/drive/files/update.js"],"names":["meta","desc","tags","requireCredential","kind","params","fileId","validator","$","type","ID","transform","folderId","optional","nullable","default","undefined","name","str","pipe","validateFileName","isSensitive","bool","errors","noSuchFile","message","code","id","accessDenied","noSuchFolder","define","ps","user","file","DriveFile","findOne","_id","ApiError","isAdmin","isModerator","metadata","userId","equals","filename","folder","DriveFolder","update","$set","Note","find","then","notes","note","_files","findIndex","f","fileObj","pack","detail","self","publishDriveStream"],"mappings":";;;;;;;;IASaA,IAAI;eAAJA;;IAsEb,OAkEG;eAlEH;;;sBA/Ec;wBACgB;6BACN;2BAC0B;wBACf;wBAChB;sBACF;uBACQ;AAElB,MAAMA,OAAO;IACnBC,MAAM;QACL,SAAS;QACT,SAAS;IACV;IAEAC,MAAM;QAAC;KAAQ;IAEfC,mBAAmB;IAEnBC,MAAM;QAAC;QAAe;KAAc;IAEpCC,QAAQ;QACPC,QAAQ;YACPC,WAAWC,aAAC,CAACC,IAAI,CAACC,eAAE;YACpBC,WAAWA,iBAAS;YACpBV,MAAM;gBACL,SAAS;YACV;QACD;QAEAW,UAAU;YACTL,WAAWC,aAAC,CAACK,QAAQ,CAACC,QAAQ,CAACL,IAAI,CAACC,eAAE;YACtCC,WAAWA,iBAAS;YACpBI,SAASC;YACTf,MAAM;gBACL,SAAS;YACV;QACD;QAEAgB,MAAM;YACLV,WAAWC,aAAC,CAACK,QAAQ,CAACK,GAAG,CAACC,IAAI,CAACC,2BAAgB;YAC/CL,SAASC;YACTf,MAAM;gBACL,SAAS;gBACT,SAAS;YACV;QACD;QAEAoB,aAAa;YACZd,WAAWC,aAAC,CAACK,QAAQ,CAACS,IAAI;YAC1BP,SAASC;YACTf,MAAM;gBACL,SAAS;gBACT,SAAS;YACV;QACD;IACD;IAEAsB,QAAQ;QACPC,YAAY;YACXC,SAAS;YACTC,MAAM;YACNC,IAAI;QACL;QAEAC,cAAc;YACbH,SAAS;YACTC,MAAM;YACNC,IAAI;QACL;QAEAE,cAAc;YACbJ,SAAS;YACTC,MAAM;YACNC,IAAI;QACL;IACD;AACD;MAEA,WAAeG,IAAAA,eAAM,EAAC9B,MAAM,OAAO+B,IAAIC;IACtC,aAAa;IACb,MAAMC,OAAO,MAAMC,kBAAS,CAC1BC,OAAO,CAAC;QACRC,KAAKL,GAAGzB,MAAM;IACf;IAED,IAAI2B,SAAS,MAAM;QAClB,MAAM,IAAII,eAAQ,CAACrC,KAAKuB,MAAM,CAACC,UAAU;IAC1C;IAEA,IAAI,CAACQ,KAAKM,OAAO,IAAI,CAACN,KAAKO,WAAW,IAAI,CAACN,KAAKO,QAAQ,CAACC,MAAM,CAACC,MAAM,CAACV,KAAKI,GAAG,GAAG;QACjF,MAAM,IAAIC,eAAQ,CAACrC,KAAKuB,MAAM,CAACK,YAAY;IAC5C;IAEA,IAAIG,GAAGd,IAAI,EAAEgB,KAAKU,QAAQ,GAAGZ,GAAGd,IAAI;IAEpC,IAAIc,GAAGV,WAAW,KAAKL,WAAWiB,KAAKO,QAAQ,CAACnB,WAAW,GAAGU,GAAGV,WAAW;IAE5E,IAAIU,GAAGnB,QAAQ,KAAKI,WAAW;QAC9B,IAAIe,GAAGnB,QAAQ,KAAK,MAAM;YACzBqB,KAAKO,QAAQ,CAAC5B,QAAQ,GAAG;QAC1B,OAAO;YACN,eAAe;YACf,MAAMgC,SAAS,MAAMC,oBAAW,CAC9BV,OAAO,CAAC;gBACRC,KAAKL,GAAGnB,QAAQ;gBAChB6B,QAAQT,KAAKI,GAAG;YACjB;YAED,IAAIQ,WAAW,MAAM;gBACpB,MAAM,IAAIP,eAAQ,CAACrC,KAAKuB,MAAM,CAACM,YAAY;YAC5C;YAEAI,KAAKO,QAAQ,CAAC5B,QAAQ,GAAGgC,OAAOR,GAAG;QACpC;IACD;IAEA,MAAMF,kBAAS,CAACY,MAAM,CAACb,KAAKG,GAAG,EAAE;QAChCW,MAAM;YACLJ,UAAUV,KAAKU,QAAQ;YACvB,qBAAqBV,KAAKO,QAAQ,CAAC5B,QAAQ;YAC3C,wBAAwBqB,KAAKO,QAAQ,CAACnB,WAAW;QAClD;IACD;IAEA,+BAA+B;IAC/B2B,aAAI,CAACC,IAAI,CAAC;QACT,cAAchB,KAAKG,GAAG;IACvB,GAAGc,IAAI,CAACC,CAAAA;QACP,KAAK,MAAMC,QAAQD,MAAO;YACzBC,KAAKC,MAAM,CAACD,KAAKC,MAAM,CAACC,SAAS,CAACC,CAAAA,IAAKA,EAAEnB,GAAG,CAACM,MAAM,CAACT,KAAKG,GAAG,GAAG,GAAGH;YAClEe,aAAI,CAACF,MAAM,CAAC;gBAAEV,KAAKgB,KAAKhB,GAAG;YAAC,GAAG;gBAC9BW,MAAM;oBACLM,QAAQD,KAAKC,MAAM;gBACpB;YACD;QACD;IACD;IAEA,MAAMG,UAAU,MAAMC,IAAAA,eAAI,EAACxB,MAAM;QAAEyB,QAAQ;QAAMC,MAAM;IAAK;IAE5D,4BAA4B;IAC5BC,IAAAA,0BAAkB,EAAC5B,KAAKI,GAAG,EAAE,eAAeoB;IAE5C,OAAOA;AACR","file":"update.js","sourceRoot":"../../../../../../built"}