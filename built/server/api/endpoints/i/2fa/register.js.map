{"version":3,"sources":["server/api/endpoints/i/2fa/register.js"],"names":["meta","requireCredential","secure","params","password","validator","$","str","define","ps","user","same","bcrypt","compare","Error","secret","speakeasy","generateSecret","length","User","update","_id","$set","twoFactorTempSecret","base32","dataUrl","QRCode","toDataURL","otpauthURL","encoding","label","username","issuer","config","host","qr"],"mappings":";;;;;;;;IAQaA,IAAI;eAAJA;;IAYb,OAiCG;eAjCH;;;sBApBc;0BACU;2BACG;wBACH;sBACP;wBACE;wBACA;AAEZ,MAAMA,OAAO;IACnBC,mBAAmB;IAEnBC,QAAQ;IAERC,QAAQ;QACPC,UAAU;YACTC,WAAWC,aAAC,CAACC,GAAG;QACjB;IACD;AACD;MAEA,WAAeC,IAAAA,eAAM,EAACR,MAAM,OAAOS,IAAIC;IACtC,mBAAmB;IACnB,MAAMC,OAAO,MAAMC,UAAOC,OAAO,CAACJ,GAAGL,QAAQ,EAAEM,KAAKN,QAAQ;IAE5D,IAAI,CAACO,MAAM;QACV,MAAM,IAAIG,MAAM;IACjB;IAEA,6BAA6B;IAC7B,MAAMC,SAASC,WAAUC,cAAc,CAAC;QACvCC,QAAQ;IACT;IAEA,MAAMC,aAAI,CAACC,MAAM,CAACV,KAAKW,GAAG,EAAE;QAC3BC,MAAM;YACLC,qBAAqBR,OAAOS,MAAM;QACnC;IACD;IAEA,4CAA4C;IAC5C,MAAMC,UAAU,MAAMC,QAAOC,SAAS,CAACX,WAAUY,UAAU,CAAC;QAC3Db,QAAQA,OAAOS,MAAM;QACrBK,UAAU;QACVC,OAAOpB,KAAKqB,QAAQ;QACpBC,QAAQC,eAAM,CAACC,IAAI;IACpB;IAEA,OAAO;QACNC,IAAIV;QACJV,QAAQA,OAAOS,MAAM;QACrBM,OAAOpB,KAAKqB,QAAQ;QACpBC,QAAQC,eAAM,CAACC,IAAI;IACpB;AACD","file":"register.js","sourceRoot":"../../../../../../built"}