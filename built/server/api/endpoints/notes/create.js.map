{"version":3,"sources":["server/api/endpoints/notes/create.js"],"names":["meta","maxNoteTextLength","setInterval","fetchMeta","then","m","stability","desc","tags","requireCredential","limit","duration","ms","max","kind","params","visibility","validator","$","optional","str","or","default","undefined","visibleUserIds","arr","type","ID","transform","transformMany","text","nullable","pipe","length","trim","cw","isValidCw","viaMobile","bool","localOnly","copyOnce","noExtractMentions","noExtractHashtags","noExtractEmojis","preview","geo","obj","coordinates","item","num","range","altitude","accuracy","altitudeAccuracy","heading","speed","strict","ref","fileIds","unique","mediaIds","deprecated","replyId","renoteId","poll","choices","each","c","multiple","expiresAt","int","expiredAfter","min","res","properties","createdNote","description","errors","noSuchRenoteTarget","message","code","id","cannotReRenote","noSuchReplyTarget","cannotReplyToPureRenote","contentRequired","cannotCreateAlreadyExpiredPoll","define","ps","user","app","visibleUsers","users","Promise","all","uniqBy","x","map","User","findOne","_id","removeNull","files","fileId","DriveFile","filter","file","renote","Note","ApiError","reply","choice","i","votes","Date","now","note","create","createdAt","apMentions","apHashtags","apEmojis","pack"],"mappings":"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","file":"create.js","sourceRoot":"../../../../../built"}