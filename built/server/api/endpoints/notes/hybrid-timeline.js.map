{"version":3,"sources":["server/api/endpoints/notes/hybrid-timeline.js"],"names":["meta","desc","tags","requireCredential","params","limit","validator","$","optional","num","range","default","sinceId","type","ID","transform","untilId","sinceDate","untilDate","includeMyRenotes","bool","includeRenotedMyNotes","includeLocalRenotes","includeForeignReply","withFiles","fileType","arr","str","excludeNsfw","excludeSfw","excludeRenote","mediaOnly","deprecated","res","items","errors","stlDisabled","message","code","id","define","ps","user","m","fetchMeta","disableLocalTimeline","ApiError","followingIds","hideUserIds","hideFromHomeLists","hideRenoteUserIds","Promise","all","getFriendIds","_id","config","homeTlActiveLimitDays","getHideUserIds","UserList","find","userId","hideFromHome","getHideRenoteUserIds","hideFromHomeUsers","concat","map","list","userIds","hideFromHomeHosts","hosts","x","isSelfHost","sort","filterQuery","$in","mentions","visibleQuery","visibility","visibleUserIds","query","$and","deletedAt","$or","$nin","push","replyId","$expr","$eq","renoteId","text","$ne","fileIds","poll","length","$exists","$gt","$lt","createdAt","Date","getPackedTimeline"],"mappings":"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","file":"hybrid-timeline.js","sourceRoot":"../../../../../built"}