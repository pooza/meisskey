{"version":3,"sources":["server/api/endpoints/notes/search-by-tag.js"],"names":["meta","desc","tags","requireCredential","allowGet","cacheSec","params","tag","validator","$","optional","str","query","arr","following","nullable","bool","default","mute","reply","renote","withFiles","media","deprecated","poll","untilId","type","ID","transform","sinceDate","num","untilDate","offset","min","limit","range","res","items","define","ps","me","visibleQuery","visibility","$in","userId","_id","visibleUserIds","push","x","q","$and","deletedAt","$exists","$or","tokens","trim","split","shift","tagsLower","normalizeTag","token","matchFrom","match","user","User","findOne","usernameLower","toLowerCase","host","toDbHost","map","t","ids","getFriendIds","$nin","concat","hideUserIds","getHideUserIds","replyId","$ne","renoteId","fileIds","$lt","createdAt","$gt","Date","length","notes","Note","find","sort","skip","packMany"],"mappings":"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","file":"search-by-tag.js","sourceRoot":"../../../../../built"}