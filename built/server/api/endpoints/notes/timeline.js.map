{"version":3,"sources":["server/api/endpoints/notes/timeline.js"],"names":["meta","desc","tags","requireCredential","params","limit","validator","$","optional","num","range","default","sinceId","type","ID","transform","untilId","sinceDate","untilDate","includeMyRenotes","bool","includeRenotedMyNotes","includeLocalRenotes","includeForeignReply","excludeRenote","withFiles","fileType","arr","str","excludeNsfw","excludeSfw","mediaOnly","deprecated","res","items","define","ps","user","followingIds","hideUserIds","hideFromHomeLists","hideRenoteUserIds","Promise","all","getFriendIds","_id","config","homeTlActiveLimitDays","getHideUserIds","UserList","find","userId","hideFromHome","getHideRenoteUserIds","hideFromHomeUsers","concat","map","list","userIds","hideFromHomeHosts","hosts","x","isSelfHost","sort","filterQuery","$in","mentions","visibleQuery","visibility","visibleUserIds","query","$and","deletedAt","$or","$nin","push","replyId","$expr","$eq","renoteId","text","$ne","fileIds","poll","length","$exists","$gt","$lt","createdAt","Date","getPackedTimeline"],"mappings":"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","file":"timeline.js","sourceRoot":"../../../../../built"}