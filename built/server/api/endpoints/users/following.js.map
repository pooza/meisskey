{"version":3,"sources":["server/api/endpoints/users/following.js"],"names":["meta","desc","tags","requireCredential","params","userId","validator","$","optional","type","ID","transform","username","str","host","nullable","limit","num","range","default","cursor","sinceId","untilId","v11compatible","bool","iknow","diff","moved","res","properties","users","items","next","format","errors","noSuchUser","message","code","id","define","ps","me","q","_id","usernameLower","toLowerCase","user","User","findOne","ApiError","canShowFollows","query","followerId","myFriends","getFriendIds","followeeId","$in","equals","followerIds","getFollowerIds","$nin","sort","$lt","$gt","following","Following","aggregate","$match","$sort","$limit","$lookup","from","localField","foreignField","as","$unwind","$ne","inStock","length","pop","Promise","all","map","f","pack","_user","detail","toOidString","packFollowee","x","createdAt","toISODateOrNull","followee","packUser"],"mappings":";;;;;;;;IAaaA,IAAI;eAAJA;;IAkHb,OAoIG;eApIH;;;sBA/Hc;wBACgB;sBAC4B;2BACpB;4BAET;wBACV;uBACM;8BACM;gCACA;2BAEc;AAEtC,MAAMA,OAAO;IACnBC,MAAM;QACL,SAAS;QACT,SAAS;IACV;IAEAC,MAAM;QAAC;KAAQ;IAEfC,mBAAmB;IAEnBC,QAAQ;QACPC,QAAQ;YACPC,WAAWC,aAAC,CAACC,QAAQ,CAACC,IAAI,CAACC,eAAE;YAC7BC,WAAWA,iBAAS;YACpBV,MAAM;gBACL,SAAS;gBACT,SAAS;YACV;QACD;QAEAW,UAAU;YACTN,WAAWC,aAAC,CAACC,QAAQ,CAACK,GAAG;QAC1B;QAEAC,MAAM;YACLR,WAAWC,aAAC,CAACC,QAAQ,CAACO,QAAQ,CAACF,GAAG;QACnC;QAEAG,OAAO;YACNV,WAAWC,aAAC,CAACC,QAAQ,CAACS,GAAG,CAACC,KAAK,CAAC,GAAG;YACnCC,SAAS;QACV;QAEAC,QAAQ;YACPd,WAAWC,aAAC,CAACC,QAAQ,CAACC,IAAI,CAACC,eAAE;YAC7BS,SAAS;YACTR,WAAWA,iBAAS;YACpBV,MAAM;gBACL,SAAS;YACV;QACD;QAEAoB,SAAS;YACRf,WAAWC,aAAC,CAACC,QAAQ,CAACC,IAAI,CAACC,eAAE;YAC7BC,WAAWA,iBAAS;YACpBV,MAAM;gBACL,SAAS;YACV;QACD;QAEAqB,SAAS;YACRhB,WAAWC,aAAC,CAACC,QAAQ,CAACC,IAAI,CAACC,eAAE;YAC7BC,WAAWA,iBAAS;YACpBV,MAAM;gBACL,SAAS;YACV;QACD;QAEAsB,eAAe;YACdjB,WAAWC,aAAC,CAACC,QAAQ,CAACgB,IAAI;YAC1BL,SAAS;YACTlB,MAAM;gBACL,SAAS;YACV;QACD;QAEAwB,OAAO;YACNnB,WAAWC,aAAC,CAACC,QAAQ,CAACgB,IAAI;YAC1BL,SAAS;QACV;QAEAO,MAAM;YACLpB,WAAWC,aAAC,CAACC,QAAQ,CAACgB,IAAI;YAC1BL,SAAS;YACTlB,MAAM;gBACL,SAAS;YACV;QACD;QAEA0B,OAAO;YACNrB,WAAWC,aAAC,CAACC,QAAQ,CAACgB,IAAI;YAC1BL,SAAS;YACTlB,MAAM;gBACL,SAAS;YACV;QACD;IACD;IAEA2B,KAAK;QACJnB,MAAM;QACNoB,YAAY;YACXC,OAAO;gBACNrB,MAAM;gBACNsB,OAAO;oBACNtB,MAAM;gBACP;YACD;YACAuB,MAAM;gBACLvB,MAAM;gBACNwB,QAAQ;gBACRlB,UAAU;YACX;QACD;IACD;IAEAmB,QAAQ;QACPC,YAAY;YACXC,SAAS;YACTC,MAAM;YACNC,IAAI;QACL;IACD;AACD;MAEA,WAAeC,IAAAA,eAAM,EAACvC,MAAM,OAAOwC,IAAIC;IACtC,MAAMC,IAASF,GAAGnC,MAAM,IAAI,OACzB;QAAEsC,KAAKH,GAAGnC,MAAM;IAAC,IACjB;QAAEuC,eAAeJ,GAAG5B,QAAQ,CAACiC,WAAW;QAAI/B,MAAM0B,GAAG1B,IAAI;IAAC;IAE7D,MAAMgC,OAAO,MAAMC,aAAI,CAACC,OAAO,CAACN;IAEhC,IAAII,QAAQ,MAAM;QACjB,MAAM,IAAIG,eAAQ,CAACjD,KAAKkC,MAAM,CAACC,UAAU;IAC1C;IAEA,IAAI,CAAC,MAAMe,IAAAA,8BAAc,EAACT,IAAIK,OAAO;QACpC,OAAO;YACNhB,OAAO,EAAE;YACTE,MAAM;QACP;IACD;IAEA,MAAMmB,QAAQ;QACbC,YAAYN,KAAKH,GAAG;IACrB;IAEA,4BAA4B;IAC5B,IAAIF,MAAMD,GAAGf,KAAK,EAAE;QACnB,iBAAiB;QACjB,MAAM4B,YAAY,MAAMC,IAAAA,wBAAY,EAACb,GAAGE,GAAG;QAE3CQ,MAAMI,UAAU,GAAG;YAClBC,KAAKH;QACN;IACD;IAEA,IAAIb,GAAGd,IAAI,IAAIe,MAAMA,GAAGE,GAAG,CAACc,MAAM,CAACX,KAAKH,GAAG,GAAG;QAC7C,MAAMe,cAAc,MAAMC,IAAAA,4BAAc,EAACb,KAAKH,GAAG;QAEjDQ,MAAMI,UAAU,GAAG;YAClBK,MAAMF;QACP;IACD;IAEA,MAAMG,OAAO;QACZlB,KAAK,CAAC;IACP;IAEA,iBAAiB;IACjB,IAAIH,GAAGpB,MAAM,EAAE;QACd+B,MAAMR,GAAG,GAAG;YACXmB,KAAKtB,GAAGpB,MAAM;QACf;IACD,cAAc;IACd,OAAO,IAAIoB,GAAGnB,OAAO,EAAE;QACtBwC,KAAKlB,GAAG,GAAG;QACXQ,MAAMR,GAAG,GAAG;YACXoB,KAAKvB,GAAGnB,OAAO;QAChB;IACD,OAAO,IAAImB,GAAGlB,OAAO,EAAE;QACtB6B,MAAMR,GAAG,GAAG;YACXmB,KAAKtB,GAAGlB,OAAO;QAChB;IACD;IAEA,IAAI0C;IAEJ,IAAI,CAACxB,GAAGb,KAAK,EAAE;QACdqC,YAAY,MAAMC,kBAAS,CAACC,SAAS,CAAC;YAAC;gBACtCC,QAAQhB;YACT;YAAG;gBACFiB,OAAO;oBAAEzB,KAAK,CAAC;gBAAE;YAClB;YAAG;gBACF0B,QAAQ7B,GAAGxB,KAAK,GAAKwB,CAAAA,GAAGjB,aAAa,GAAG,IAAI,CAAA;YAC7C;YAAG;gBACF,YAAY;gBACZ+C,SAAS;oBACRC,MAAM;oBACNC,YAAY;oBACZC,cAAc;oBACdC,IAAI;gBACL;YACD;YAAG;gBACFC,SAAS;YACV;SAAE;IACH,OAAO;QACNX,YAAY,MAAMC,kBAAS,CAACC,SAAS,CAAC;YAAC;gBACtCC,QAAQhB;YACT;YAAG;gBACF,YAAY;gBACZmB,SAAS;oBACRC,MAAM;oBACNC,YAAY;oBACZC,cAAc;oBACdC,IAAI;gBACL;YACD;YAAG;gBACFC,SAAS;YACV;YAAG;gBACFR,QAAQ;oBACP,uBAAuB;wBAAES,KAAK;oBAAK;gBACpC;YACD;YAAG;gBACFR,OAAO;oBAAEzB,KAAK,CAAC;gBAAE;YAClB;YAAG;gBACF0B,QAAQ7B,GAAGxB,KAAK,GAAKwB,CAAAA,GAAGjB,aAAa,GAAG,IAAI,CAAA;YAC7C;SAAE;IACH;IAEA,IAAI,CAACiB,GAAGjB,aAAa,EAAE;QACtB,iBAAiB;QACjB,MAAMsD,UAAUb,UAAUc,MAAM,KAAKtC,GAAGxB,KAAK,GAAI;QACjD,IAAI6D,SAAS;YACZb,UAAUe,GAAG;QACd;QAEA,OAAO;YACNjD,OAAO,MAAMkD,QAAQC,GAAG,CAACjB,UAAUkB,GAAG,CAACC,CAAAA,IAAKC,IAAAA,UAAI,EAACD,EAAEE,KAAK,EAAE5C,IAAI;oBAAE6C,QAAQ;gBAAK;YAC7EtD,MAAM6C,UAAUU,IAAAA,sBAAW,EAACvB,SAAS,CAACA,UAAUc,MAAM,GAAG,EAAE,CAACnC,GAAG,IAAI;QACpE;IACD,OAAO;QACN,MAAM6C,eAAe,OACpBC,GACAhD;YAEA,OAAO;gBACNH,IAAIiD,IAAAA,sBAAW,EAACE,EAAE9C,GAAG;gBACrB+C,WAAWC,IAAAA,0BAAe,EAACF,EAAEC,SAAS;gBACtCnC,YAAYgC,IAAAA,sBAAW,EAACE,EAAElC,UAAU;gBACpCH,YAAYmC,IAAAA,sBAAW,EAACE,EAAErC,UAAU;gBACpCwC,UAAU,MAAMC,IAAAA,UAAQ,EAACJ,EAAEJ,KAAK,EAAE5C,IAAI;oBAAE6C,QAAQ;gBAAK;YACtD;QACD;QAEA,OAAO,MAAMN,QAAQC,GAAG,CAACjB,UAAUkB,GAAG,CAACO,CAAAA,IAAKD,aAAaC;IAC1D;AACD","file":"following.js","sourceRoot":"../../../../../built"}