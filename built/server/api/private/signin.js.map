{"version":3,"sources":["server/api/private/signin.js"],"names":["ctx","set","config","url","ep","name","exec","meta","limit","duration","max","limiter","undefined","ip","catch","e","throw","body","request","username","password","token","status","user","User","findOne","usernameLower","toLowerCase","host","fields","data","profile","isDeleted","isSuspended","error","same","bcrypt","compare","twoFactorEnabled","verified","speakeasy","totp","verify","secret","twoFactorSecret","encoding","signin","record","Signin","insert","createdAt","Date","userId","_id","headers","success","publishMainStream","pack"],"mappings":";+BAWA;;;eAAA;;;0BAVwB;2BACG;sBACM;wBACJ;wBACK;yBACf;wBACA;yBACC;MAGpB,WAAe,OAAOA;IACrBA,IAAIC,GAAG,CAAC,+BAA+BC,eAAM,CAACC,GAAG;IACjDH,IAAIC,GAAG,CAAC,oCAAoC;IAE5C,MAAMG,KAAK;QACVC,MAAM;QACNC,MAAM;QACNC,MAAM;YACLC,OAAO;gBACNC,UAAU,MAAM;gBAChBC,KAAK;YACN;QACD;IACD;IAEA,MAAMC,IAAAA,gBAAO,EAACP,IAAIQ,WAAWZ,IAAIa,EAAE,EAAEC,KAAK,CAACC,CAAAA;QAC1Cf,IAAIgB,KAAK,CAAC;IACX;IAEA,MAAMC,OAAOjB,IAAIkB,OAAO,CAACD,IAAI;IAC7B,MAAME,WAAWF,IAAI,CAAC,WAAW;IACjC,MAAMG,WAAWH,IAAI,CAAC,WAAW;IACjC,MAAMI,QAAQJ,IAAI,CAAC,QAAQ;IAE3B,IAAI,OAAOE,YAAY,UAAU;QAChCnB,IAAIsB,MAAM,GAAG;QACb;IACD;IAEA,IAAI,OAAOF,YAAY,UAAU;QAChCpB,IAAIsB,MAAM,GAAG;QACb;IACD;IAEA,IAAID,SAAS,QAAQ,OAAOA,SAAS,UAAU;QAC9CrB,IAAIsB,MAAM,GAAG;QACb;IACD;IAEA,aAAa;IACb,MAAMC,OAAO,MAAMC,aAAI,CAACC,OAAO,CAAC;QAC/BC,eAAeP,SAASQ,WAAW;QACnCC,MAAM;IACP,GAAG;QACDC,QAAQ;YACPC,MAAM;YACNC,SAAS;QACV;IACD;IAED,IAAIR,QAAQ,QAAQA,KAAKS,SAAS,IAAIT,KAAKU,WAAW,EAAE;QACvDjC,IAAIgB,KAAK,CAAC,KAAK;YACdkB,OAAO;QACR;QACA;IACD;IAEA,mBAAmB;IACnB,MAAMC,OAAO,MAAMC,UAAOC,OAAO,CAACjB,UAAUG,KAAKH,QAAQ;IAEzD,IAAIe,MAAM;QACT,IAAIZ,KAAKe,gBAAgB,EAAE;YAC1B,MAAMC,WAAW,AAACC,WAAkBC,IAAI,CAACC,MAAM,CAAC;gBAC/CC,QAAQpB,KAAKqB,eAAe;gBAC5BC,UAAU;gBACVxB,OAAOA;YACR;YAEA,IAAIkB,UAAU;gBACbO,IAAAA,gBAAM,EAAC9C,KAAKuB;YACb,OAAO;gBACNvB,IAAIgB,KAAK,CAAC,KAAK;oBACdkB,OAAO;gBACR;YACD;QACD,OAAO;YACNY,IAAAA,gBAAM,EAAC9C,KAAKuB;QACb;IACD,OAAO;QACNvB,IAAIgB,KAAK,CAAC,KAAK;YACdkB,OAAO;QACR;IACD;IAEA,wBAAwB;IACxB,MAAMa,SAAS,MAAMC,eAAM,CAACC,MAAM,CAAC;QAClCC,WAAW,IAAIC;QACfC,QAAQ7B,KAAK8B,GAAG;QAChBxC,IAAIb,IAAIa,EAAE;QACVyC,SAAStD,IAAIsD,OAAO;QACpBC,SAASpB;IACV;IAEA,uBAAuB;IACvBqB,IAAAA,yBAAiB,EAACjC,KAAK8B,GAAG,EAAE,UAAU,MAAMI,IAAAA,YAAI,EAACV;AAClD","file":"signin.js","sourceRoot":"../../../../built"}