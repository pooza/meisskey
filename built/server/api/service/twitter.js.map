{"version":3,"sources":["server/api/service/twitter.js"],"names":["getUserToken","ctx","headers","match","compareOrigin","normalizeUrl","url","endsWith","substr","length","referer","config","router","Router","get","throw","userToken","user","User","findOneAndUpdate","host","$set","body","publishMainStream","_id","pack","detail","includeSecrets","getTwAuth","meta","fetchMeta","enableTwitterIntegration","autwh","consumerKey","twitterConsumerKey","consumerSecret","twitterConsumerSecret","callbackUrl","twAuth","twCtx","begin","redis","set","JSON","stringify","redirect","sessid","uuid","cookies","path","secure","startsWith","httpOnly","Promise","res","rej","_","result","done","parse","query","oauth_verifier","findOne","userId","screenName","signin","verifier","token","twitter","accessToken","accessTokenSecret","username"],"mappings":"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","file":"twitter.js","sourceRoot":"../../../../built"}