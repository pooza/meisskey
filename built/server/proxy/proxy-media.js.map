{"version":3,"sources":["server/proxy/proxy-media.js"],"names":["proxyMedia","ctx","url","query","params","status","set","path","cleanup","createTemp","downloadUrl","mime","ext","detectTypeWithCheck","image","includes","convertToWebp","startsWith","FILE_TYPE_BROWSERSAFE","StatusError","data","fs","promises","readFile","type","body","e","serverLogger","error","isClientError","statusCode"],"mappings":";+BASsBA;;;eAAAA;;;oBATF;kBAES;gCACS;4BACX;6BACC;6BAC+B;uBAC/B;AAErB,eAAeA,WAAWC,GAAyB;IACzD,MAAMC,MAAM,SAASD,IAAIE,KAAK,GAAGF,IAAIE,KAAK,CAACD,GAAG,GAAG,aAAaD,IAAIG,MAAM,CAACF,GAAG;IAE5E,IAAI,OAAOA,QAAQ,UAAU;QAC5BD,IAAII,MAAM,GAAG;QACbJ,IAAIK,GAAG,CAAC,iBAAiB;QACzB;IACD;IAEA,mBAAmB;IACnB,MAAM,CAACC,MAAMC,QAAQ,GAAG,MAAMC,IAAAA,sBAAU;IAExC,IAAI;QACH,MAAMC,IAAAA,wBAAW,EAACR,KAAKK;QAEvB,MAAM,EAAEI,IAAI,EAAEC,GAAG,EAAE,GAAG,MAAMC,IAAAA,gCAAmB,EAACN;QAEhD,IAAIO;QAEJ,IAAI,YAAYb,IAAIE,KAAK,IAAI;YAAC;YAAa;YAAc;YAAa;YAAc;YAAc;SAAgB,CAACY,QAAQ,CAACJ,OAAO;YAClIG,QAAQ,MAAME,IAAAA,6BAAa,EAACT,MAAM,KAAK;QACxC,OAAO,IAAI,aAAaN,IAAIE,KAAK,IAAI;YAAC;YAAc;YAAa;YAAc;YAAa;YAAc;YAAc;SAAgB,CAACY,QAAQ,CAACJ,OAAO;YACxJG,QAAQ,MAAME,IAAAA,6BAAa,EAACT,MAAM,KAAK;QACxC,OAAO,IAAI;YAAC;SAAgB,CAACQ,QAAQ,CAACJ,OAAO;YAC5CG,QAAQ,MAAME,IAAAA,6BAAa,EAACT,MAAM,MAAM;QACzC,OAAO,IAAI,CAACI,KAAKM,UAAU,CAAC,aAAa,CAACC,kCAAqB,CAACH,QAAQ,CAACJ,OAAO;YAC/E,MAAM,IAAIQ,kBAAW,CAAC,iBAAiB,KAAK;QAC7C,OAAO;YACNL,QAAQ;gBACPM,MAAM,MAAMC,IAAGC,QAAQ,CAACC,QAAQ,CAAChB;gBACjCK,KAAKA,OAAO;gBACZY,MAAMb;YACP;QACD;QAEAV,IAAIwB,IAAI,GAAGX,MAAMM,IAAI;QACrBnB,IAAIK,GAAG,CAAC,gBAAgBQ,MAAMU,IAAI;QAClCvB,IAAIK,GAAG,CAAC,iBAAiB;IAC1B,EAAE,OAAOoB,GAAQ;QAChBC,cAAY,CAACC,KAAK,CAACF;QAEnB,IAAIA,aAAaP,kBAAW,IAAIO,EAAEG,aAAa,EAAE;YAChD5B,IAAII,MAAM,GAAGqB,EAAEI,UAAU;YACzB7B,IAAIK,GAAG,CAAC,iBAAiB;QAC1B,OAAO;YACNL,IAAII,MAAM,GAAG;YACbJ,IAAIK,GAAG,CAAC,iBAAiB;QAC1B;IACD,SAAU;QACTE;IACD;AACD","file":"proxy-media.js","sourceRoot":"../../../built"}