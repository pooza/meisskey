{"version":3,"sources":["server/web/url-preview.js"],"names":["logger","Logger","summaryInstance","getSummaryInstance","Summary","allowedPlugins","module","exports","ctx","config","disableUrlPreview","status","set","meta","fetchMeta","url","sanitizeUrl","query","lang","info","summalyProxy","summary","getJson","succ","title","icon","wrap","thumbnail","player","startsWith","replace","body","e","error","size","match","convertDataUri","path","cleanup","Promise","res","rej","tmp","file","fd","downloadUrl","imageSize","detectImageSize","wUnits","width","height","includes","mime","image","convertToWebp","data","toString","fs","promises","readFile"],"mappings":"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","file":"url-preview.js","sourceRoot":"../../../built"}