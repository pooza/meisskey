{"version":3,"sources":["services/following/create.js"],"names":["insertFollowingDoc","logger","Logger","followee","follower","alreadyFollowed","Following","insert","createdAt","Date","followerId","_id","followeeId","_follower","host","inbox","isRemoteUser","undefined","sharedInbox","_followee","catch","e","code","isLocalUser","info","removed","FollowRequest","remove","deletedCount","User","update","$inc","pendingReceivedFollowRequestsCount","followingCount","followersCount","registerOrFetchInstanceDoc","then","i","Instance","instanceChart","updateFollowing","updateFollowers","perUserFollowingChart","packUser","detail","packed","publishMainStream","createNotification","publishFollowingChanged","requestId","description","match","content","renderActivity","renderReject","renderFollow","deliver","blocking","blocked","Promise","all","Blocking","findOne","blockerId","blockeeId","userRefused","refuseFollow","autoAcceptFollowed","followed","IdentifiableError","isLocked","carefulBot","isBot","carefulRemote","carefulMassive","autoAccept","following","createFollowRequest","renderAccept"],"mappings":"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","file":"create.js","sourceRoot":"../../../built"}