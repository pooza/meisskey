{"version":3,"sources":["services/messages/create.js"],"names":["createMessage","user","recipient","text","file","uri","message","MessagingMessage","insert","createdAt","Date","fileId","_id","undefined","recipientId","trim","userId","isRead","DriveFile","update","$push","messageObj","packMessage","isLocalUser","publishMessagingStream","publishMessagingIndexStream","publishMainStream","User","$set","hasUnreadMessagingMessage","setTimeout","freshMessage","findOne","mute","getMute","blocks","getBlocks","length","pushNotification","createNotification","messageId"],"mappings":";+BAOsBA;;;eAAAA;;;sBAPuC;2BACvB;wBACiD;kCACjC;kCACzB;oCACM;AAE5B,eAAeA,cAAcC,IAAW,EAAEC,SAAgB,EAAEC,IAAmB,EAAEC,IAA4B,EAAEC,GAAY;IACjI,MAAMC,UAAU,MAAMC,yBAAgB,CAACC,MAAM,CAAC;QAC7CC,WAAW,IAAIC;QACfC,QAAQP,OAAOA,KAAKQ,GAAG,GAAGC;QAC1BC,aAAaZ,UAAUU,GAAG;QAC1BT,MAAMA,OAAOA,KAAKY,IAAI,KAAKF;QAC3BG,QAAQf,KAAKW,GAAG;QAChBK,QAAQ;QACRZ;IACD;IAEA,iEAAiE;IACjE,IAAID,MAAM;QACTc,kBAAS,CAACC,MAAM,CAAC;YAAEP,KAAKR,KAAKQ,GAAG;QAAC,GAAG;YACnCQ,OAAO;gBACN,+BAA+Bd,QAAQM,GAAG;YAC3C;QACD;IACD;IAEA,MAAMS,aAAa,MAAMC,IAAAA,sBAAW,EAAChB;IAErC,IAAIiB,IAAAA,iBAAW,EAACtB,OAAO;QACtB,WAAW;QACXuB,IAAAA,8BAAsB,EAAClB,QAAQU,MAAM,EAAEV,QAAQQ,WAAW,EAAE,WAAWO;QACvEI,IAAAA,mCAA2B,EAACnB,QAAQU,MAAM,EAAE,WAAWK;QACvDK,IAAAA,yBAAiB,EAACpB,QAAQU,MAAM,EAAE,oBAAoBK;IACvD;IAEA,IAAIE,IAAAA,iBAAW,EAACrB,YAAY;QAC3B,WAAW;QACXsB,IAAAA,8BAAsB,EAAClB,QAAQQ,WAAW,EAAER,QAAQU,MAAM,EAAE,WAAWK;QACvEI,IAAAA,mCAA2B,EAACnB,QAAQQ,WAAW,EAAE,WAAWO;QAC5DK,IAAAA,yBAAiB,EAACpB,QAAQQ,WAAW,EAAE,oBAAoBO;QAE3D,cAAc;QACdM,aAAI,CAACR,MAAM,CAAC;YAAEP,KAAKV,UAAUU,GAAG;QAAC,GAAG;YACnCgB,MAAM;gBACLC,2BAA2B;YAC5B;QACD;QAEA,0DAA0D;QAC1DC,WAAW;YACV,MAAMC,eAAe,MAAMxB,yBAAgB,CAACyB,OAAO,CAAC;gBAAEpB,KAAKN,QAAQM,GAAG;YAAC,GAAG;gBAAEK,QAAQ;YAAK;YACzF,IAAIc,gBAAgB,MAAM,QAAQ,qBAAqB;YACvD,IAAI,CAACA,aAAad,MAAM,EAAE;gBACzB,6BAA6B;gBAC7B,MAAMgB,OAAO,MAAMC,IAAAA,aAAO,EAAChC,UAAUU,GAAG,EAAEX,KAAKW,GAAG;gBAClD,IAAIqB,MAAM;gBACV,MAAME,SAAS,MAAMC,IAAAA,eAAS,EAAClC,WAAWD;gBAC1C,IAAIkC,OAAOE,MAAM,GAAG,GAAG;gBACvB,YAAY;gBAEZX,IAAAA,yBAAiB,EAACpB,QAAQQ,WAAW,EAAE,0BAA0BO;gBACjEiB,IAAAA,yBAAgB,EAAChC,QAAQQ,WAAW,EAAE,0BAA0BO;gBAChEkB,IAAAA,sCAAkB,EAACjC,QAAQQ,WAAW,EAAER,QAAQU,MAAM,EAAE,0BAA0B;oBAAEwB,WAAWT,aAAanB,GAAG;gBAAC;YACjH;QACD,GAAG;IACJ;IAEA,OAAOS;AACR","file":"create.js","sourceRoot":"../../../built"}