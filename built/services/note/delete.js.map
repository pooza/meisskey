{"version":3,"sources":["services/note/delete.js"],"names":["user","note","quiet","deletedAt","Date","Note","update","_id","userId","$set","text","mecabWords","trendWords","tags","fileIds","renoteId","poll","geo","cw","$inc","renoteCount","quoteCount","isQuote","score","isBot","$pull","_quoteIds","NoteUnread","find","noteId","then","unreads","unread","read","Favorite","remove","Notification","NoteReaction","fileId","DriveFile","isRemoteUser","deleteUnusedFile","$and","multi","publishNoteStream","renoteeId","isLocalUser","localOnly","renote","length","findOne","content","renderActivity","renderUndo","renderAnnounce","uri","config","url","renderDelete","renderTombstone","deliverToFollowers","deliverToRelays","dm","DeliverManager","u","mentionedRemoteUsers","User","addDirectRecipe","_renote","execute","notesChart","perUserNotesChart","registerOrFetchInstanceDoc","host","i","Instance","notesCount","instanceChart","updateNote"],"mappings":";+BAyBA;;;;CAIC,GACD;;;eAAA;;;sBA9B4B;sBACwC;wBAClC;wBACT;sBACF;0BACQ;2BACH;0BACD;uBACJ;8BACO;wBACX;4BACI;sBACN;2BACK;4CACqB;0BACtB;2BACK;0BACL;gCAC8B;uBACnB;8BACP;kCACQ;yBACb;8BACK;AAOV,eAAf,SAA8BA,IAAW,EAAEC,IAAW,EAAEC,QAAQ,KAAK;IACpE,MAAMC,YAAY,IAAIC;IAEtB,MAAMC,aAAI,CAACC,MAAM,CAAC;QACjBC,KAAKN,KAAKM,GAAG;QACbC,QAAQR,KAAKO,GAAG;IACjB,GAAG;QACFE,MAAM;YACLN,WAAWA;YACXO,MAAM;YACNC,YAAY,EAAE;YACdC,YAAY,EAAE;YACdC,MAAM,EAAE;YACRC,SAAS,EAAE;YACXC,UAAU;YACVC,MAAM;YACNC,KAAK;YACLC,IAAI;QACL;IACD;IAEA,IAAIjB,KAAKc,QAAQ,EAAE;QAClBV,aAAI,CAACC,MAAM,CAAC;YAAEC,KAAKN,KAAKc,QAAQ;QAAC,GAAG;YACnCI,MAAM;gBACLC,aAAa,CAAC;gBACdC,YAAYC,IAAAA,gBAAO,EAACrB,QAAQ,CAAC,IAAI;gBACjCsB,OAAOvB,KAAKwB,KAAK,GAAG,IAAI,CAAC;YAC1B;YACAC,OAAO;gBACNC,WAAWzB,KAAKM,GAAG;YACpB;QACD;IACD;IAEA,kBAAkB;IAClBoB,mBAAU,CAACC,IAAI,CAAC;QACfC,QAAQ5B,KAAKM,GAAG;IACjB,GAAGuB,IAAI,CAACC,CAAAA;QACP,KAAK,MAAMC,UAAUD,QAAS;YAC7BE,IAAAA,aAAI,EAACD,OAAOxB,MAAM,EAAEwB,OAAOH,MAAM;QAClC;IACD;IAEA,iBAAiB;IACjBK,iBAAQ,CAACC,MAAM,CAAC;QACfN,QAAQ5B,KAAKM,GAAG;IACjB;IAEA6B,qBAAY,CAACD,MAAM,CAAC;QACnBN,QAAQ5B,KAAKM,GAAG;IACjB;IAEA8B,qBAAY,CAACF,MAAM,CAAC;QACnBN,QAAQ5B,KAAKM,GAAG;IACjB;IAEA,2DAA2D;IAC3D,IAAIN,KAAKa,OAAO,EAAE;QACjB,KAAK,MAAMwB,UAAUrC,KAAKa,OAAO,CAAE;YAClCyB,kBAAS,CAACjC,MAAM,CAAC;gBAAEC,KAAK+B;YAAO,GAAG;gBACjCb,OAAO;oBACN,4BAA4BxB,KAAKM,GAAG;gBACrC;YACD;YAEA,+BAA+B;YAC/B,IAAIiC,IAAAA,kBAAY,EAACxC,OAAO;gBACvByC,IAAAA,kCAAgB,EAACH;YAClB;QACD;IACD;IAEA,0BAA0B;IAC1BjC,aAAI,CAAC8B,MAAM,CAAC;QACXO,MAAM;YACL;gBAAE3B,UAAUd,KAAKM,GAAG;YAAC;YACrB;gBAAEG,MAAM;YAAK;YACb;gBAAEI,SAAS,EAAE;YAAC;YACd;gBAAEE,MAAM;YAAK;SACb;IACF,GAAG;QACF2B,OAAO;IACR;IAEA,IAAI,CAACzC,OAAO;QACX0C,IAAAA,yBAAiB,EAAC3C,KAAKM,GAAG,EAAE,WAAW;YACtCJ,WAAWA;QACZ;QAEA,4CAA4C;QAC5C,IAAIF,KAAKc,QAAQ,EAAE;YAClB6B,IAAAA,yBAAiB,EAAC3C,KAAKc,QAAQ,EAAE,aAAa;gBAC7C8B,WAAW7C,KAAKO,GAAG,CAAC,cAAc;YACnC;QACD;QAEA,+BAA+B;QAC/B,IAAIuC,IAAAA,iBAAW,EAAC9C,SAAS,CAACC,KAAK8C,SAAS,EAAE;YACxC,CAAA;oBA4BqB9C;gBA3BrB,IAAI+C;gBAEJ,IAAI/C,KAAKc,QAAQ,IAAId,KAAKS,IAAI,IAAI,QAAQT,KAAKe,IAAI,IAAI,QAASf,CAAAA,KAAKa,OAAO,IAAI,QAAQb,KAAKa,OAAO,CAACmC,MAAM,IAAI,CAAA,GAAI;oBAClHD,SAAS,MAAM3C,aAAI,CAAC6C,OAAO,CAAC;wBAC3B3C,KAAKN,KAAKc,QAAQ;oBACnB;gBACD;gBAEA,MAAMoC,UAAUC,IAAAA,wBAAc,EAACJ,SAC5BK,IAAAA,aAAU,EAACC,IAAAA,iBAAc,EAACN,OAAOO,GAAG,IAAI,CAAC,EAAEC,eAAM,CAACC,GAAG,CAAC,OAAO,EAAET,OAAOzC,GAAG,CAAC,CAAC,EAAEN,OAAOD,QACpF0D,IAAAA,eAAY,EAACC,IAAAA,kBAAe,EAAC,CAAC,EAAEH,eAAM,CAACC,GAAG,CAAC,OAAO,EAAExD,KAAKM,GAAG,CAAC,CAAC,GAAGP,MAAM,CAAC,EAAEwD,eAAM,CAACC,GAAG,CAAC,OAAO,EAAExD,KAAKM,GAAG,CAAC,OAAO,CAAC;gBAElHqD,IAAAA,kCAAkB,EAAC5D,MAAMmD;gBACzBU,IAAAA,sBAAe,EAAC7D,MAAMmD;gBAEtB,MAAMW,KAAK,IAAIC,uBAAc,CAAC/D,MAAMmD;gBAEpC,sCAAsC;gBACtC,KAAK,MAAMa,KAAK/D,KAAKgE,oBAAoB,IAAI,EAAE,CAAE;oBAChD,MAAMjE,OAAO,MAAMkE,aAAI,CAAChB,OAAO,CAAC;wBAC/BK,KAAKS,EAAET,GAAG;oBACX;oBAEA,IAAIvD,MAAM8D,GAAGK,eAAe,CAACnE;gBAC9B;gBAEA,+CAA+C;gBAC/C,IAAIC,KAAKc,QAAQ,MAAId,gBAAAA,KAAKmE,OAAO,cAAZnE,oCAAAA,cAAcO,MAAM,GAAE;oBAC1C,MAAMR,OAAO,MAAMkE,aAAI,CAAChB,OAAO,CAAC;wBAC/B3C,KAAKN,KAAKmE,OAAO,CAAC5D,MAAM;oBACzB;oBAEA,IAAIR,MAAM8D,GAAGK,eAAe,CAACnE;gBAC9B;gBAEA8D,GAAGO,OAAO;YACX,CAAA;QACD;QACA,YAAY;QAEZ,QAAQ;QACRC,cAAU,CAAChE,MAAM,CAACL,MAAM;QACxBsE,qBAAiB,CAACjE,MAAM,CAACN,MAAMC,MAAM;QAErC,IAAIuC,IAAAA,kBAAY,EAACxC,OAAO;YACvBwE,IAAAA,sDAA0B,EAACxE,KAAKyE,IAAI,EAAE3C,IAAI,CAAC4C,CAAAA;gBAC1CC,iBAAQ,CAACrE,MAAM,CAAC;oBAAEC,KAAKmE,EAAEnE,GAAG;gBAAC,GAAG;oBAC/BY,MAAM;wBACLyD,YAAY,CAAC;oBACd;gBACD;gBAEAC,kBAAa,CAACC,UAAU,CAACJ,EAAED,IAAI,EAAE;YAClC;QACD;IACD;AACD","file":"delete.js","sourceRoot":"../../../built"}