{"version":3,"sources":["services/note/reaction/create.js"],"names":["user","note","reaction","dislike","direction","isLocalUser","_user","host","userId","_id","blocked","Blocking","findOne","blockeeId","blockerId","IdentifiableError","toDbReaction","inserted","mongo","ObjectID","createdAt","Date","noteId","NoteReaction","insert","catch","e","code","Note","update","$inc","score","isBot","incReactionsCount","decodedReaction","decodeReaction","emoji","packEmojis","replace","publishNoteStream","reactionCounts","fresh","publishHotStream","pack","createNotification","localOnly","noFederation","content","renderActivity","renderLike","dm","DeliverManager","isRemoteUser","reactee","User","addDirectRecipe","config","disableLikeBroadcast","includes","visibility","addFollowersRecipe","execute","Meta","upsert"],"mappings":"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","file":"create.js","sourceRoot":"../../../../built"}