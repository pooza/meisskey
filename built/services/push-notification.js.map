{"version":3,"sources":["services/push-notification.js"],"names":["swEnabled","update","fetchMeta","then","meta","enableServiceWorker","swPublicKey","swPrivateKey","setInterval","userId","type","body","mongo","ObjectID","user","User","findOne","_id","isLocalUser","enabled","getPushNotificationsValue","settings","pushNotifications","payload","truncateNotification","subscriptions","Subscription","find","subscription","pushSubscription","endpoint","keys","auth","p256dh","publickey","webpushDeliver","swSubscriptionId","JSON","stringify","notification","note","text","getNoteSummary","renote","substring","_truncated","cw","undefined","reply"],"mappings":";+BAsBA;;;eAAA;;;yBAtBuB;2BACD;gCACK;gCACF;sBACoC;uBAC9B;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAE/B,IAAIA,YAAY;AAEhB,SAASC;IACRC,IAAAA,kBAAS,IAAGC,IAAI,CAACC,CAAAA;QAChB,IAAIA,KAAKC,mBAAmB,IAAID,KAAKE,WAAW,IAAIF,KAAKG,YAAY,EAAE;YACtEP,YAAY;QACb,OAAO;YACNA,YAAY;QACb;IACD;AACD;AAEAQ,YAAY;IAAQP;AAAS,GAAG;AAChCA;AAEe,eAAf,SAA8BQ,MAA+B,EAAEC,IAAY,EAAEC,IAAU;QAalFA;IAZJ,IAAI,CAACX,WAAW;IAEhB,IAAI,OAAOS,WAAW,UAAU;QAC/BA,SAAS,IAAIG,SAAMC,QAAQ,CAACJ;IAC7B;IAEA,MAAMK,OAAO,MAAMC,aAAI,CAACC,OAAO,CAAC;QAC/BC,KAAKR;IACN;IAEA,IAAIK,QAAQ,QAAQ,CAACI,IAAAA,iBAAW,EAACJ,OAAO;IAExC,KAAIH,QAAAA,kBAAAA,4BAAAA,MAAMD,IAAI,EAAE;YAC2BI;QAA1C,MAAMK,UAAUC,IAAAA,+BAAyB,GAACN,iBAAAA,KAAKO,QAAQ,cAAbP,qCAAAA,eAAeQ,iBAAiB,EAAEX,KAAKD,IAAI;QACrF,IAAI,CAACS,SAAS;IACf;IAEA,MAAMI,UAAU;QACfb;QACAC,MAAMa,qBAAqBb;IAC5B;IAEA,QAAQ;IACR,MAAMc,gBAAgB,MAAMC,uBAAY,CAACC,IAAI,CAAC;QAC7ClB,QAAQA;IACT;IAEA,KAAK,MAAMmB,gBAAgBH,cAAe;QACzC,MAAMI,mBAAmB;YACxBC,UAAUF,aAAaE,QAAQ;YAC/BC,MAAM;gBACLC,MAAMJ,aAAaI,IAAI;gBACvBC,QAAQL,aAAaM,SAAS;YAC/B;QACD;QAEAC,IAAAA,qBAAc,EAAC;YACdC,kBAAkBR,aAAaX,GAAG;YAClCY;YACAN,SAASc,KAAKC,SAAS,CAACf;QACzB;IACD;AACD;AAEA,SAASC,qBAAqBe,YAAiB;IAC9C,IAAIA,aAAaC,IAAI,EAAE;QACtB,OAAO,wCACHD;YACHC,MAAM,wCACFD,aAAaC,IAAI;gBACpB,gCAAgC;gBAChCC,MAAMC,IAAAA,uBAAc,EAACH,aAAa7B,IAAI,KAAK,WAAW6B,aAAaC,IAAI,CAACG,MAAM,GAAGJ,aAAaC,IAAI,EAAEI,SAAS,CAAC,GAAG;gBACjHC,YAAY;gBACZC,IAAIC;gBACJC,OAAOD;gBACPJ,QAAQI;gBACRjC,MAAMiC;;;IAGT;IAEA,OAAOR;AACR","file":"push-notification.js","sourceRoot":"../../built"}